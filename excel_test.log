2025-03-28 19:24:49,311 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 19:24:49,311 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 19:24:49,312 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:24:49,312 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 19:24:49,312 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 19:24:49,312 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:24:49,312 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:24:49,511 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 19:24:49,513 - utils.excel_processor - WARNING - Excel中未找到'客户基础信息'Sheet页
2025-03-28 19:24:49,513 - utils.excel_processor - INFO - 尝试使用替代Sheet '客户' 来处理客户信息
2025-03-28 19:24:49,513 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 19:24:49,513 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 19:24:49,515 - utils.excel_processor - INFO - 处理客户信息完成，共4条记录
2025-03-28 19:24:49,515 - utils.excel_processor - WARNING - Excel中未找到'健康与皮肤数据'Sheet页
2025-03-28 19:24:49,515 - utils.excel_processor - WARNING - Excel中未找到'消费行为记录'Sheet页
2025-03-28 19:24:49,515 - utils.excel_processor - WARNING - Excel中未找到'消耗行为记录'Sheet页
2025-03-28 19:24:49,515 - utils.excel_processor - WARNING - Excel中未找到'客户沟通记录'Sheet页
2025-03-28 19:24:49,515 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 4, '健康档案数量': 0, '消费记录数量': 0, '服务记录数量': 0, '沟通记录数量': 0}
2025-03-28 19:24:49,515 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:24:49,516 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-28 19:24:49,517 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-28 19:24:49,517 - ExcelTest - INFO - 处理结果统计:
2025-03-28 19:24:49,517 - ExcelTest - INFO -   customers: 4项
2025-03-28 19:24:49,517 - ExcelTest - INFO -   health_records: 0项
2025-03-28 19:24:49,517 - ExcelTest - INFO -   consumptions: 0项
2025-03-28 19:24:49,518 - ExcelTest - INFO -   services: 0项
2025-03-28 19:24:49,518 - ExcelTest - INFO -   communications: 0项
2025-03-28 19:24:49,518 - ExcelTest - INFO - 客户数据示例:
2025-03-28 19:24:49,518 - ExcelTest - INFO -   基础信息: 客户ID
2025-03-28 19:24:49,518 - ExcelTest - INFO -   Unnamed: 1: 姓名
2025-03-28 19:24:49,518 - ExcelTest - INFO -   Unnamed: 2: 性别
2025-03-28 19:24:49,518 - ExcelTest - INFO -   Unnamed: 3: 年龄
2025-03-28 19:24:49,518 - ExcelTest - INFO -   Unnamed: 4: 门店归属
2025-03-28 19:24:49,518 - ExcelTest - INFO -   地域背景: 籍贯
2025-03-28 19:24:49,518 - ExcelTest - INFO -   Unnamed: 6: 现居地
2025-03-28 19:24:49,518 - ExcelTest - INFO -   Unnamed: 7: 居住时长
2025-03-28 19:24:49,519 - ExcelTest - INFO -   家庭结构: 家庭成员构成
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 9: 家庭人员年龄分布
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 10: 家庭居住情况
2025-03-28 19:24:49,519 - ExcelTest - INFO -   性格及消费心理: 性格类型标签
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 12: 消费决策主导
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 13: 风险敏感度
2025-03-28 19:24:49,519 - ExcelTest - INFO -   生活习惯: 兴趣爱好
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 15: 作息规律
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 16: 饮食偏好
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 17: 生理期
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 18: 家族遗传病史
2025-03-28 19:24:49,519 - ExcelTest - INFO -   社会关系: 职业
2025-03-28 19:24:49,519 - ExcelTest - INFO -   Unnamed: 20: 单位性质
2025-03-28 19:24:49,520 - ExcelTest - INFO -   Unnamed: 21: 年收入
2025-03-28 19:24:49,520 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 19:28:13,663 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 19:28:13,663 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 19:28:13,663 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:28:13,664 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 19:28:13,664 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 19:28:13,664 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:28:13,664 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:28:13,863 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 19:28:13,863 - utils.excel_processor - WARNING - Excel中未找到'客户基础信息'Sheet页
2025-03-28 19:28:13,863 - utils.excel_processor - INFO - 尝试使用替代Sheet '客户' 来处理客户信息
2025-03-28 19:28:13,863 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 19:28:13,863 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 19:28:13,864 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 19:28:13,864 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 19:28:13,866 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 19:28:13,866 - utils.excel_processor - WARNING - Excel中未找到'健康与皮肤数据'Sheet页
2025-03-28 19:28:13,866 - utils.excel_processor - INFO - 尝试使用替代Sheet '健康档案' 来处理健康档案
2025-03-28 19:28:13,866 - utils.excel_processor - INFO - 开始处理健康档案信息
2025-03-28 19:28:13,866 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 19:28:13,866 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 19:28:13,867 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 19:28:13,867 - utils.excel_processor - WARNING - Excel中未找到'消费行为记录'Sheet页
2025-03-28 19:28:13,867 - utils.excel_processor - INFO - 尝试使用替代Sheet '消费' 来处理消费记录
2025-03-28 19:28:13,867 - utils.excel_processor - INFO - 开始处理消费记录信息
2025-03-28 19:28:13,868 - utils.excel_processor - ERROR - Excel文件处理错误: invalid literal for int() with base 10: '6次'
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 180, in process_file
    processed_data['consumptions'] = self._process_consumptions(df)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 325, in _process_consumptions
    record['total_sessions'] = int(record['total_sessions']) if not pd.isna(record['total_sessions']) else None
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: invalid literal for int() with base 10: '6次'
2025-03-28 19:28:13,869 - ExcelTest - ERROR - Excel处理过程中出错: invalid literal for int() with base 10: '6次'
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\test_excel.py", line 57, in test_excel_processor
    result = processor.process_file(excel_file)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 226, in process_file
    raise e
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 180, in process_file
    processed_data['consumptions'] = self._process_consumptions(df)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 325, in _process_consumptions
    record['total_sessions'] = int(record['total_sessions']) if not pd.isna(record['total_sessions']) else None
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: invalid literal for int() with base 10: '6次'
2025-03-28 19:28:13,870 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 19:30:30,665 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 19:30:30,665 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 19:30:30,665 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:30:30,665 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 19:30:30,665 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 19:30:30,666 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:30:30,666 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:30:30,892 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 19:30:30,893 - utils.excel_processor - WARNING - Excel中未找到'客户基础信息'Sheet页
2025-03-28 19:30:30,893 - utils.excel_processor - INFO - 尝试使用替代Sheet '客户' 来处理客户信息
2025-03-28 19:30:30,893 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 19:30:30,893 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 19:30:30,893 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 19:30:30,893 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 19:30:30,895 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 19:30:30,895 - utils.excel_processor - WARNING - Excel中未找到'健康与皮肤数据'Sheet页
2025-03-28 19:30:30,895 - utils.excel_processor - INFO - 尝试使用替代Sheet '健康档案' 来处理健康档案
2025-03-28 19:30:30,895 - utils.excel_processor - INFO - 开始处理健康档案信息
2025-03-28 19:30:30,895 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 19:30:30,895 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 19:30:30,896 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 19:30:30,896 - utils.excel_processor - WARNING - Excel中未找到'消费行为记录'Sheet页
2025-03-28 19:30:30,896 - utils.excel_processor - INFO - 尝试使用替代Sheet '消费' 来处理消费记录
2025-03-28 19:30:30,896 - utils.excel_processor - INFO - 开始处理消费记录信息
2025-03-28 19:30:30,897 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-28 19:30:30,897 - utils.excel_processor - WARNING - Excel中未找到'消耗行为记录'Sheet页
2025-03-28 19:30:30,897 - utils.excel_processor - INFO - 尝试使用替代Sheet '消耗' 来处理服务记录
2025-03-28 19:30:30,897 - utils.excel_processor - INFO - 开始处理服务记录信息
2025-03-28 19:30:30,897 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 19:30:30,897 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 19:30:30,899 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-03-28 19:30:30,899 - utils.excel_processor - WARNING - Excel中未找到'客户沟通记录'Sheet页
2025-03-28 19:30:30,899 - utils.excel_processor - INFO - 尝试使用替代Sheet '沟通记录' 来处理沟通记录
2025-03-28 19:30:30,899 - utils.excel_processor - INFO - 开始处理沟通记录信息
2025-03-28 19:30:30,900 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 19:30:30,900 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-03-28 19:30:30,900 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 19:30:30,900 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-28 19:30:30,902 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-28 19:30:30,902 - ExcelTest - INFO - 处理结果统计:
2025-03-28 19:30:30,903 - ExcelTest - INFO -   customers: 3项
2025-03-28 19:30:30,903 - ExcelTest - INFO -   health_records: 3项
2025-03-28 19:30:30,903 - ExcelTest - INFO -   consumptions: 9项
2025-03-28 19:30:30,903 - ExcelTest - INFO -   services: 30项
2025-03-28 19:30:30,903 - ExcelTest - INFO -   communications: 15项
2025-03-28 19:30:30,903 - ExcelTest - INFO - 客户数据示例:
2025-03-28 19:30:30,904 - ExcelTest - INFO -   id: C001
2025-03-28 19:30:30,904 - ExcelTest - INFO -   name: 林晓薇
2025-03-28 19:30:30,904 - ExcelTest - INFO -   gender: 女
2025-03-28 19:30:30,904 - ExcelTest - INFO -   age: 28
2025-03-28 19:30:30,904 - ExcelTest - INFO -   store: 分店A
2025-03-28 19:30:30,905 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-28 19:30:30,905 - ExcelTest - INFO -   residence: 上海浦东
2025-03-28 19:30:30,905 - ExcelTest - INFO -   residence_years: 6年
2025-03-28 19:30:30,905 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-28 19:30:30,905 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-28 19:30:30,905 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-28 19:30:30,905 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-28 19:30:30,905 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-28 19:30:30,905 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-28 19:30:30,905 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-28 19:30:30,906 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-28 19:30:30,906 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-28 19:30:30,906 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-28 19:30:30,906 - ExcelTest - INFO -   family_medical_history: 无
2025-03-28 19:30:30,906 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-28 19:30:30,906 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-28 19:30:30,906 - ExcelTest - INFO -   annual_income: 35万
2025-03-28 19:30:30,906 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 21:20:55,496 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 21:20:55,497 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 21:20:55,684 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 21:20:55,685 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 21:20:55,686 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:20:55,686 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 21:20:55,686 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 21:20:55,686 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:20:55,686 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:20:55,916 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 21:20:55,916 - utils.excel_processor - WARNING - 没有找到包含客户基本信息的Sheet页
2025-03-28 21:20:55,916 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 21:20:55,916 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 21:20:55,917 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:20:55,917 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:20:55,918 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:20:55,918 - utils.excel_processor - WARNING - 无法匹配列名: '姓名'
2025-03-28 21:20:55,918 - utils.excel_processor - WARNING - 无法匹配列名: '毛孔与黑头'
2025-03-28 21:20:55,918 - utils.excel_processor - WARNING - 无法匹配列名: '皱纹与纹理'
2025-03-28 21:20:55,918 - utils.excel_processor - WARNING - 无法匹配列名: '色素沉着'
2025-03-28 21:20:55,918 - utils.excel_processor - WARNING - 无法匹配列名: '舌象特征'
2025-03-28 21:20:55,918 - utils.excel_processor - INFO - 列名部分匹配: '脉象数据' -> '脉象' -> 'pulse_type'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '运动频率及类型'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '饮食禁忌/偏好'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '护理时间灵活度'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '环境氛围要求'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '医美操作史'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '大健康服务史'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '重大疾病历史'
2025-03-28 21:20:55,919 - utils.excel_processor - WARNING - 无法匹配列名: '过敏史'
2025-03-28 21:20:55,920 - utils.excel_processor - INFO - 映射后列名: ['customer_id', '姓名', 'skin_type', 'water_oil_balance', '毛孔与黑头', '皱纹与纹理', '色素沉着', 'photoaging', 'tcm_constitution', '舌象特征', 'pulse_type', 'sleep_routine', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', 'massage_pressure', '环境氛围要求', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:20:55,920 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 21:20:55,920 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 21:20:55,920 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 21:20:55,920 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 21:20:55,920 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 21:20:55,920 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:20:55,921 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:20:55,921 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:20:55,921 - utils.excel_processor - WARNING - 无法匹配列名: '姓名'
2025-03-28 21:20:55,921 - utils.excel_processor - WARNING - 无法匹配列名: '总耗卡金额'
2025-03-28 21:20:55,921 - utils.excel_processor - WARNING - 无法匹配列名: '服务满意度'
2025-03-28 21:20:55,921 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:20:55,921 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:20:55,921 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:20:55,921 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:20:55,922 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:20:55,922 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:20:55,922 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:20:55,922 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:20:55,922 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:20:55,922 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:20:55,922 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:20:55,923 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:20:55,923 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:20:55,923 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:20:55,923 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:20:55,923 - utils.excel_processor - INFO - 映射后列名: ['customer_id', '姓名', 'arrival_time', 'departure_time', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified']
2025-03-28 21:20:55,929 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-03-28 21:20:55,929 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-03-28 21:20:55,929 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-28 21:20:55,930 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-28 21:20:55,930 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-28 21:20:55,930 - utils.excel_processor - WARNING - 无法匹配列名: '姓名'
2025-03-28 21:20:55,930 - utils.excel_processor - WARNING - 无法匹配列名: '沟通主要内容'
2025-03-28 21:20:55,930 - utils.excel_processor - INFO - 映射后列名: ['customer_id', '姓名', 'comm_time', 'comm_location', '沟通主要内容']
2025-03-28 21:20:55,931 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 21:20:55,931 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 21:20:55,931 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 0, '健康档案数量': 3, '消费记录数量': 0, '服务记录数量': 30, '沟通记录数量': 15}
2025-03-28 21:20:55,931 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:20:55,932 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-28 21:20:55,933 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-28 21:20:55,933 - ExcelTest - INFO - 处理结果统计:
2025-03-28 21:20:55,933 - ExcelTest - INFO -   customers: 0项
2025-03-28 21:20:55,933 - ExcelTest - INFO -   health_records: 3项
2025-03-28 21:20:55,933 - ExcelTest - INFO -   consumptions: 0项
2025-03-28 21:20:55,933 - ExcelTest - INFO -   services: 30项
2025-03-28 21:20:55,933 - ExcelTest - INFO -   communications: 15项
2025-03-28 21:20:55,933 - ExcelTest - WARNING - 未找到客户数据
2025-03-28 21:20:55,934 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 21:22:46,656 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 21:22:46,656 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 21:22:46,849 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 21:22:46,849 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 21:22:46,849 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:22:46,849 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 21:22:46,849 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 21:22:46,849 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:22:46,850 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:22:47,080 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 21:22:47,080 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-28 21:22:47,080 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 21:22:47,080 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 21:22:47,081 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:22:47,081 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:22:47,081 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:22:47,081 - utils.excel_processor - WARNING - 无法匹配列名: '居住时长'
2025-03-28 21:22:47,081 - utils.excel_processor - WARNING - 无法匹配列名: '家庭成员构成'
2025-03-28 21:22:47,081 - utils.excel_processor - INFO - 列名部分匹配: '家庭人员年龄分布' -> '年龄' -> 'age'
2025-03-28 21:22:47,081 - utils.excel_processor - WARNING - 无法匹配列名: '家庭居住情况'
2025-03-28 21:22:47,082 - utils.excel_processor - WARNING - 无法匹配列名: '性格类型标签'
2025-03-28 21:22:47,082 - utils.excel_processor - INFO - 列名部分匹配: '消费决策主导' -> '消费决策' -> 'consumption_decision'
2025-03-28 21:22:47,082 - utils.excel_processor - WARNING - 无法匹配列名: '作息规律'
2025-03-28 21:22:47,082 - utils.excel_processor - WARNING - 无法匹配列名: '生理期'
2025-03-28 21:22:47,082 - utils.excel_processor - WARNING - 无法匹配列名: '家族遗传病史'
2025-03-28 21:22:47,082 - utils.excel_processor - WARNING - 无法匹配列名: '单位性质'
2025-03-28 21:22:47,082 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', '居住时长', '家庭成员构成', 'age', '家庭居住情况', '性格类型标签', 'consumption_decision', 'risk_sensitivity', 'hobbies', '作息规律', 'diet_preference', '生理期', '家族遗传病史', 'occupation', '单位性质', 'annual_income']
2025-03-28 21:22:47,083 - utils.excel_processor - WARNING - 年龄值无法转换为整数: 无，设为None
2025-03-28 21:22:47,083 - utils.excel_processor - WARNING - 年龄值无法转换为整数: 45-48岁，12岁，设为None
2025-03-28 21:22:47,083 - utils.excel_processor - WARNING - 年龄值无法转换为整数: 32-35岁，设为None
2025-03-28 21:22:47,083 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:22:47,083 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:22:47,083 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 21:22:47,083 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 21:22:47,084 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:22:47,084 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:22:47,084 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '姓名'
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '毛孔与黑头'
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '皱纹与纹理'
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '色素沉着'
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '舌象特征'
2025-03-28 21:22:47,084 - utils.excel_processor - INFO - 列名部分匹配: '脉象数据' -> '脉象' -> 'pulse_type'
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '运动频率及类型'
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '饮食禁忌/偏好'
2025-03-28 21:22:47,084 - utils.excel_processor - WARNING - 无法匹配列名: '护理时间灵活度'
2025-03-28 21:22:47,085 - utils.excel_processor - WARNING - 无法匹配列名: '环境氛围要求'
2025-03-28 21:22:47,085 - utils.excel_processor - WARNING - 无法匹配列名: '医美操作史'
2025-03-28 21:22:47,085 - utils.excel_processor - WARNING - 无法匹配列名: '大健康服务史'
2025-03-28 21:22:47,085 - utils.excel_processor - WARNING - 无法匹配列名: '重大疾病历史'
2025-03-28 21:22:47,085 - utils.excel_processor - WARNING - 无法匹配列名: '过敏史'
2025-03-28 21:22:47,086 - utils.excel_processor - INFO - 映射后列名: ['customer_id', '姓名', 'skin_type', 'water_oil_balance', '毛孔与黑头', '皱纹与纹理', '色素沉着', 'photoaging', 'tcm_constitution', '舌象特征', 'pulse_type', 'sleep_routine', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', 'massage_pressure', '环境氛围要求', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:22:47,086 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 21:22:47,086 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 21:22:47,086 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 21:22:47,086 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 21:22:47,086 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 21:22:47,087 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:22:47,087 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:22:47,087 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:22:47,087 - utils.excel_processor - WARNING - 无法匹配列名: '姓名'
2025-03-28 21:22:47,087 - utils.excel_processor - WARNING - 无法匹配列名: '总耗卡金额'
2025-03-28 21:22:47,087 - utils.excel_processor - WARNING - 无法匹配列名: '服务满意度'
2025-03-28 21:22:47,087 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '项目内容'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '操作美容师'
2025-03-28 21:22:47,088 - utils.excel_processor - WARNING - 无法匹配列名: '耗卡金额'
2025-03-28 21:22:47,088 - utils.excel_processor - INFO - 映射后列名: ['customer_id', '姓名', 'arrival_time', 'departure_time', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified', '项目内容', '操作美容师', '耗卡金额', 'is_specified']
2025-03-28 21:22:47,091 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-03-28 21:22:47,091 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-03-28 21:22:47,091 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-28 21:22:47,091 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-28 21:22:47,091 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-28 21:22:47,093 - utils.excel_processor - WARNING - 无法匹配列名: '姓名'
2025-03-28 21:22:47,093 - utils.excel_processor - WARNING - 无法匹配列名: '沟通主要内容'
2025-03-28 21:22:47,093 - utils.excel_processor - INFO - 映射后列名: ['customer_id', '姓名', 'comm_time', 'comm_location', '沟通主要内容']
2025-03-28 21:22:47,094 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 21:22:47,094 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 21:22:47,094 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 0, '服务记录数量': 30, '沟通记录数量': 15}
2025-03-28 21:22:47,094 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:22:47,094 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-28 21:22:47,095 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-28 21:22:47,095 - ExcelTest - INFO - 处理结果统计:
2025-03-28 21:22:47,095 - ExcelTest - INFO -   customers: 3项
2025-03-28 21:22:47,095 - ExcelTest - INFO -   health_records: 3项
2025-03-28 21:22:47,096 - ExcelTest - INFO -   consumptions: 0项
2025-03-28 21:22:47,096 - ExcelTest - INFO -   services: 30项
2025-03-28 21:22:47,096 - ExcelTest - INFO -   communications: 15项
2025-03-28 21:22:47,096 - ExcelTest - INFO - 客户数据示例:
2025-03-28 21:22:47,096 - ExcelTest - INFO -   id: C001
2025-03-28 21:22:47,096 - ExcelTest - INFO -   name: 林晓薇
2025-03-28 21:22:47,096 - ExcelTest - INFO -   gender: 女
2025-03-28 21:22:47,096 - ExcelTest - INFO -   age: None
2025-03-28 21:22:47,096 - ExcelTest - INFO -   store: 分店A
2025-03-28 21:22:47,096 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-28 21:22:47,096 - ExcelTest - INFO -   residence: 上海浦东
2025-03-28 21:22:47,097 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-28 21:22:47,097 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-28 21:22:47,097 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-28 21:22:47,097 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-28 21:22:47,097 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-28 21:22:47,097 - ExcelTest - INFO -   annual_income: 35万
2025-03-28 21:22:47,097 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 21:41:28,773 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 21:41:28,773 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 21:41:28,965 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 21:41:28,965 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 21:41:28,965 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:41:28,965 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 21:41:28,965 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 21:41:28,965 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:41:28,966 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:41:29,195 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', 'residence_years', 'family_structure', 'family_age_distribution', 'living_condition', 'personality_tags', 'consumption_decision', 'risk_sensitivity', 'hobbies', 'routine', 'diet_preference', 'menstrual_record', 'family_medical_history', 'occupation', 'work_unit_type', 'annual_income']
2025-03-28 21:41:29,196 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:41:29,196 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:41:29,196 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 21:41:29,196 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 21:41:29,197 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:41:29,197 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:41:29,197 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:41:29,197 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'water_oil_balance', 'pore_blackhead', 'eye_area', 'pigment', 'photoaging', 'tcm_constitution', 'tongue_color', 'pulse_type', 'sleep_routine', 'exercise_pattern', 'diet_habits', 'care_time_preference', 'massage_pressure', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_beauty_history', 'health_service_history', 'major_disease_history', 'allergy_history']
2025-03-28 21:41:29,198 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 21:41:29,198 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 21:41:29,198 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 21:41:29,199 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 21:41:29,199 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 21:41:29,199 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:41:29,199 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:41:29,200 - utils.excel_processor - ERROR - Excel文件处理错误: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 521, in _process_services
    if pd.isna(project) and pd.isna(technician) and pd.isna(amount):
       ^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:41:29,203 - ExcelTest - ERROR - Excel处理过程中出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\test_excel.py", line 57, in test_excel_processor
    result = processor.process_file(excel_file)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 230, in process_file
    raise e
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 521, in _process_services
    if pd.isna(project) and pd.isna(technician) and pd.isna(amount):
       ^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:41:29,204 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 21:42:13,058 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 21:42:13,058 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 21:42:13,250 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 21:42:13,250 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 21:42:13,252 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:42:13,252 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 21:42:13,252 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 21:42:13,252 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:42:13,252 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:42:13,482 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 21:42:13,482 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-28 21:42:13,482 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 21:42:13,482 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', 'residence_years', 'family_structure', 'family_age_distribution', 'living_condition', 'personality_tags', 'consumption_decision', 'risk_sensitivity', 'hobbies', 'routine', 'diet_preference', 'menstrual_record', 'family_medical_history', 'occupation', 'work_unit_type', 'annual_income']
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 21:42:13,483 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 21:42:13,485 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:42:13,485 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:42:13,485 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:42:13,485 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'water_oil_balance', 'pore_blackhead', 'eye_area', 'pigment', 'photoaging', 'tcm_constitution', 'tongue_color', 'pulse_type', 'sleep_routine', 'exercise_pattern', 'diet_habits', 'care_time_preference', 'massage_pressure', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_beauty_history', 'health_service_history', 'major_disease_history', 'allergy_history']
2025-03-28 21:42:13,486 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 21:42:13,486 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 21:42:13,486 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 21:42:13,486 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 21:42:13,486 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 21:42:13,487 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:42:13,487 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:42:13,488 - utils.excel_processor - ERROR - Excel文件处理错误: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 522, in _process_services
    if (isinstance(project, pd.Series) and project.isna().all()) or pd.isna(project):
                                                                    ^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:42:13,490 - ExcelTest - ERROR - Excel处理过程中出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\test_excel.py", line 57, in test_excel_processor
    result = processor.process_file(excel_file)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 230, in process_file
    raise e
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 522, in _process_services
    if (isinstance(project, pd.Series) and project.isna().all()) or pd.isna(project):
                                                                    ^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:42:13,491 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 21:42:42,934 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 21:42:42,935 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 21:42:43,138 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 21:42:43,138 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 21:42:43,138 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:42:43,138 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 21:42:43,138 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 21:42:43,138 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:42:43,139 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:42:43,386 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 21:42:43,386 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-28 21:42:43,386 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 21:42:43,386 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 21:42:43,387 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:42:43,387 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:42:43,388 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:42:43,388 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', 'residence_years', 'family_structure', 'family_age_distribution', 'living_condition', 'personality_tags', 'consumption_decision', 'risk_sensitivity', 'hobbies', 'routine', 'diet_preference', 'menstrual_record', 'family_medical_history', 'occupation', 'work_unit_type', 'annual_income']
2025-03-28 21:42:43,388 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:42:43,389 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:42:43,389 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 21:42:43,389 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 21:42:43,389 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:42:43,389 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:42:43,389 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:42:43,389 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'water_oil_balance', 'pore_blackhead', 'eye_area', 'pigment', 'photoaging', 'tcm_constitution', 'tongue_color', 'pulse_type', 'sleep_routine', 'exercise_pattern', 'diet_habits', 'care_time_preference', 'massage_pressure', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_beauty_history', 'health_service_history', 'major_disease_history', 'allergy_history']
2025-03-28 21:42:43,390 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 21:42:43,390 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 21:42:43,390 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 21:42:43,390 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 21:42:43,390 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 21:42:43,390 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:42:43,390 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:42:43,392 - utils.excel_processor - ERROR - Excel文件处理错误: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 534, in _process_services
    'service_item': str(project) if not pd.isna(project) else None,
                                        ^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:42:43,394 - ExcelTest - ERROR - Excel处理过程中出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\test_excel.py", line 57, in test_excel_processor
    result = processor.process_file(excel_file)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 230, in process_file
    raise e
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 534, in _process_services
    'service_item': str(project) if not pd.isna(project) else None,
                                        ^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:42:43,395 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 21:43:08,029 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 21:43:08,030 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 21:43:08,279 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 21:43:08,279 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 21:43:08,280 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:43:08,280 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 21:43:08,280 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 21:43:08,280 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:43:08,280 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:43:08,536 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 21:43:08,537 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-28 21:43:08,537 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 21:43:08,537 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 21:43:08,537 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:43:08,538 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:43:08,538 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:43:08,538 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', 'residence_years', 'family_structure', 'family_age_distribution', 'living_condition', 'personality_tags', 'consumption_decision', 'risk_sensitivity', 'hobbies', 'routine', 'diet_preference', 'menstrual_record', 'family_medical_history', 'occupation', 'work_unit_type', 'annual_income']
2025-03-28 21:43:08,538 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:43:08,539 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:43:08,539 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 21:43:08,539 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 21:43:08,539 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:43:08,539 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:43:08,539 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:43:08,540 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'water_oil_balance', 'pore_blackhead', 'eye_area', 'pigment', 'photoaging', 'tcm_constitution', 'tongue_color', 'pulse_type', 'sleep_routine', 'exercise_pattern', 'diet_habits', 'care_time_preference', 'massage_pressure', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_beauty_history', 'health_service_history', 'major_disease_history', 'allergy_history']
2025-03-28 21:43:08,540 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 21:43:08,540 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 21:43:08,540 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 21:43:08,540 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 21:43:08,540 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 21:43:08,540 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:43:08,541 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:43:08,543 - utils.excel_processor - ERROR - Excel文件处理错误: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 536, in _process_services
    'service_amount': self._parse_float(amount),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 627, in _parse_float
    if pd.isna(value):
       ^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:43:08,545 - ExcelTest - ERROR - Excel处理过程中出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\test_excel.py", line 57, in test_excel_processor
    result = processor.process_file(excel_file)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 230, in process_file
    raise e
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 196, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 536, in _process_services
    'service_amount': self._parse_float(amount),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 627, in _parse_float
    if pd.isna(value):
       ^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-28 21:43:08,546 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 21:43:47,289 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 21:43:47,289 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 21:43:47,484 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 21:43:47,484 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 21:43:47,484 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:43:47,484 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 21:43:47,484 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 21:43:47,484 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:43:47,485 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:43:47,710 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 21:43:47,710 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-28 21:43:47,711 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 21:43:47,711 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 21:43:47,711 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:43:47,711 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:43:47,712 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 21:43:47,712 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', 'residence_years', 'family_structure', 'family_age_distribution', 'living_condition', 'personality_tags', 'consumption_decision', 'risk_sensitivity', 'hobbies', 'routine', 'diet_preference', 'menstrual_record', 'family_medical_history', 'occupation', 'work_unit_type', 'annual_income']
2025-03-28 21:43:47,712 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:43:47,713 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 21:43:47,713 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 21:43:47,713 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 21:43:47,713 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:43:47,713 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:43:47,713 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 21:43:47,714 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'water_oil_balance', 'pore_blackhead', 'eye_area', 'pigment', 'photoaging', 'tcm_constitution', 'tongue_color', 'pulse_type', 'sleep_routine', 'exercise_pattern', 'diet_habits', 'care_time_preference', 'massage_pressure', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_beauty_history', 'health_service_history', 'major_disease_history', 'allergy_history']
2025-03-28 21:43:47,714 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 21:43:47,714 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 21:43:47,714 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 21:43:47,714 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 21:43:47,715 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 21:43:47,715 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 21:43:47,715 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 21:43:47,768 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-28 21:43:47,768 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-28 21:43:47,768 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-28 21:43:47,768 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-28 21:43:47,768 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-28 21:43:47,769 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-28 21:43:47,769 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 21:43:47,769 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 21:43:47,770 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 0, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-28 21:43:47,770 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 21:43:47,770 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-28 21:43:47,773 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-28 21:43:47,773 - ExcelTest - INFO - 处理结果统计:
2025-03-28 21:43:47,773 - ExcelTest - INFO -   customers: 3项
2025-03-28 21:43:47,773 - ExcelTest - INFO -   health_records: 3项
2025-03-28 21:43:47,773 - ExcelTest - INFO -   consumptions: 0项
2025-03-28 21:43:47,773 - ExcelTest - INFO -   services: 150项
2025-03-28 21:43:47,774 - ExcelTest - INFO -   communications: 15项
2025-03-28 21:43:47,774 - ExcelTest - INFO - 客户数据示例:
2025-03-28 21:43:47,774 - ExcelTest - INFO -   id: C001
2025-03-28 21:43:47,774 - ExcelTest - INFO -   name: 林晓薇
2025-03-28 21:43:47,774 - ExcelTest - INFO -   gender: 女
2025-03-28 21:43:47,774 - ExcelTest - INFO -   age: 28
2025-03-28 21:43:47,774 - ExcelTest - INFO -   store: 分店A
2025-03-28 21:43:47,774 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-28 21:43:47,774 - ExcelTest - INFO -   residence: 上海浦东
2025-03-28 21:43:47,774 - ExcelTest - INFO -   residence_years: 6年
2025-03-28 21:43:47,774 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-28 21:43:47,775 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-28 21:43:47,775 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-28 21:43:47,775 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-28 21:43:47,775 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-28 21:43:47,775 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-28 21:43:47,775 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-28 21:43:47,775 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-28 21:43:47,775 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-28 21:43:47,775 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-28 21:43:47,776 - ExcelTest - INFO -   family_medical_history: 无
2025-03-28 21:43:47,776 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-28 21:43:47,776 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-28 21:43:47,776 - ExcelTest - INFO -   annual_income: 35万
2025-03-28 21:43:47,776 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-28 22:29:43,347 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-28 22:29:43,347 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-28 22:29:43,530 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-28 22:29:43,530 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-28 22:29:43,531 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 22:29:43,531 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-28 22:29:43,531 - ExcelTest - INFO - 开始调用process_file方法
2025-03-28 22:29:43,531 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 22:29:43,531 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 22:29:43,751 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-28 22:29:43,752 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-28 22:29:43,752 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-28 22:29:43,752 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-28 22:29:43,752 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 22:29:43,752 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 22:29:43,752 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-28 22:29:43,753 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', 'residence_years', 'family_structure', 'family_age_distribution', 'living_condition', 'personality_tags', 'consumption_decision', 'risk_sensitivity', 'hobbies', 'routine', 'diet_preference', 'menstrual_record', 'family_medical_history', 'occupation', 'work_unit_type', 'annual_income']
2025-03-28 22:29:43,753 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 22:29:43,753 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-28 22:29:43,753 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-28 22:29:43,753 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-28 22:29:43,754 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 22:29:43,754 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 22:29:43,754 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-28 22:29:43,754 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-28 22:29:43,755 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-28 22:29:43,755 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-28 22:29:43,755 - utils.excel_processor - WARNING - 没有找到包含消费记录的Sheet页
2025-03-28 22:29:43,755 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-28 22:29:43,755 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-28 22:29:43,756 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-28 22:29:43,756 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-28 22:29:43,803 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-28 22:29:43,803 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-28 22:29:43,803 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-28 22:29:43,804 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-28 22:29:43,804 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-28 22:29:43,804 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-28 22:29:43,805 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 22:29:43,805 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-28 22:29:43,805 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 0, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-28 22:29:43,805 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-28 22:29:43,805 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-28 22:29:43,808 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-28 22:29:43,808 - ExcelTest - INFO - 处理结果统计:
2025-03-28 22:29:43,809 - ExcelTest - INFO -   customers: 3项
2025-03-28 22:29:43,809 - ExcelTest - INFO -   health_records: 3项
2025-03-28 22:29:43,809 - ExcelTest - INFO -   consumptions: 0项
2025-03-28 22:29:43,809 - ExcelTest - INFO -   services: 150项
2025-03-28 22:29:43,809 - ExcelTest - INFO -   communications: 15项
2025-03-28 22:29:43,809 - ExcelTest - INFO - 客户数据示例:
2025-03-28 22:29:43,809 - ExcelTest - INFO -   id: C001
2025-03-28 22:29:43,809 - ExcelTest - INFO -   name: 林晓薇
2025-03-28 22:29:43,809 - ExcelTest - INFO -   gender: 女
2025-03-28 22:29:43,809 - ExcelTest - INFO -   age: 28
2025-03-28 22:29:43,809 - ExcelTest - INFO -   store: 分店A
2025-03-28 22:29:43,809 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-28 22:29:43,809 - ExcelTest - INFO -   residence: 上海浦东
2025-03-28 22:29:43,809 - ExcelTest - INFO -   residence_years: 6年
2025-03-28 22:29:43,810 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-28 22:29:43,810 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-28 22:29:43,810 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-28 22:29:43,810 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-28 22:29:43,810 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-28 22:29:43,810 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-28 22:29:43,810 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-28 22:29:43,810 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-28 22:29:43,811 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-28 22:29:43,811 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-28 22:29:43,811 - ExcelTest - INFO -   family_medical_history: 无
2025-03-28 22:29:43,811 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-28 22:29:43,811 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-28 22:29:43,811 - ExcelTest - INFO -   annual_income: 35万
2025-03-28 22:29:43,811 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 00:57:02,413 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 00:57:02,414 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 00:57:02,684 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 00:57:02,684 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 00:57:02,685 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 00:57:02,685 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 00:57:02,685 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 00:57:02,685 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 00:57:02,685 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 00:57:02,902 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 00:57:02,902 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 00:57:02,902 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 00:57:02,903 - utils.excel_processor - INFO - 开始处理客户基础信息
2025-03-29 00:57:02,903 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 00:57:02,903 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 00:57:02,903 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 00:57:02,903 - utils.excel_processor - INFO - 映射后列名: ['id', 'name', 'gender', 'age', 'store', 'hometown', 'residence', 'residence_years', 'family_structure', 'family_age_distribution', 'living_condition', 'personality_tags', 'consumption_decision', 'risk_sensitivity', 'hobbies', 'routine', 'diet_preference', 'menstrual_record', 'family_medical_history', 'occupation', 'work_unit_type', 'annual_income']
2025-03-29 00:57:02,904 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 00:57:02,904 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 00:57:02,904 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 00:57:02,904 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 00:57:02,904 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 00:57:02,904 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 00:57:02,905 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 00:57:02,906 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 00:57:02,907 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 00:57:02,907 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 00:57:02,907 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 00:57:02,907 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 00:57:02,907 - utils.excel_processor - INFO - 开始处理服务记录
2025-03-29 00:57:02,907 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 00:57:02,907 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 00:57:02,955 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 00:57:02,956 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 00:57:02,956 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 00:57:02,956 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 00:57:02,956 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 00:57:02,956 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 00:57:02,957 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 00:57:02,957 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 00:57:02,957 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 00:57:02,957 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 00:57:02,957 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 00:57:02,960 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 00:57:02,961 - ExcelTest - INFO - 处理结果统计:
2025-03-29 00:57:02,961 - ExcelTest - INFO -   customers: 3项
2025-03-29 00:57:02,961 - ExcelTest - INFO -   health_records: 3项
2025-03-29 00:57:02,961 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 00:57:02,961 - ExcelTest - INFO -   services: 150项
2025-03-29 00:57:02,961 - ExcelTest - INFO -   communications: 15项
2025-03-29 00:57:02,961 - ExcelTest - INFO - 客户数据示例:
2025-03-29 00:57:02,961 - ExcelTest - INFO -   id: C001
2025-03-29 00:57:02,961 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 00:57:02,961 - ExcelTest - INFO -   gender: 女
2025-03-29 00:57:02,961 - ExcelTest - INFO -   age: 28
2025-03-29 00:57:02,961 - ExcelTest - INFO -   store: 分店A
2025-03-29 00:57:02,961 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 00:57:02,961 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 00:57:02,961 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 00:57:02,962 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 00:57:02,962 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 00:57:02,962 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 00:57:02,962 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 00:57:02,962 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 00:57:02,962 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 00:57:02,962 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 00:57:02,962 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 00:57:02,962 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 00:57:02,962 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 00:57:02,962 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 00:57:02,963 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 00:57:02,963 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 00:57:02,963 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 00:57:02,963 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:09:06,980 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:09:06,981 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:09:07,158 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:09:07,158 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:09:07,158 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:09:07,158 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:09:07,158 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:09:07,158 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:09:07,158 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:09:07,376 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:09:07,376 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:09:07,376 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:09:07,376 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:09:07,376 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:09:07,377 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:09:07,384 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:09:07,384 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:09:07,384 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:09:07,384 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:09:07,385 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:09:07,386 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:09:07,386 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:09:07,386 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:09:07,386 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:09:07,386 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:09:07,387 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:09:07,387 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:09:07,387 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:09:07,387 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:09:07,387 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:09:07,387 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:09:07,388 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:09:07,389 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:09:07,389 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:09:07,389 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:09:07,389 - utils.excel_processor - INFO - 服务项目列: ['service_items', 'service_items', 'service_items', 'service_items', 'service_items']
2025-03-29 01:09:07,390 - utils.excel_processor - INFO - 美容师列: ['beautician', 'beautician', 'beautician', 'beautician', 'beautician']
2025-03-29 01:09:07,390 - utils.excel_processor - INFO - 金额列: ['total_amount', 'service_amount', 'service_amount', 'service_amount', 'service_amount', 'service_amount']
2025-03-29 01:09:07,390 - utils.excel_processor - INFO - 是否指定列: ['is_specified', 'is_specified', 'is_specified', 'is_specified', 'is_specified']
2025-03-29 01:09:07,390 - utils.excel_processor - ERROR - Excel文件处理错误: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 243, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 574, in _process_services
    if service_items is None or pd.isna(service_items) or (isinstance(service_items, str) and service_items.strip() in ['项目内容', '']):
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:09:07,392 - ExcelTest - ERROR - Excel处理过程中出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\test_excel.py", line 57, in test_excel_processor
    result = processor.process_file(excel_file)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 277, in process_file
    raise e
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 243, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 574, in _process_services
    if service_items is None or pd.isna(service_items) or (isinstance(service_items, str) and service_items.strip() in ['项目内容', '']):
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:09:07,393 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:10:25,586 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:10:25,586 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:10:25,762 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:10:25,762 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:10:25,762 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:10:25,763 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:10:25,763 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:10:25,763 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:10:25,763 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:10:25,986 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:10:25,986 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:10:25,986 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:10:25,986 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:10:25,986 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:10:25,987 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:10:25,993 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:10:25,994 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:10:25,994 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:10:25,994 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:10:25,995 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:10:25,995 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:10:25,995 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:10:25,995 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:10:25,995 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:10:25,995 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:10:25,996 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:10:25,996 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:10:25,996 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:10:25,996 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:10:25,996 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:10:25,996 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:10:25,997 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:10:25,997 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:10:25,997 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:10:25,997 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:10:25,997 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:10:25,997 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:10:25,998 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:10:25,998 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:10:25,998 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:10:25,998 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:10:25,998 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:10:25,999 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:10:25,999 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:10:25,999 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:10:25,999 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:10:25,999 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:10:25,999 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:10:25,999 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:10:25,999 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:10:25,999 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:10:25,999 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:10:26,000 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:10:26,000 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:10:26,001 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:10:26,001 - utils.excel_processor - INFO - 找到的关键列映射: {'customer_id': '客户ID', 'service_date': '到店时间', 'service_items': '项目内容', 'beautician': '操作美容师', 'service_amount': '耗卡金额', 'is_specified': '是否指定'}
2025-03-29 01:10:26,001 - utils.excel_processor - ERROR - 处理第 0 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,003 - utils.excel_processor - ERROR - 处理第 1 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,004 - utils.excel_processor - ERROR - 处理第 2 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,004 - utils.excel_processor - ERROR - 处理第 3 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,005 - utils.excel_processor - ERROR - 处理第 4 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,006 - utils.excel_processor - ERROR - 处理第 5 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,006 - utils.excel_processor - ERROR - 处理第 6 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,007 - utils.excel_processor - ERROR - 处理第 7 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,008 - utils.excel_processor - ERROR - 处理第 8 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,008 - utils.excel_processor - ERROR - 处理第 9 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,009 - utils.excel_processor - ERROR - 处理第 10 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,010 - utils.excel_processor - ERROR - 处理第 11 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,010 - utils.excel_processor - ERROR - 处理第 12 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,011 - utils.excel_processor - ERROR - 处理第 13 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,011 - utils.excel_processor - ERROR - 处理第 14 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,012 - utils.excel_processor - ERROR - 处理第 15 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,013 - utils.excel_processor - ERROR - 处理第 16 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,013 - utils.excel_processor - ERROR - 处理第 17 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,014 - utils.excel_processor - ERROR - 处理第 18 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,015 - utils.excel_processor - ERROR - 处理第 19 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,016 - utils.excel_processor - ERROR - 处理第 20 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,016 - utils.excel_processor - ERROR - 处理第 21 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,017 - utils.excel_processor - ERROR - 处理第 22 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,017 - utils.excel_processor - ERROR - 处理第 23 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,023 - utils.excel_processor - ERROR - 处理第 24 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,023 - utils.excel_processor - ERROR - 处理第 25 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,024 - utils.excel_processor - ERROR - 处理第 26 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,025 - utils.excel_processor - ERROR - 处理第 27 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,026 - utils.excel_processor - ERROR - 处理第 28 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,027 - utils.excel_processor - ERROR - 处理第 29 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 604, in _process_services
    if not pd.isna(service_items_val) and service_items_val:
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:10:26,027 - utils.excel_processor - INFO - 服务记录处理完成，共处理 0 条记录，跳过 0 条无效记录
2025-03-29 01:10:26,027 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:10:26,027 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:10:26,027 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:10:26,027 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:10:26,028 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:10:26,029 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:10:26,029 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:10:26,029 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:10:26,029 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:10:26,029 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:10:26,031 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:10:26,032 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:10:26,032 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:10:26,032 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:10:26,032 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:10:26,032 - ExcelTest - INFO -   services: 0项
2025-03-29 01:10:26,032 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:10:26,033 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:10:26,033 - ExcelTest - INFO -   id: C001
2025-03-29 01:10:26,033 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:10:26,033 - ExcelTest - INFO -   gender: 女
2025-03-29 01:10:26,033 - ExcelTest - INFO -   age: 28
2025-03-29 01:10:26,034 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:10:26,034 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:10:26,034 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:10:26,035 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:10:26,035 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:10:26,035 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:10:26,035 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:10:26,036 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:10:26,036 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:10:26,036 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:10:26,036 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:10:26,036 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:10:26,036 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:10:26,036 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:10:26,036 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:10:26,037 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:10:26,037 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:10:26,037 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:10:26,037 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:11:35,753 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:11:35,753 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:11:35,929 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:11:35,930 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:11:35,930 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:11:35,930 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:11:35,930 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:11:35,930 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:11:35,930 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:11:36,149 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:11:36,149 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:11:36,149 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:11:36,149 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:11:36,149 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:11:36,150 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:11:36,158 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:11:36,158 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:11:36,158 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:11:36,159 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:11:36,159 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:11:36,159 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:11:36,159 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:11:36,160 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:11:36,161 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:11:36,161 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:11:36,161 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:11:36,161 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:11:36,161 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:11:36,161 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:11:36,162 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:11:36,162 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:11:36,162 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:11:36,162 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:11:36,162 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:11:36,163 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:11:36,163 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:11:36,163 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:11:36,163 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:11:36,163 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:11:36,163 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:11:36,163 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:11:36,163 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:11:36,163 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:11:36,163 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:11:36,163 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:11:36,164 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:11:36,164 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:11:36,164 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:11:36,164 - utils.excel_processor - INFO - 找到的关键列: 客户ID=客户ID, 到店时间=到店时间, 项目内容=项目内容
2025-03-29 01:11:36,164 - utils.excel_processor - DEBUG - 行 0: 处理客户 C001
2025-03-29 01:11:36,165 - utils.excel_processor - ERROR - 处理第 0 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,167 - utils.excel_processor - DEBUG - 行 1: 处理客户 C001
2025-03-29 01:11:36,167 - utils.excel_processor - ERROR - 处理第 1 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,167 - utils.excel_processor - DEBUG - 行 2: 处理客户 C001
2025-03-29 01:11:36,168 - utils.excel_processor - ERROR - 处理第 2 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,168 - utils.excel_processor - DEBUG - 行 3: 处理客户 C001
2025-03-29 01:11:36,168 - utils.excel_processor - ERROR - 处理第 3 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,169 - utils.excel_processor - DEBUG - 行 4: 处理客户 C001
2025-03-29 01:11:36,169 - utils.excel_processor - ERROR - 处理第 4 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,170 - utils.excel_processor - DEBUG - 行 5: 处理客户 C001
2025-03-29 01:11:36,170 - utils.excel_processor - ERROR - 处理第 5 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,171 - utils.excel_processor - DEBUG - 行 6: 处理客户 C001
2025-03-29 01:11:36,171 - utils.excel_processor - ERROR - 处理第 6 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,172 - utils.excel_processor - DEBUG - 行 7: 处理客户 C001
2025-03-29 01:11:36,172 - utils.excel_processor - ERROR - 处理第 7 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,172 - utils.excel_processor - DEBUG - 行 8: 处理客户 C001
2025-03-29 01:11:36,173 - utils.excel_processor - ERROR - 处理第 8 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,173 - utils.excel_processor - DEBUG - 行 9: 处理客户 C001
2025-03-29 01:11:36,173 - utils.excel_processor - ERROR - 处理第 9 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,174 - utils.excel_processor - DEBUG - 行 10: 处理客户 C002
2025-03-29 01:11:36,174 - utils.excel_processor - ERROR - 处理第 10 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,176 - utils.excel_processor - DEBUG - 行 11: 处理客户 C002
2025-03-29 01:11:36,176 - utils.excel_processor - ERROR - 处理第 11 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,177 - utils.excel_processor - DEBUG - 行 12: 处理客户 C002
2025-03-29 01:11:36,177 - utils.excel_processor - ERROR - 处理第 12 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,178 - utils.excel_processor - DEBUG - 行 13: 处理客户 C002
2025-03-29 01:11:36,178 - utils.excel_processor - ERROR - 处理第 13 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,178 - utils.excel_processor - DEBUG - 行 14: 处理客户 C002
2025-03-29 01:11:36,179 - utils.excel_processor - ERROR - 处理第 14 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,179 - utils.excel_processor - DEBUG - 行 15: 处理客户 C002
2025-03-29 01:11:36,179 - utils.excel_processor - ERROR - 处理第 15 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,180 - utils.excel_processor - DEBUG - 行 16: 处理客户 C002
2025-03-29 01:11:36,180 - utils.excel_processor - ERROR - 处理第 16 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,181 - utils.excel_processor - DEBUG - 行 17: 处理客户 C002
2025-03-29 01:11:36,181 - utils.excel_processor - ERROR - 处理第 17 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,181 - utils.excel_processor - DEBUG - 行 18: 处理客户 C002
2025-03-29 01:11:36,182 - utils.excel_processor - ERROR - 处理第 18 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,182 - utils.excel_processor - DEBUG - 行 19: 处理客户 C002
2025-03-29 01:11:36,182 - utils.excel_processor - ERROR - 处理第 19 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,183 - utils.excel_processor - DEBUG - 行 20: 处理客户 C003
2025-03-29 01:11:36,183 - utils.excel_processor - ERROR - 处理第 20 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,183 - utils.excel_processor - DEBUG - 行 21: 处理客户 C003
2025-03-29 01:11:36,183 - utils.excel_processor - ERROR - 处理第 21 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,184 - utils.excel_processor - DEBUG - 行 22: 处理客户 C003
2025-03-29 01:11:36,184 - utils.excel_processor - ERROR - 处理第 22 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,185 - utils.excel_processor - DEBUG - 行 23: 处理客户 C003
2025-03-29 01:11:36,185 - utils.excel_processor - ERROR - 处理第 23 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,185 - utils.excel_processor - DEBUG - 行 24: 处理客户 C003
2025-03-29 01:11:36,186 - utils.excel_processor - ERROR - 处理第 24 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,186 - utils.excel_processor - DEBUG - 行 25: 处理客户 C003
2025-03-29 01:11:36,186 - utils.excel_processor - ERROR - 处理第 25 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,187 - utils.excel_processor - DEBUG - 行 26: 处理客户 C003
2025-03-29 01:11:36,187 - utils.excel_processor - ERROR - 处理第 26 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,188 - utils.excel_processor - DEBUG - 行 27: 处理客户 C003
2025-03-29 01:11:36,188 - utils.excel_processor - ERROR - 处理第 27 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,189 - utils.excel_processor - DEBUG - 行 28: 处理客户 C003
2025-03-29 01:11:36,189 - utils.excel_processor - ERROR - 处理第 28 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,190 - utils.excel_processor - DEBUG - 行 29: 处理客户 C003
2025-03-29 01:11:36,190 - utils.excel_processor - ERROR - 处理第 29 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 610, in _process_services
    if not pd.isna(item_val):
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:11:36,191 - utils.excel_processor - INFO - 服务记录处理完成，共处理 0 条记录，跳过 0 条无效记录
2025-03-29 01:11:36,191 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:11:36,191 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:11:36,191 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:11:36,191 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:11:36,191 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:11:36,192 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:11:36,192 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:11:36,192 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:11:36,192 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:11:36,192 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:11:36,194 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:11:36,195 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:11:36,195 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:11:36,195 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:11:36,195 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:11:36,195 - ExcelTest - INFO -   services: 0项
2025-03-29 01:11:36,195 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:11:36,195 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:11:36,195 - ExcelTest - INFO -   id: C001
2025-03-29 01:11:36,195 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:11:36,195 - ExcelTest - INFO -   gender: 女
2025-03-29 01:11:36,196 - ExcelTest - INFO -   age: 28
2025-03-29 01:11:36,196 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:11:36,196 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:11:36,196 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:11:36,196 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:11:36,196 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:11:36,196 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:11:36,196 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:11:36,196 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:11:36,196 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:11:36,196 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:11:36,196 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:11:36,196 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:11:36,196 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:11:36,197 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:11:36,197 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:11:36,197 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:11:36,197 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:11:36,197 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:11:36,197 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:12:43,045 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:12:43,046 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:12:43,234 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:12:43,235 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:12:43,235 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:43,235 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:12:43,235 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:12:43,235 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:43,235 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:43,455 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:12:43,455 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:12:43,455 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:12:43,455 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:12:43,455 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:12:43,456 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:12:43,464 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:12:43,464 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:12:43,464 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:12:43,465 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:12:43,465 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:12:43,465 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:12:43,465 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:12:43,466 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:12:43,466 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:12:43,466 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:12:43,466 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:12:43,466 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:12:43,466 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:12:43,467 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:12:43,467 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:12:43,467 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:12:43,467 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:12:43,467 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:12:43,467 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:12:43,468 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:12:43,468 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:12:43,468 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:12:43,468 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:43,469 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:12:43,469 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:43,469 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:12:43,469 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:12:43,469 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:43,469 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:12:43,469 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:43,470 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:12:43,470 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:12:43,471 - utils.excel_processor - INFO - 找到的关键列: 客户ID=客户ID, 到店时间=到店时间
2025-03-29 01:12:43,471 - utils.excel_processor - INFO - 找到的项目内容列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:12:43,471 - utils.excel_processor - INFO - 找到的美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:12:43,471 - utils.excel_processor - INFO - 找到的金额列: ['总耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:12:43,471 - utils.excel_processor - INFO - 找到的是否指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:12:43,472 - utils.excel_processor - DEBUG - 行 0: 处理客户 C001
2025-03-29 01:12:43,474 - utils.excel_processor - DEBUG - 行 0: 成功处理 5 条服务记录
2025-03-29 01:12:43,474 - utils.excel_processor - DEBUG - 行 1: 处理客户 C001
2025-03-29 01:12:43,474 - utils.excel_processor - DEBUG - 行 1: 成功处理 5 条服务记录
2025-03-29 01:12:43,474 - utils.excel_processor - DEBUG - 行 2: 处理客户 C001
2025-03-29 01:12:43,475 - utils.excel_processor - DEBUG - 行 2: 成功处理 5 条服务记录
2025-03-29 01:12:43,476 - utils.excel_processor - DEBUG - 行 3: 处理客户 C001
2025-03-29 01:12:43,477 - utils.excel_processor - DEBUG - 行 3: 成功处理 5 条服务记录
2025-03-29 01:12:43,477 - utils.excel_processor - DEBUG - 行 4: 处理客户 C001
2025-03-29 01:12:43,479 - utils.excel_processor - DEBUG - 行 4: 成功处理 5 条服务记录
2025-03-29 01:12:43,479 - utils.excel_processor - DEBUG - 行 5: 处理客户 C001
2025-03-29 01:12:43,480 - utils.excel_processor - DEBUG - 行 5: 成功处理 5 条服务记录
2025-03-29 01:12:43,480 - utils.excel_processor - DEBUG - 行 6: 处理客户 C001
2025-03-29 01:12:43,481 - utils.excel_processor - DEBUG - 行 6: 成功处理 5 条服务记录
2025-03-29 01:12:43,481 - utils.excel_processor - DEBUG - 行 7: 处理客户 C001
2025-03-29 01:12:43,483 - utils.excel_processor - DEBUG - 行 7: 成功处理 5 条服务记录
2025-03-29 01:12:43,483 - utils.excel_processor - DEBUG - 行 8: 处理客户 C001
2025-03-29 01:12:43,484 - utils.excel_processor - DEBUG - 行 8: 成功处理 5 条服务记录
2025-03-29 01:12:43,484 - utils.excel_processor - DEBUG - 行 9: 处理客户 C001
2025-03-29 01:12:43,485 - utils.excel_processor - DEBUG - 行 9: 成功处理 5 条服务记录
2025-03-29 01:12:43,485 - utils.excel_processor - DEBUG - 行 10: 处理客户 C002
2025-03-29 01:12:43,486 - utils.excel_processor - DEBUG - 行 10: 成功处理 5 条服务记录
2025-03-29 01:12:43,486 - utils.excel_processor - DEBUG - 行 11: 处理客户 C002
2025-03-29 01:12:43,487 - utils.excel_processor - DEBUG - 行 11: 成功处理 5 条服务记录
2025-03-29 01:12:43,487 - utils.excel_processor - DEBUG - 行 12: 处理客户 C002
2025-03-29 01:12:43,488 - utils.excel_processor - DEBUG - 行 12: 成功处理 5 条服务记录
2025-03-29 01:12:43,488 - utils.excel_processor - DEBUG - 行 13: 处理客户 C002
2025-03-29 01:12:43,489 - utils.excel_processor - DEBUG - 行 13: 成功处理 5 条服务记录
2025-03-29 01:12:43,489 - utils.excel_processor - DEBUG - 行 14: 处理客户 C002
2025-03-29 01:12:43,490 - utils.excel_processor - DEBUG - 行 14: 成功处理 5 条服务记录
2025-03-29 01:12:43,491 - utils.excel_processor - DEBUG - 行 15: 处理客户 C002
2025-03-29 01:12:43,492 - utils.excel_processor - DEBUG - 行 15: 成功处理 5 条服务记录
2025-03-29 01:12:43,492 - utils.excel_processor - DEBUG - 行 16: 处理客户 C002
2025-03-29 01:12:43,493 - utils.excel_processor - DEBUG - 行 16: 成功处理 5 条服务记录
2025-03-29 01:12:43,493 - utils.excel_processor - DEBUG - 行 17: 处理客户 C002
2025-03-29 01:12:43,494 - utils.excel_processor - DEBUG - 行 17: 成功处理 5 条服务记录
2025-03-29 01:12:43,494 - utils.excel_processor - DEBUG - 行 18: 处理客户 C002
2025-03-29 01:12:43,495 - utils.excel_processor - DEBUG - 行 18: 成功处理 5 条服务记录
2025-03-29 01:12:43,495 - utils.excel_processor - DEBUG - 行 19: 处理客户 C002
2025-03-29 01:12:43,496 - utils.excel_processor - DEBUG - 行 19: 成功处理 5 条服务记录
2025-03-29 01:12:43,497 - utils.excel_processor - DEBUG - 行 20: 处理客户 C003
2025-03-29 01:12:43,498 - utils.excel_processor - DEBUG - 行 20: 成功处理 5 条服务记录
2025-03-29 01:12:43,498 - utils.excel_processor - DEBUG - 行 21: 处理客户 C003
2025-03-29 01:12:43,499 - utils.excel_processor - DEBUG - 行 21: 成功处理 5 条服务记录
2025-03-29 01:12:43,499 - utils.excel_processor - DEBUG - 行 22: 处理客户 C003
2025-03-29 01:12:43,500 - utils.excel_processor - DEBUG - 行 22: 成功处理 5 条服务记录
2025-03-29 01:12:43,500 - utils.excel_processor - DEBUG - 行 23: 处理客户 C003
2025-03-29 01:12:43,501 - utils.excel_processor - DEBUG - 行 23: 成功处理 5 条服务记录
2025-03-29 01:12:43,501 - utils.excel_processor - DEBUG - 行 24: 处理客户 C003
2025-03-29 01:12:43,502 - utils.excel_processor - DEBUG - 行 24: 成功处理 5 条服务记录
2025-03-29 01:12:43,502 - utils.excel_processor - DEBUG - 行 25: 处理客户 C003
2025-03-29 01:12:43,504 - utils.excel_processor - DEBUG - 行 25: 成功处理 5 条服务记录
2025-03-29 01:12:43,504 - utils.excel_processor - DEBUG - 行 26: 处理客户 C003
2025-03-29 01:12:43,504 - utils.excel_processor - DEBUG - 行 26: 成功处理 5 条服务记录
2025-03-29 01:12:43,505 - utils.excel_processor - DEBUG - 行 27: 处理客户 C003
2025-03-29 01:12:43,506 - utils.excel_processor - DEBUG - 行 27: 成功处理 5 条服务记录
2025-03-29 01:12:43,506 - utils.excel_processor - DEBUG - 行 28: 处理客户 C003
2025-03-29 01:12:43,507 - utils.excel_processor - DEBUG - 行 28: 成功处理 5 条服务记录
2025-03-29 01:12:43,507 - utils.excel_processor - DEBUG - 行 29: 处理客户 C003
2025-03-29 01:12:43,508 - utils.excel_processor - DEBUG - 行 29: 成功处理 5 条服务记录
2025-03-29 01:12:43,509 - utils.excel_processor - INFO - 服务记录处理完成，共处理 150 条记录，跳过 0 条无效记录
2025-03-29 01:12:43,509 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:12:43,509 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:12:43,509 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:12:43,509 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:12:43,509 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:12:43,510 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:12:43,510 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:12:43,510 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:12:43,510 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:43,510 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:12:43,512 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:12:43,513 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:12:43,513 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:12:43,513 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:12:43,513 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:12:43,513 - ExcelTest - INFO -   services: 150项
2025-03-29 01:12:43,513 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:12:43,513 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:12:43,513 - ExcelTest - INFO -   id: C001
2025-03-29 01:12:43,513 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:12:43,513 - ExcelTest - INFO -   gender: 女
2025-03-29 01:12:43,514 - ExcelTest - INFO -   age: 28
2025-03-29 01:12:43,514 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:12:43,514 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:12:43,514 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:12:43,515 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:12:43,515 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:12:43,515 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:12:43,515 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:12:43,515 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:12:43,515 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:12:43,515 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:12:43,515 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:12:43,516 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:12:43,516 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:12:43,516 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:12:43,516 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:12:43,516 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:12:43,516 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:12:43,516 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:12:43,516 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:12:56,483 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:12:56,483 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:12:56,665 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:12:56,665 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:12:56,666 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:56,666 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:12:56,666 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:12:56,666 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:56,666 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:56,878 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:12:56,879 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:12:56,879 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:12:56,879 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:12:56,879 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:12:56,880 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:12:56,887 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:12:56,888 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:12:56,888 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:12:56,888 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:12:56,888 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:12:56,889 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:12:56,890 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:12:56,890 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:12:56,890 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:12:56,891 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:12:56,891 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:12:56,891 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:12:56,891 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:12:56,891 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:12:56,891 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:12:56,891 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:56,892 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:12:56,892 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:56,892 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:12:56,892 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:12:56,892 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:56,892 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:12:56,893 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:12:56,893 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:12:56,893 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:12:56,894 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:12:56,894 - utils.excel_processor - INFO - 找到的关键列: 客户ID=客户ID, 到店时间=到店时间
2025-03-29 01:12:56,894 - utils.excel_processor - INFO - 找到的项目内容列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:12:56,894 - utils.excel_processor - INFO - 找到的美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:12:56,894 - utils.excel_processor - INFO - 找到的金额列: ['总耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:12:56,894 - utils.excel_processor - INFO - 找到的是否指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:12:56,894 - utils.excel_processor - DEBUG - 行 0: 处理客户 C001
2025-03-29 01:12:56,895 - utils.excel_processor - DEBUG - 行 0: 成功处理 5 条服务记录
2025-03-29 01:12:56,895 - utils.excel_processor - DEBUG - 行 1: 处理客户 C001
2025-03-29 01:12:56,896 - utils.excel_processor - DEBUG - 行 1: 成功处理 5 条服务记录
2025-03-29 01:12:56,896 - utils.excel_processor - DEBUG - 行 2: 处理客户 C001
2025-03-29 01:12:56,897 - utils.excel_processor - DEBUG - 行 2: 成功处理 5 条服务记录
2025-03-29 01:12:56,897 - utils.excel_processor - DEBUG - 行 3: 处理客户 C001
2025-03-29 01:12:56,898 - utils.excel_processor - DEBUG - 行 3: 成功处理 5 条服务记录
2025-03-29 01:12:56,898 - utils.excel_processor - DEBUG - 行 4: 处理客户 C001
2025-03-29 01:12:56,899 - utils.excel_processor - DEBUG - 行 4: 成功处理 5 条服务记录
2025-03-29 01:12:56,900 - utils.excel_processor - DEBUG - 行 5: 处理客户 C001
2025-03-29 01:12:56,900 - utils.excel_processor - DEBUG - 行 5: 成功处理 5 条服务记录
2025-03-29 01:12:56,901 - utils.excel_processor - DEBUG - 行 6: 处理客户 C001
2025-03-29 01:12:56,902 - utils.excel_processor - DEBUG - 行 6: 成功处理 5 条服务记录
2025-03-29 01:12:56,902 - utils.excel_processor - DEBUG - 行 7: 处理客户 C001
2025-03-29 01:12:56,904 - utils.excel_processor - DEBUG - 行 7: 成功处理 5 条服务记录
2025-03-29 01:12:56,904 - utils.excel_processor - DEBUG - 行 8: 处理客户 C001
2025-03-29 01:12:56,905 - utils.excel_processor - DEBUG - 行 8: 成功处理 5 条服务记录
2025-03-29 01:12:56,905 - utils.excel_processor - DEBUG - 行 9: 处理客户 C001
2025-03-29 01:12:56,906 - utils.excel_processor - DEBUG - 行 9: 成功处理 5 条服务记录
2025-03-29 01:12:56,906 - utils.excel_processor - DEBUG - 行 10: 处理客户 C002
2025-03-29 01:12:56,907 - utils.excel_processor - DEBUG - 行 10: 成功处理 5 条服务记录
2025-03-29 01:12:56,907 - utils.excel_processor - DEBUG - 行 11: 处理客户 C002
2025-03-29 01:12:56,908 - utils.excel_processor - DEBUG - 行 11: 成功处理 5 条服务记录
2025-03-29 01:12:56,908 - utils.excel_processor - DEBUG - 行 12: 处理客户 C002
2025-03-29 01:12:56,909 - utils.excel_processor - DEBUG - 行 12: 成功处理 5 条服务记录
2025-03-29 01:12:56,909 - utils.excel_processor - DEBUG - 行 13: 处理客户 C002
2025-03-29 01:12:56,910 - utils.excel_processor - DEBUG - 行 13: 成功处理 5 条服务记录
2025-03-29 01:12:56,910 - utils.excel_processor - DEBUG - 行 14: 处理客户 C002
2025-03-29 01:12:56,911 - utils.excel_processor - DEBUG - 行 14: 成功处理 5 条服务记录
2025-03-29 01:12:56,911 - utils.excel_processor - DEBUG - 行 15: 处理客户 C002
2025-03-29 01:12:56,912 - utils.excel_processor - DEBUG - 行 15: 成功处理 5 条服务记录
2025-03-29 01:12:56,912 - utils.excel_processor - DEBUG - 行 16: 处理客户 C002
2025-03-29 01:12:56,913 - utils.excel_processor - DEBUG - 行 16: 成功处理 5 条服务记录
2025-03-29 01:12:56,914 - utils.excel_processor - DEBUG - 行 17: 处理客户 C002
2025-03-29 01:12:56,915 - utils.excel_processor - DEBUG - 行 17: 成功处理 5 条服务记录
2025-03-29 01:12:56,915 - utils.excel_processor - DEBUG - 行 18: 处理客户 C002
2025-03-29 01:12:56,916 - utils.excel_processor - DEBUG - 行 18: 成功处理 5 条服务记录
2025-03-29 01:12:56,916 - utils.excel_processor - DEBUG - 行 19: 处理客户 C002
2025-03-29 01:12:56,917 - utils.excel_processor - DEBUG - 行 19: 成功处理 5 条服务记录
2025-03-29 01:12:56,917 - utils.excel_processor - DEBUG - 行 20: 处理客户 C003
2025-03-29 01:12:56,918 - utils.excel_processor - DEBUG - 行 20: 成功处理 5 条服务记录
2025-03-29 01:12:56,918 - utils.excel_processor - DEBUG - 行 21: 处理客户 C003
2025-03-29 01:12:56,919 - utils.excel_processor - DEBUG - 行 21: 成功处理 5 条服务记录
2025-03-29 01:12:56,919 - utils.excel_processor - DEBUG - 行 22: 处理客户 C003
2025-03-29 01:12:56,920 - utils.excel_processor - DEBUG - 行 22: 成功处理 5 条服务记录
2025-03-29 01:12:56,920 - utils.excel_processor - DEBUG - 行 23: 处理客户 C003
2025-03-29 01:12:56,921 - utils.excel_processor - DEBUG - 行 23: 成功处理 5 条服务记录
2025-03-29 01:12:56,922 - utils.excel_processor - DEBUG - 行 24: 处理客户 C003
2025-03-29 01:12:56,923 - utils.excel_processor - DEBUG - 行 24: 成功处理 5 条服务记录
2025-03-29 01:12:56,923 - utils.excel_processor - DEBUG - 行 25: 处理客户 C003
2025-03-29 01:12:56,924 - utils.excel_processor - DEBUG - 行 25: 成功处理 5 条服务记录
2025-03-29 01:12:56,924 - utils.excel_processor - DEBUG - 行 26: 处理客户 C003
2025-03-29 01:12:56,924 - utils.excel_processor - DEBUG - 行 26: 成功处理 5 条服务记录
2025-03-29 01:12:56,925 - utils.excel_processor - DEBUG - 行 27: 处理客户 C003
2025-03-29 01:12:56,926 - utils.excel_processor - DEBUG - 行 27: 成功处理 5 条服务记录
2025-03-29 01:12:56,926 - utils.excel_processor - DEBUG - 行 28: 处理客户 C003
2025-03-29 01:12:56,927 - utils.excel_processor - DEBUG - 行 28: 成功处理 5 条服务记录
2025-03-29 01:12:56,927 - utils.excel_processor - DEBUG - 行 29: 处理客户 C003
2025-03-29 01:12:56,928 - utils.excel_processor - DEBUG - 行 29: 成功处理 5 条服务记录
2025-03-29 01:12:56,928 - utils.excel_processor - INFO - 服务记录处理完成，共处理 150 条记录，跳过 0 条无效记录
2025-03-29 01:12:56,929 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:12:56,929 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:12:56,929 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:12:56,929 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:12:56,929 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:12:56,930 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:12:56,930 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:12:56,930 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:12:56,930 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:12:56,930 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:12:56,933 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:12:56,933 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:12:56,933 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:12:56,933 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:12:56,933 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:12:56,933 - ExcelTest - INFO -   services: 150项
2025-03-29 01:12:56,933 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:12:56,934 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:12:56,934 - ExcelTest - INFO -   id: C001
2025-03-29 01:12:56,934 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:12:56,934 - ExcelTest - INFO -   gender: 女
2025-03-29 01:12:56,934 - ExcelTest - INFO -   age: 28
2025-03-29 01:12:56,934 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:12:56,934 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:12:56,934 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:12:56,934 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:12:56,934 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:12:56,934 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:12:56,934 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:12:56,934 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:12:56,935 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:12:56,935 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:12:56,935 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:12:56,935 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:12:56,935 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:12:56,935 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:12:56,935 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:12:56,935 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:12:56,935 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:12:56,935 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:12:56,935 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:14:08,900 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:14:08,900 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:14:09,093 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:14:09,094 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:14:09,094 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:14:09,094 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:14:09,094 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:14:09,094 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:14:09,094 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:14:09,327 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:14:09,328 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:14:09,328 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:14:09,328 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:14:09,328 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:14:09,329 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:14:09,336 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:14:09,337 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:14:09,337 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:14:09,337 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:14:09,337 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:14:09,337 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:14:09,338 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:14:09,338 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:14:09,338 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:14:09,338 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:14:09,338 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:14:09,338 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:14:09,339 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:14:09,339 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:14:09,339 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:14:09,339 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:14:09,339 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:14:09,339 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:14:09,340 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:14:09,340 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:14:09,340 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:14:09,340 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:14:09,340 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:14:09,341 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:14:09,341 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:14:09,341 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:14:09,341 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:14:09,341 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:14:09,342 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:14:09,342 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:14:09,342 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:14:09,342 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:14:09,342 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:14:09,342 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:14:09,342 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:14:09,342 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:14:09,342 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 找到的关键列: 客户ID=客户ID, 到店时间=到店时间
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 找到的项目内容列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 找到的美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 找到的金额列: ['总耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:14:09,343 - utils.excel_processor - INFO - 找到的是否指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:14:09,343 - utils.excel_processor - DEBUG - 行 0: 处理客户 C001
2025-03-29 01:14:09,344 - utils.excel_processor - DEBUG - 行 0: 成功处理 5 条服务记录
2025-03-29 01:14:09,345 - utils.excel_processor - DEBUG - 行 1: 处理客户 C001
2025-03-29 01:14:09,346 - utils.excel_processor - DEBUG - 行 1: 成功处理 5 条服务记录
2025-03-29 01:14:09,346 - utils.excel_processor - DEBUG - 行 2: 处理客户 C001
2025-03-29 01:14:09,347 - utils.excel_processor - DEBUG - 行 2: 成功处理 5 条服务记录
2025-03-29 01:14:09,347 - utils.excel_processor - DEBUG - 行 3: 处理客户 C001
2025-03-29 01:14:09,348 - utils.excel_processor - DEBUG - 行 3: 成功处理 5 条服务记录
2025-03-29 01:14:09,348 - utils.excel_processor - DEBUG - 行 4: 处理客户 C001
2025-03-29 01:14:09,350 - utils.excel_processor - DEBUG - 行 4: 成功处理 5 条服务记录
2025-03-29 01:14:09,350 - utils.excel_processor - DEBUG - 行 5: 处理客户 C001
2025-03-29 01:14:09,351 - utils.excel_processor - DEBUG - 行 5: 成功处理 5 条服务记录
2025-03-29 01:14:09,352 - utils.excel_processor - DEBUG - 行 6: 处理客户 C001
2025-03-29 01:14:09,352 - utils.excel_processor - DEBUG - 行 6: 成功处理 5 条服务记录
2025-03-29 01:14:09,353 - utils.excel_processor - DEBUG - 行 7: 处理客户 C001
2025-03-29 01:14:09,354 - utils.excel_processor - DEBUG - 行 7: 成功处理 5 条服务记录
2025-03-29 01:14:09,354 - utils.excel_processor - DEBUG - 行 8: 处理客户 C001
2025-03-29 01:14:09,355 - utils.excel_processor - DEBUG - 行 8: 成功处理 5 条服务记录
2025-03-29 01:14:09,356 - utils.excel_processor - DEBUG - 行 9: 处理客户 C001
2025-03-29 01:14:09,357 - utils.excel_processor - DEBUG - 行 9: 成功处理 5 条服务记录
2025-03-29 01:14:09,357 - utils.excel_processor - DEBUG - 行 10: 处理客户 C002
2025-03-29 01:14:09,358 - utils.excel_processor - DEBUG - 行 10: 成功处理 5 条服务记录
2025-03-29 01:14:09,358 - utils.excel_processor - DEBUG - 行 11: 处理客户 C002
2025-03-29 01:14:09,359 - utils.excel_processor - DEBUG - 行 11: 成功处理 5 条服务记录
2025-03-29 01:14:09,359 - utils.excel_processor - DEBUG - 行 12: 处理客户 C002
2025-03-29 01:14:09,360 - utils.excel_processor - DEBUG - 行 12: 成功处理 5 条服务记录
2025-03-29 01:14:09,360 - utils.excel_processor - DEBUG - 行 13: 处理客户 C002
2025-03-29 01:14:09,361 - utils.excel_processor - DEBUG - 行 13: 成功处理 5 条服务记录
2025-03-29 01:14:09,361 - utils.excel_processor - DEBUG - 行 14: 处理客户 C002
2025-03-29 01:14:09,362 - utils.excel_processor - DEBUG - 行 14: 成功处理 5 条服务记录
2025-03-29 01:14:09,363 - utils.excel_processor - DEBUG - 行 15: 处理客户 C002
2025-03-29 01:14:09,363 - utils.excel_processor - DEBUG - 行 15: 成功处理 5 条服务记录
2025-03-29 01:14:09,363 - utils.excel_processor - DEBUG - 行 16: 处理客户 C002
2025-03-29 01:14:09,364 - utils.excel_processor - DEBUG - 行 16: 成功处理 5 条服务记录
2025-03-29 01:14:09,364 - utils.excel_processor - DEBUG - 行 17: 处理客户 C002
2025-03-29 01:14:09,365 - utils.excel_processor - DEBUG - 行 17: 成功处理 5 条服务记录
2025-03-29 01:14:09,365 - utils.excel_processor - DEBUG - 行 18: 处理客户 C002
2025-03-29 01:14:09,366 - utils.excel_processor - DEBUG - 行 18: 成功处理 5 条服务记录
2025-03-29 01:14:09,366 - utils.excel_processor - DEBUG - 行 19: 处理客户 C002
2025-03-29 01:14:09,367 - utils.excel_processor - DEBUG - 行 19: 成功处理 5 条服务记录
2025-03-29 01:14:09,368 - utils.excel_processor - DEBUG - 行 20: 处理客户 C003
2025-03-29 01:14:09,369 - utils.excel_processor - DEBUG - 行 20: 成功处理 5 条服务记录
2025-03-29 01:14:09,369 - utils.excel_processor - DEBUG - 行 21: 处理客户 C003
2025-03-29 01:14:09,370 - utils.excel_processor - DEBUG - 行 21: 成功处理 5 条服务记录
2025-03-29 01:14:09,370 - utils.excel_processor - DEBUG - 行 22: 处理客户 C003
2025-03-29 01:14:09,371 - utils.excel_processor - DEBUG - 行 22: 成功处理 5 条服务记录
2025-03-29 01:14:09,371 - utils.excel_processor - DEBUG - 行 23: 处理客户 C003
2025-03-29 01:14:09,372 - utils.excel_processor - DEBUG - 行 23: 成功处理 5 条服务记录
2025-03-29 01:14:09,372 - utils.excel_processor - DEBUG - 行 24: 处理客户 C003
2025-03-29 01:14:09,373 - utils.excel_processor - DEBUG - 行 24: 成功处理 5 条服务记录
2025-03-29 01:14:09,374 - utils.excel_processor - DEBUG - 行 25: 处理客户 C003
2025-03-29 01:14:09,375 - utils.excel_processor - DEBUG - 行 25: 成功处理 5 条服务记录
2025-03-29 01:14:09,375 - utils.excel_processor - DEBUG - 行 26: 处理客户 C003
2025-03-29 01:14:09,376 - utils.excel_processor - DEBUG - 行 26: 成功处理 5 条服务记录
2025-03-29 01:14:09,376 - utils.excel_processor - DEBUG - 行 27: 处理客户 C003
2025-03-29 01:14:09,377 - utils.excel_processor - DEBUG - 行 27: 成功处理 5 条服务记录
2025-03-29 01:14:09,377 - utils.excel_processor - DEBUG - 行 28: 处理客户 C003
2025-03-29 01:14:09,378 - utils.excel_processor - DEBUG - 行 28: 成功处理 5 条服务记录
2025-03-29 01:14:09,378 - utils.excel_processor - DEBUG - 行 29: 处理客户 C003
2025-03-29 01:14:09,379 - utils.excel_processor - DEBUG - 行 29: 成功处理 5 条服务记录
2025-03-29 01:14:09,380 - utils.excel_processor - INFO - 服务记录处理完成，共处理 150 条记录，跳过 0 条无效记录
2025-03-29 01:14:09,380 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:14:09,380 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:14:09,380 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:14:09,380 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:14:09,381 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:14:09,381 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:14:09,381 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:14:09,381 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:14:09,381 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:14:09,382 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:14:09,384 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:14:09,384 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:14:09,384 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:14:09,384 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:14:09,384 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:14:09,384 - ExcelTest - INFO -   services: 150项
2025-03-29 01:14:09,384 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:14:09,386 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:14:09,386 - ExcelTest - INFO -   id: C001
2025-03-29 01:14:09,386 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:14:09,386 - ExcelTest - INFO -   gender: 女
2025-03-29 01:14:09,386 - ExcelTest - INFO -   age: 28
2025-03-29 01:14:09,386 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:14:09,386 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:14:09,386 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:14:09,386 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:14:09,386 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:14:09,387 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:14:09,387 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:14:09,387 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:14:09,387 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:14:09,387 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:14:09,387 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:14:09,387 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:14:09,387 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:14:09,387 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:14:09,388 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:14:09,388 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:14:09,388 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:14:09,388 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:14:09,388 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:15:03,542 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:15:03,542 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:15:03,722 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:15:03,722 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:15:03,722 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:03,722 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:15:03,722 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:15:03,722 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:03,722 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:03,947 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:15:03,948 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:15:03,948 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:15:03,948 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:15:03,948 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:15:03,949 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:15:03,957 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:15:03,957 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:15:03,957 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:15:03,958 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:15:03,959 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:15:03,959 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:15:03,959 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:15:03,959 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:15:03,959 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:15:03,959 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:15:03,960 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:15:03,960 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:15:03,960 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:03,961 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:15:03,961 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:03,961 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:15:03,961 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:15:03,962 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:03,962 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:15:03,962 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:03,962 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:15:03,962 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:15:03,963 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:15:03,964 - utils.excel_processor - INFO - 找到的关键列: 客户ID=客户ID, 到店时间=到店时间
2025-03-29 01:15:03,964 - utils.excel_processor - INFO - 找到的项目内容列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:15:03,964 - utils.excel_processor - INFO - 找到的美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:15:03,964 - utils.excel_processor - INFO - 找到的金额列: ['总耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:15:03,964 - utils.excel_processor - INFO - 找到的是否指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:15:03,964 - utils.excel_processor - DEBUG - 行 0: 处理客户 C001
2025-03-29 01:15:03,965 - utils.excel_processor - DEBUG - 行 0: 成功处理 5 条服务记录
2025-03-29 01:15:03,965 - utils.excel_processor - DEBUG - 行 1: 处理客户 C001
2025-03-29 01:15:03,966 - utils.excel_processor - DEBUG - 行 1: 成功处理 5 条服务记录
2025-03-29 01:15:03,966 - utils.excel_processor - DEBUG - 行 2: 处理客户 C001
2025-03-29 01:15:03,967 - utils.excel_processor - DEBUG - 行 2: 成功处理 5 条服务记录
2025-03-29 01:15:03,968 - utils.excel_processor - DEBUG - 行 3: 处理客户 C001
2025-03-29 01:15:03,969 - utils.excel_processor - DEBUG - 行 3: 成功处理 5 条服务记录
2025-03-29 01:15:03,969 - utils.excel_processor - DEBUG - 行 4: 处理客户 C001
2025-03-29 01:15:03,970 - utils.excel_processor - DEBUG - 行 4: 成功处理 5 条服务记录
2025-03-29 01:15:03,970 - utils.excel_processor - DEBUG - 行 5: 处理客户 C001
2025-03-29 01:15:03,971 - utils.excel_processor - DEBUG - 行 5: 成功处理 5 条服务记录
2025-03-29 01:15:03,971 - utils.excel_processor - DEBUG - 行 6: 处理客户 C001
2025-03-29 01:15:03,972 - utils.excel_processor - DEBUG - 行 6: 成功处理 5 条服务记录
2025-03-29 01:15:03,972 - utils.excel_processor - DEBUG - 行 7: 处理客户 C001
2025-03-29 01:15:03,974 - utils.excel_processor - DEBUG - 行 7: 成功处理 5 条服务记录
2025-03-29 01:15:03,975 - utils.excel_processor - DEBUG - 行 8: 处理客户 C001
2025-03-29 01:15:03,976 - utils.excel_processor - DEBUG - 行 8: 成功处理 5 条服务记录
2025-03-29 01:15:03,976 - utils.excel_processor - DEBUG - 行 9: 处理客户 C001
2025-03-29 01:15:03,977 - utils.excel_processor - DEBUG - 行 9: 成功处理 5 条服务记录
2025-03-29 01:15:03,977 - utils.excel_processor - DEBUG - 行 10: 处理客户 C002
2025-03-29 01:15:03,978 - utils.excel_processor - DEBUG - 行 10: 成功处理 5 条服务记录
2025-03-29 01:15:03,978 - utils.excel_processor - DEBUG - 行 11: 处理客户 C002
2025-03-29 01:15:03,979 - utils.excel_processor - DEBUG - 行 11: 成功处理 5 条服务记录
2025-03-29 01:15:03,979 - utils.excel_processor - DEBUG - 行 12: 处理客户 C002
2025-03-29 01:15:03,980 - utils.excel_processor - DEBUG - 行 12: 成功处理 5 条服务记录
2025-03-29 01:15:03,981 - utils.excel_processor - DEBUG - 行 13: 处理客户 C002
2025-03-29 01:15:03,981 - utils.excel_processor - DEBUG - 行 13: 成功处理 5 条服务记录
2025-03-29 01:15:03,982 - utils.excel_processor - DEBUG - 行 14: 处理客户 C002
2025-03-29 01:15:03,983 - utils.excel_processor - DEBUG - 行 14: 成功处理 5 条服务记录
2025-03-29 01:15:03,983 - utils.excel_processor - DEBUG - 行 15: 处理客户 C002
2025-03-29 01:15:03,983 - utils.excel_processor - DEBUG - 行 15: 成功处理 5 条服务记录
2025-03-29 01:15:03,983 - utils.excel_processor - DEBUG - 行 16: 处理客户 C002
2025-03-29 01:15:03,984 - utils.excel_processor - DEBUG - 行 16: 成功处理 5 条服务记录
2025-03-29 01:15:03,985 - utils.excel_processor - DEBUG - 行 17: 处理客户 C002
2025-03-29 01:15:03,986 - utils.excel_processor - DEBUG - 行 17: 成功处理 5 条服务记录
2025-03-29 01:15:03,986 - utils.excel_processor - DEBUG - 行 18: 处理客户 C002
2025-03-29 01:15:03,987 - utils.excel_processor - DEBUG - 行 18: 成功处理 5 条服务记录
2025-03-29 01:15:03,987 - utils.excel_processor - DEBUG - 行 19: 处理客户 C002
2025-03-29 01:15:03,988 - utils.excel_processor - DEBUG - 行 19: 成功处理 5 条服务记录
2025-03-29 01:15:03,989 - utils.excel_processor - DEBUG - 行 20: 处理客户 C003
2025-03-29 01:15:03,989 - utils.excel_processor - DEBUG - 行 20: 成功处理 5 条服务记录
2025-03-29 01:15:03,990 - utils.excel_processor - DEBUG - 行 21: 处理客户 C003
2025-03-29 01:15:03,991 - utils.excel_processor - DEBUG - 行 21: 成功处理 5 条服务记录
2025-03-29 01:15:03,991 - utils.excel_processor - DEBUG - 行 22: 处理客户 C003
2025-03-29 01:15:03,992 - utils.excel_processor - DEBUG - 行 22: 成功处理 5 条服务记录
2025-03-29 01:15:03,993 - utils.excel_processor - DEBUG - 行 23: 处理客户 C003
2025-03-29 01:15:03,994 - utils.excel_processor - DEBUG - 行 23: 成功处理 5 条服务记录
2025-03-29 01:15:03,994 - utils.excel_processor - DEBUG - 行 24: 处理客户 C003
2025-03-29 01:15:03,995 - utils.excel_processor - DEBUG - 行 24: 成功处理 5 条服务记录
2025-03-29 01:15:03,995 - utils.excel_processor - DEBUG - 行 25: 处理客户 C003
2025-03-29 01:15:03,996 - utils.excel_processor - DEBUG - 行 25: 成功处理 5 条服务记录
2025-03-29 01:15:03,996 - utils.excel_processor - DEBUG - 行 26: 处理客户 C003
2025-03-29 01:15:03,997 - utils.excel_processor - DEBUG - 行 26: 成功处理 5 条服务记录
2025-03-29 01:15:03,998 - utils.excel_processor - DEBUG - 行 27: 处理客户 C003
2025-03-29 01:15:03,999 - utils.excel_processor - DEBUG - 行 27: 成功处理 5 条服务记录
2025-03-29 01:15:03,999 - utils.excel_processor - DEBUG - 行 28: 处理客户 C003
2025-03-29 01:15:04,000 - utils.excel_processor - DEBUG - 行 28: 成功处理 5 条服务记录
2025-03-29 01:15:04,000 - utils.excel_processor - DEBUG - 行 29: 处理客户 C003
2025-03-29 01:15:04,001 - utils.excel_processor - DEBUG - 行 29: 成功处理 5 条服务记录
2025-03-29 01:15:04,001 - utils.excel_processor - INFO - 服务记录处理完成，共处理 150 条记录，跳过 0 条无效记录
2025-03-29 01:15:04,001 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:15:04,001 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:15:04,001 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:15:04,002 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:15:04,002 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:15:04,003 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:15:04,003 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:15:04,003 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:15:04,004 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:04,004 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:15:04,006 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:15:04,006 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:15:04,006 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:15:04,006 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:15:04,007 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:15:04,007 - ExcelTest - INFO -   services: 150项
2025-03-29 01:15:04,007 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:15:04,007 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:15:04,007 - ExcelTest - INFO -   id: C001
2025-03-29 01:15:04,007 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:15:04,007 - ExcelTest - INFO -   gender: 女
2025-03-29 01:15:04,007 - ExcelTest - INFO -   age: 28
2025-03-29 01:15:04,007 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:15:04,007 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:15:04,007 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:15:04,007 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:15:04,007 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:15:04,007 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:15:04,008 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:15:04,008 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:15:04,008 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:15:04,008 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:15:04,008 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:15:04,008 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:15:04,008 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:15:04,008 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:15:04,009 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:15:04,009 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:15:04,009 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:15:04,009 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:15:04,009 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:15:39,944 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:15:39,944 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:15:40,125 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:15:40,125 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:15:40,125 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:40,125 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:15:40,125 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:15:40,125 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:40,125 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:40,344 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:15:40,345 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:15:40,345 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:15:40,345 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:15:40,345 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:15:40,346 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:15:40,353 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:15:40,353 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:15:40,353 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:15:40,354 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:15:40,354 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:15:40,355 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:15:40,355 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:15:40,355 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:15:40,355 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:15:40,355 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:15:40,355 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:15:40,356 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:15:40,356 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:15:40,356 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:15:40,356 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:15:40,356 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:15:40,357 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:15:40,357 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:15:40,357 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:15:40,357 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:15:40,357 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:15:40,357 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:15:40,358 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:15:40,359 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:15:40,359 - utils.excel_processor - INFO - 找到的关键列: 客户ID=客户ID, 到店时间=到店时间
2025-03-29 01:15:40,360 - utils.excel_processor - INFO - 找到的项目内容列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:15:40,360 - utils.excel_processor - INFO - 找到的美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:15:40,360 - utils.excel_processor - INFO - 找到的金额列: ['总耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:15:40,360 - utils.excel_processor - INFO - 找到的是否指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:15:40,360 - utils.excel_processor - DEBUG - 行 0: 处理客户 C001
2025-03-29 01:15:40,361 - utils.excel_processor - DEBUG - 行 0: 成功处理 5 条服务记录
2025-03-29 01:15:40,361 - utils.excel_processor - DEBUG - 行 1: 处理客户 C001
2025-03-29 01:15:40,362 - utils.excel_processor - DEBUG - 行 1: 成功处理 5 条服务记录
2025-03-29 01:15:40,363 - utils.excel_processor - DEBUG - 行 2: 处理客户 C001
2025-03-29 01:15:40,363 - utils.excel_processor - DEBUG - 行 2: 成功处理 5 条服务记录
2025-03-29 01:15:40,363 - utils.excel_processor - DEBUG - 行 3: 处理客户 C001
2025-03-29 01:15:40,364 - utils.excel_processor - DEBUG - 行 3: 成功处理 5 条服务记录
2025-03-29 01:15:40,364 - utils.excel_processor - DEBUG - 行 4: 处理客户 C001
2025-03-29 01:15:40,365 - utils.excel_processor - DEBUG - 行 4: 成功处理 5 条服务记录
2025-03-29 01:15:40,365 - utils.excel_processor - DEBUG - 行 5: 处理客户 C001
2025-03-29 01:15:40,367 - utils.excel_processor - DEBUG - 行 5: 成功处理 5 条服务记录
2025-03-29 01:15:40,367 - utils.excel_processor - DEBUG - 行 6: 处理客户 C001
2025-03-29 01:15:40,368 - utils.excel_processor - DEBUG - 行 6: 成功处理 5 条服务记录
2025-03-29 01:15:40,368 - utils.excel_processor - DEBUG - 行 7: 处理客户 C001
2025-03-29 01:15:40,369 - utils.excel_processor - DEBUG - 行 7: 成功处理 5 条服务记录
2025-03-29 01:15:40,369 - utils.excel_processor - DEBUG - 行 8: 处理客户 C001
2025-03-29 01:15:40,370 - utils.excel_processor - DEBUG - 行 8: 成功处理 5 条服务记录
2025-03-29 01:15:40,370 - utils.excel_processor - DEBUG - 行 9: 处理客户 C001
2025-03-29 01:15:40,371 - utils.excel_processor - DEBUG - 行 9: 成功处理 5 条服务记录
2025-03-29 01:15:40,371 - utils.excel_processor - DEBUG - 行 10: 处理客户 C002
2025-03-29 01:15:40,372 - utils.excel_processor - DEBUG - 行 10: 成功处理 5 条服务记录
2025-03-29 01:15:40,372 - utils.excel_processor - DEBUG - 行 11: 处理客户 C002
2025-03-29 01:15:40,373 - utils.excel_processor - DEBUG - 行 11: 成功处理 5 条服务记录
2025-03-29 01:15:40,374 - utils.excel_processor - DEBUG - 行 12: 处理客户 C002
2025-03-29 01:15:40,375 - utils.excel_processor - DEBUG - 行 12: 成功处理 5 条服务记录
2025-03-29 01:15:40,375 - utils.excel_processor - DEBUG - 行 13: 处理客户 C002
2025-03-29 01:15:40,376 - utils.excel_processor - DEBUG - 行 13: 成功处理 5 条服务记录
2025-03-29 01:15:40,376 - utils.excel_processor - DEBUG - 行 14: 处理客户 C002
2025-03-29 01:15:40,377 - utils.excel_processor - DEBUG - 行 14: 成功处理 5 条服务记录
2025-03-29 01:15:40,377 - utils.excel_processor - DEBUG - 行 15: 处理客户 C002
2025-03-29 01:15:40,378 - utils.excel_processor - DEBUG - 行 15: 成功处理 5 条服务记录
2025-03-29 01:15:40,379 - utils.excel_processor - DEBUG - 行 16: 处理客户 C002
2025-03-29 01:15:40,380 - utils.excel_processor - DEBUG - 行 16: 成功处理 5 条服务记录
2025-03-29 01:15:40,380 - utils.excel_processor - DEBUG - 行 17: 处理客户 C002
2025-03-29 01:15:40,381 - utils.excel_processor - DEBUG - 行 17: 成功处理 5 条服务记录
2025-03-29 01:15:40,381 - utils.excel_processor - DEBUG - 行 18: 处理客户 C002
2025-03-29 01:15:40,382 - utils.excel_processor - DEBUG - 行 18: 成功处理 5 条服务记录
2025-03-29 01:15:40,382 - utils.excel_processor - DEBUG - 行 19: 处理客户 C002
2025-03-29 01:15:40,383 - utils.excel_processor - DEBUG - 行 19: 成功处理 5 条服务记录
2025-03-29 01:15:40,383 - utils.excel_processor - DEBUG - 行 20: 处理客户 C003
2025-03-29 01:15:40,384 - utils.excel_processor - DEBUG - 行 20: 成功处理 5 条服务记录
2025-03-29 01:15:40,384 - utils.excel_processor - DEBUG - 行 21: 处理客户 C003
2025-03-29 01:15:40,385 - utils.excel_processor - DEBUG - 行 21: 成功处理 5 条服务记录
2025-03-29 01:15:40,386 - utils.excel_processor - DEBUG - 行 22: 处理客户 C003
2025-03-29 01:15:40,386 - utils.excel_processor - DEBUG - 行 22: 成功处理 5 条服务记录
2025-03-29 01:15:40,387 - utils.excel_processor - DEBUG - 行 23: 处理客户 C003
2025-03-29 01:15:40,388 - utils.excel_processor - DEBUG - 行 23: 成功处理 5 条服务记录
2025-03-29 01:15:40,388 - utils.excel_processor - DEBUG - 行 24: 处理客户 C003
2025-03-29 01:15:40,389 - utils.excel_processor - DEBUG - 行 24: 成功处理 5 条服务记录
2025-03-29 01:15:40,389 - utils.excel_processor - DEBUG - 行 25: 处理客户 C003
2025-03-29 01:15:40,390 - utils.excel_processor - DEBUG - 行 25: 成功处理 5 条服务记录
2025-03-29 01:15:40,390 - utils.excel_processor - DEBUG - 行 26: 处理客户 C003
2025-03-29 01:15:40,391 - utils.excel_processor - DEBUG - 行 26: 成功处理 5 条服务记录
2025-03-29 01:15:40,391 - utils.excel_processor - DEBUG - 行 27: 处理客户 C003
2025-03-29 01:15:40,392 - utils.excel_processor - DEBUG - 行 27: 成功处理 5 条服务记录
2025-03-29 01:15:40,392 - utils.excel_processor - DEBUG - 行 28: 处理客户 C003
2025-03-29 01:15:40,393 - utils.excel_processor - DEBUG - 行 28: 成功处理 5 条服务记录
2025-03-29 01:15:40,393 - utils.excel_processor - DEBUG - 行 29: 处理客户 C003
2025-03-29 01:15:40,395 - utils.excel_processor - DEBUG - 行 29: 成功处理 5 条服务记录
2025-03-29 01:15:40,395 - utils.excel_processor - INFO - 服务记录处理完成，共处理 150 条记录，跳过 0 条无效记录
2025-03-29 01:15:40,395 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:15:40,395 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:15:40,395 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:15:40,395 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:15:40,396 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:15:40,396 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:15:40,396 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:15:40,396 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:15:40,397 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:15:40,397 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:15:40,399 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:15:40,399 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:15:40,400 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:15:40,400 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:15:40,400 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:15:40,400 - ExcelTest - INFO -   services: 150项
2025-03-29 01:15:40,400 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:15:40,400 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:15:40,400 - ExcelTest - INFO -   id: C001
2025-03-29 01:15:40,400 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:15:40,400 - ExcelTest - INFO -   gender: 女
2025-03-29 01:15:40,400 - ExcelTest - INFO -   age: 28
2025-03-29 01:15:40,400 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:15:40,400 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:15:40,400 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:15:40,400 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:15:40,401 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:15:40,401 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:15:40,401 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:15:40,401 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:15:40,401 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:15:40,401 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:15:40,401 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:15:40,401 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:15:40,401 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:15:40,401 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:15:40,401 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:15:40,401 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:15:40,401 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:15:40,401 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:15:40,402 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:28:58,991 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:28:58,992 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:28:59,173 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:28:59,173 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:28:59,173 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:28:59,173 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:28:59,173 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:28:59,173 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:28:59,173 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:28:59,391 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:28:59,391 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:28:59,391 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:28:59,392 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:28:59,392 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:28:59,392 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:28:59,399 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:28:59,399 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:28:59,400 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:28:59,400 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:28:59,400 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:28:59,400 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:28:59,401 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:28:59,402 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:28:59,402 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:28:59,402 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:28:59,402 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:28:59,402 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:28:59,403 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:28:59,403 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:28:59,403 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:28:59,404 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:28:59,404 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:28:59,405 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:28:59,405 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:28:59,405 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:28:59,405 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:28:59,405 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:28:59,406 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:28:59,406 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:28:59,406 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:28:59,406 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:28:59,406 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:28:59,406 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:28:59,406 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:28:59,407 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:28:59,407 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:28:59,407 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:28:59,407 - utils.excel_processor - INFO - 找到的列映射: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'service_items': ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容'], 'beautician': ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师'], 'service_amount': ['总耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额'], 'is_specified': ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定'], 'satisfaction': '服务满意度'}
2025-03-29 01:28:59,407 - utils.excel_processor - ERROR - 处理第 0 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,410 - utils.excel_processor - ERROR - 处理第 1 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,410 - utils.excel_processor - ERROR - 处理第 2 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,411 - utils.excel_processor - ERROR - 处理第 3 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,412 - utils.excel_processor - ERROR - 处理第 4 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,412 - utils.excel_processor - ERROR - 处理第 5 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,413 - utils.excel_processor - ERROR - 处理第 6 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,414 - utils.excel_processor - ERROR - 处理第 7 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,414 - utils.excel_processor - ERROR - 处理第 8 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,414 - utils.excel_processor - ERROR - 处理第 9 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,415 - utils.excel_processor - ERROR - 处理第 10 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,416 - utils.excel_processor - ERROR - 处理第 11 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,416 - utils.excel_processor - ERROR - 处理第 12 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,417 - utils.excel_processor - ERROR - 处理第 13 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,418 - utils.excel_processor - ERROR - 处理第 14 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,418 - utils.excel_processor - ERROR - 处理第 15 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,419 - utils.excel_processor - ERROR - 处理第 16 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,420 - utils.excel_processor - ERROR - 处理第 17 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,420 - utils.excel_processor - ERROR - 处理第 18 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,421 - utils.excel_processor - ERROR - 处理第 19 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,421 - utils.excel_processor - ERROR - 处理第 20 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,422 - utils.excel_processor - ERROR - 处理第 21 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,422 - utils.excel_processor - ERROR - 处理第 22 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,424 - utils.excel_processor - ERROR - 处理第 23 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,425 - utils.excel_processor - ERROR - 处理第 24 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,425 - utils.excel_processor - ERROR - 处理第 25 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,426 - utils.excel_processor - ERROR - 处理第 26 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,427 - utils.excel_processor - ERROR - 处理第 27 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,427 - utils.excel_processor - ERROR - 处理第 28 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,428 - utils.excel_processor - ERROR - 处理第 29 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 639, in _process_services
    if pd.isna(item_val) or str(item_val).strip() == "":
       ^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:28:59,428 - utils.excel_processor - INFO - 服务记录处理完成，共处理 0 条记录，跳过 30 条无效记录
2025-03-29 01:28:59,428 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:28:59,429 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:28:59,429 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:28:59,429 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:28:59,429 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:28:59,429 - utils.excel_processor - INFO - 第一行内容: ['C001', '林晓薇', '2023-07-05 10:15:00', '分店A前台', '首次咨询冰肌焕颜护理，要求对比不同补水项目差异']
2025-03-29 01:28:59,429 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:28:59,430 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:28:59,430 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:28:59,430 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:28:59,430 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:28:59,430 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:28:59,430 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:28:59,431 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:28:59,431 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:28:59,431 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:28:59,431 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:28:59,431 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:28:59,431 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:28:59,431 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:28:59,432 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:28:59,432 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:28:59,432 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:28:59,432 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:28:59,432 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:28:59,432 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:28:59,432 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:28:59,432 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:28:59,432 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:28:59,432 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:28:59,434 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:28:59,434 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:28:59,434 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:28:59,434 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:28:59,434 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:28:59,434 - ExcelTest - INFO -   services: 0项
2025-03-29 01:28:59,434 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:28:59,434 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:28:59,434 - ExcelTest - INFO -   id: C001
2025-03-29 01:28:59,434 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:28:59,434 - ExcelTest - INFO -   gender: 女
2025-03-29 01:28:59,434 - ExcelTest - INFO -   age: 28
2025-03-29 01:28:59,435 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:28:59,435 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:28:59,435 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:28:59,435 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:28:59,435 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:28:59,435 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:28:59,435 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:28:59,435 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:28:59,435 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:28:59,435 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:28:59,435 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:28:59,435 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:28:59,435 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:28:59,436 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:28:59,436 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:28:59,436 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:28:59,436 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:28:59,436 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:28:59,436 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:32:35,041 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:32:35,041 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:32:35,222 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:32:35,222 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:32:35,222 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:32:35,222 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:32:35,222 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:32:35,222 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:32:35,222 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:32:35,516 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:32:35,516 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:32:35,516 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:32:35,516 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:32:35,517 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:32:35,517 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:32:35,524 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:32:35,525 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:32:35,525 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:32:35,525 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:32:35,525 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:32:35,526 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:32:35,527 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:32:35,527 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:32:35,527 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:32:35,527 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:32:35,527 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:32:35,527 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:32:35,527 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:32:35,528 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:32:35,528 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:32:35,528 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:32:35,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:32:35,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:32:35,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:32:35,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:32:35,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:32:35,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:32:35,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:32:35,530 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:32:35,530 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:32:35,530 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:32:35,530 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:32:35,530 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:32:35,530 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:32:35,530 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 规范化后的列名: ['客户id', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 找到的主要列映射: {'customer_id': '客户id', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 项目列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 金额列: ['耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:32:35,531 - utils.excel_processor - INFO - 指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:32:35,532 - utils.excel_processor - ERROR - 处理第 0 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,534 - utils.excel_processor - ERROR - 处理第 1 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,535 - utils.excel_processor - ERROR - 处理第 2 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,536 - utils.excel_processor - ERROR - 处理第 3 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,537 - utils.excel_processor - ERROR - 处理第 4 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,538 - utils.excel_processor - ERROR - 处理第 5 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,538 - utils.excel_processor - ERROR - 处理第 6 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,539 - utils.excel_processor - ERROR - 处理第 7 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,539 - utils.excel_processor - ERROR - 处理第 8 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,540 - utils.excel_processor - ERROR - 处理第 9 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,541 - utils.excel_processor - ERROR - 处理第 10 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,542 - utils.excel_processor - ERROR - 处理第 11 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,542 - utils.excel_processor - ERROR - 处理第 12 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,543 - utils.excel_processor - ERROR - 处理第 13 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,544 - utils.excel_processor - ERROR - 处理第 14 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,544 - utils.excel_processor - ERROR - 处理第 15 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,544 - utils.excel_processor - ERROR - 处理第 16 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,545 - utils.excel_processor - ERROR - 处理第 17 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,546 - utils.excel_processor - ERROR - 处理第 18 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,547 - utils.excel_processor - ERROR - 处理第 19 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,548 - utils.excel_processor - ERROR - 处理第 20 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,548 - utils.excel_processor - ERROR - 处理第 21 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,550 - utils.excel_processor - ERROR - 处理第 22 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,550 - utils.excel_processor - ERROR - 处理第 23 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,551 - utils.excel_processor - ERROR - 处理第 24 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,551 - utils.excel_processor - ERROR - 处理第 25 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,552 - utils.excel_processor - ERROR - 处理第 26 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,553 - utils.excel_processor - ERROR - 处理第 27 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,554 - utils.excel_processor - ERROR - 处理第 28 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,554 - utils.excel_processor - ERROR - 处理第 29 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 654, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:32:35,555 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 0 条记录，跳过 30 行
2025-03-29 01:32:35,555 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:32:35,555 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:32:35,555 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:32:35,555 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:32:35,555 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:32:35,556 - utils.excel_processor - INFO - 第一行内容: ['C001', '林晓薇', '2023-07-05 10:15:00', '分店A前台', '首次咨询冰肌焕颜护理，要求对比不同补水项目差异']
2025-03-29 01:32:35,556 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:32:35,556 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:32:35,556 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:32:35,556 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:32:35,556 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:32:35,557 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:32:35,558 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:32:35,558 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:32:35,558 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:32:35,558 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:32:35,558 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:32:35,558 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:32:35,558 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:32:35,558 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:32:35,558 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:32:35,560 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:32:35,560 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:32:35,560 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:32:35,560 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:32:35,560 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:32:35,560 - ExcelTest - INFO -   services: 0项
2025-03-29 01:32:35,560 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:32:35,560 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:32:35,560 - ExcelTest - INFO -   id: C001
2025-03-29 01:32:35,560 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:32:35,561 - ExcelTest - INFO -   gender: 女
2025-03-29 01:32:35,561 - ExcelTest - INFO -   age: 28
2025-03-29 01:32:35,561 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:32:35,561 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:32:35,561 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:32:35,561 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:32:35,561 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:32:35,561 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:32:35,561 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:32:35,561 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:32:35,561 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:32:35,561 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:32:35,561 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:32:35,562 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:32:35,562 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:32:35,562 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:32:35,562 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:32:35,562 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:32:35,562 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:32:35,562 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:32:35,562 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:33:52,787 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:33:52,787 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:33:52,976 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:33:52,976 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:33:52,976 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:33:52,977 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:33:52,977 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:33:52,977 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:33:52,977 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:33:53,202 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:33:53,202 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:33:53,202 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:33:53,202 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:33:53,202 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:33:53,203 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:33:53,210 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:33:53,210 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:33:53,211 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:33:53,211 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:33:53,211 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:33:53,211 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:33:53,212 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:33:53,214 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:33:53,214 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:33:53,214 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:33:53,214 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:33:53,215 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:33:53,215 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:33:53,215 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:33:53,215 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:33:53,215 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:33:53,216 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:33:53,216 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:33:53,216 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:33:53,216 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:33:53,216 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:33:53,216 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:33:53,217 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:33:53,217 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:33:53,217 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:33:53,217 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:33:53,217 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:33:53,217 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:33:53,217 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:33:53,217 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:33:53,218 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:33:53,218 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:33:53,218 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:33:53,218 - utils.excel_processor - INFO - 规范化后的列名: ['客户id', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:33:53,218 - utils.excel_processor - INFO - 找到的主要列映射: {'customer_id': '客户id', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:33:53,218 - utils.excel_processor - INFO - 项目列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:33:53,218 - utils.excel_processor - INFO - 美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:33:53,219 - utils.excel_processor - INFO - 金额列: ['耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:33:53,219 - utils.excel_processor - INFO - 指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:33:53,223 - utils.excel_processor - DEBUG - 行 0: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,226 - utils.excel_processor - DEBUG - 行 1: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,228 - utils.excel_processor - DEBUG - 行 2: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,231 - utils.excel_processor - DEBUG - 行 3: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,235 - utils.excel_processor - DEBUG - 行 4: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,238 - utils.excel_processor - DEBUG - 行 5: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,240 - utils.excel_processor - DEBUG - 行 6: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,243 - utils.excel_processor - DEBUG - 行 7: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,245 - utils.excel_processor - DEBUG - 行 8: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,248 - utils.excel_processor - DEBUG - 行 9: 客户 C001 处理了 5 个服务项目
2025-03-29 01:33:53,250 - utils.excel_processor - DEBUG - 行 10: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,254 - utils.excel_processor - DEBUG - 行 11: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,258 - utils.excel_processor - DEBUG - 行 12: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,261 - utils.excel_processor - DEBUG - 行 13: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,264 - utils.excel_processor - DEBUG - 行 14: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,266 - utils.excel_processor - DEBUG - 行 15: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,269 - utils.excel_processor - DEBUG - 行 16: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,272 - utils.excel_processor - DEBUG - 行 17: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,275 - utils.excel_processor - DEBUG - 行 18: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,277 - utils.excel_processor - DEBUG - 行 19: 客户 C002 处理了 5 个服务项目
2025-03-29 01:33:53,280 - utils.excel_processor - DEBUG - 行 20: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,284 - utils.excel_processor - DEBUG - 行 21: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,287 - utils.excel_processor - DEBUG - 行 22: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,290 - utils.excel_processor - DEBUG - 行 23: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,293 - utils.excel_processor - DEBUG - 行 24: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,295 - utils.excel_processor - DEBUG - 行 25: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,298 - utils.excel_processor - DEBUG - 行 26: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,301 - utils.excel_processor - DEBUG - 行 27: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,304 - utils.excel_processor - DEBUG - 行 28: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,307 - utils.excel_processor - DEBUG - 行 29: 客户 C003 处理了 5 个服务项目
2025-03-29 01:33:53,307 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 150 条记录，跳过 0 行
2025-03-29 01:33:53,307 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:33:53,307 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:33:53,307 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:33:53,308 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:33:53,308 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:33:53,308 - utils.excel_processor - INFO - 第一行内容: ['C001', '林晓薇', '2023-07-05 10:15:00', '分店A前台', '首次咨询冰肌焕颜护理，要求对比不同补水项目差异']
2025-03-29 01:33:53,308 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:33:53,308 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:33:53,308 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:33:53,308 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:33:53,309 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:33:53,309 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:33:53,309 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:33:53,309 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:33:53,310 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:33:53,311 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:33:53,311 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:33:53,311 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:33:53,311 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:33:53,311 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:33:53,311 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:33:53,311 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:33:53,315 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:33:53,315 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:33:53,315 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:33:53,315 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:33:53,315 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:33:53,316 - ExcelTest - INFO -   services: 150项
2025-03-29 01:33:53,316 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:33:53,316 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:33:53,316 - ExcelTest - INFO -   id: C001
2025-03-29 01:33:53,316 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:33:53,316 - ExcelTest - INFO -   gender: 女
2025-03-29 01:33:53,316 - ExcelTest - INFO -   age: 28
2025-03-29 01:33:53,316 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:33:53,316 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:33:53,317 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:33:53,317 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:33:53,317 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:33:53,317 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:33:53,317 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:33:53,317 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:33:53,317 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:33:53,317 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:33:53,317 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:33:53,317 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:33:53,317 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:33:53,317 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:33:53,317 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:33:53,317 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:33:53,317 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:33:53,317 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:33:53,318 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:34:02,348 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:34:02,349 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:34:02,539 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:34:02,539 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:34:02,539 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:34:02,539 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:34:02,539 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:34:02,540 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:34:02,540 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:34:02,773 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:34:02,773 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:34:02,773 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:34:02,773 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:34:02,773 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:34:02,774 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:34:02,781 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:34:02,781 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:34:02,781 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:34:02,782 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:34:02,784 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:34:02,784 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:34:02,784 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:34:02,784 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:34:02,785 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:34:02,785 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:34:02,785 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:34:02,785 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:34:02,785 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:34:02,785 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:34:02,786 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:34:02,786 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:34:02,786 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:34:02,786 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:34:02,786 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:34:02,787 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:34:02,787 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:34:02,787 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:34:02,787 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:34:02,787 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:34:02,788 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:34:02,788 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:34:02,788 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:34:02,788 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:34:02,788 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:34:02,788 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:34:02,789 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:34:02,789 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:34:02,789 - utils.excel_processor - INFO - 规范化后的列名: ['客户id', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:34:02,789 - utils.excel_processor - INFO - 找到的主要列映射: {'customer_id': '客户id', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:34:02,789 - utils.excel_processor - INFO - 项目列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:34:02,790 - utils.excel_processor - INFO - 美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:34:02,790 - utils.excel_processor - INFO - 金额列: ['耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:34:02,790 - utils.excel_processor - INFO - 指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:34:02,793 - utils.excel_processor - DEBUG - 行 0: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,796 - utils.excel_processor - DEBUG - 行 1: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,798 - utils.excel_processor - DEBUG - 行 2: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,801 - utils.excel_processor - DEBUG - 行 3: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,805 - utils.excel_processor - DEBUG - 行 4: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,808 - utils.excel_processor - DEBUG - 行 5: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,810 - utils.excel_processor - DEBUG - 行 6: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,814 - utils.excel_processor - DEBUG - 行 7: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,817 - utils.excel_processor - DEBUG - 行 8: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,820 - utils.excel_processor - DEBUG - 行 9: 客户 C001 处理了 5 个服务项目
2025-03-29 01:34:02,823 - utils.excel_processor - DEBUG - 行 10: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,826 - utils.excel_processor - DEBUG - 行 11: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,828 - utils.excel_processor - DEBUG - 行 12: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,831 - utils.excel_processor - DEBUG - 行 13: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,834 - utils.excel_processor - DEBUG - 行 14: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,837 - utils.excel_processor - DEBUG - 行 15: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,840 - utils.excel_processor - DEBUG - 行 16: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,842 - utils.excel_processor - DEBUG - 行 17: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,846 - utils.excel_processor - DEBUG - 行 18: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,849 - utils.excel_processor - DEBUG - 行 19: 客户 C002 处理了 5 个服务项目
2025-03-29 01:34:02,852 - utils.excel_processor - DEBUG - 行 20: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,854 - utils.excel_processor - DEBUG - 行 21: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,856 - utils.excel_processor - DEBUG - 行 22: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,859 - utils.excel_processor - DEBUG - 行 23: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,862 - utils.excel_processor - DEBUG - 行 24: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,865 - utils.excel_processor - DEBUG - 行 25: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,869 - utils.excel_processor - DEBUG - 行 26: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,871 - utils.excel_processor - DEBUG - 行 27: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,875 - utils.excel_processor - DEBUG - 行 28: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,877 - utils.excel_processor - DEBUG - 行 29: 客户 C003 处理了 5 个服务项目
2025-03-29 01:34:02,878 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 150 条记录，跳过 0 行
2025-03-29 01:34:02,878 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:34:02,878 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:34:02,878 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:34:02,878 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:34:02,878 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:34:02,879 - utils.excel_processor - INFO - 第一行内容: ['C001', '林晓薇', '2023-07-05 10:15:00', '分店A前台', '首次咨询冰肌焕颜护理，要求对比不同补水项目差异']
2025-03-29 01:34:02,879 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:34:02,879 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:34:02,879 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:34:02,880 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:34:02,880 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:34:02,880 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:34:02,880 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:34:02,880 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:34:02,880 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:34:02,881 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:34:02,882 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:34:02,882 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:34:02,882 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:34:02,882 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:34:02,882 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:34:02,882 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:34:02,885 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:34:02,885 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:34:02,885 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:34:02,885 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:34:02,885 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:34:02,885 - ExcelTest - INFO -   services: 150项
2025-03-29 01:34:02,886 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:34:02,886 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:34:02,886 - ExcelTest - INFO -   id: C001
2025-03-29 01:34:02,886 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:34:02,886 - ExcelTest - INFO -   gender: 女
2025-03-29 01:34:02,886 - ExcelTest - INFO -   age: 28
2025-03-29 01:34:02,886 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:34:02,886 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:34:02,886 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:34:02,886 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:34:02,886 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:34:02,886 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:34:02,886 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:34:02,887 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:34:02,887 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:34:02,887 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:34:02,887 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:34:02,887 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:34:02,887 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:34:02,887 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:34:02,887 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:34:02,887 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:34:02,887 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:34:02,887 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:34:02,887 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:36:02,090 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:36:02,091 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:36:02,280 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:36:02,280 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:36:02,280 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:36:02,280 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:36:02,280 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:36:02,280 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:36:02,280 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:36:02,515 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:36:02,515 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:36:02,516 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:36:02,516 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:36:02,516 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:36:02,516 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:36:02,524 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:36:02,525 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:36:02,525 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:36:02,525 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:36:02,525 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:36:02,526 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:36:02,526 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:36:02,526 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:36:02,526 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:36:02,527 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:36:02,527 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:36:02,527 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:36:02,527 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:36:02,527 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:36:02,528 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:36:02,528 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:36:02,528 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:36:02,528 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:36:02,528 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:36:02,528 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:36:02,528 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:36:02,529 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:36:02,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:36:02,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:36:02,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:36:02,529 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:36:02,530 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:36:02,530 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:36:02,530 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:36:02,530 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:36:02,530 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:36:02,530 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:36:02,530 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:36:02,530 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:36:02,530 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:36:02,530 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:36:02,531 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:36:02,531 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:36:02,531 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:36:02,531 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:36:02,531 - utils.excel_processor - INFO - 规范化后的列名: ['客户id', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:36:02,531 - utils.excel_processor - INFO - 找到的主要列映射: {'customer_id': '客户id', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:36:02,531 - utils.excel_processor - INFO - 项目列: ['项目内容', '项目内容', '项目内容', '项目内容', '项目内容']
2025-03-29 01:36:02,532 - utils.excel_processor - INFO - 美容师列: ['操作美容师', '操作美容师', '操作美容师', '操作美容师', '操作美容师']
2025-03-29 01:36:02,532 - utils.excel_processor - INFO - 金额列: ['耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额', '耗卡金额']
2025-03-29 01:36:02,532 - utils.excel_processor - INFO - 指定列: ['是否指定', '是否指定', '是否指定', '是否指定', '是否指定']
2025-03-29 01:36:02,534 - utils.excel_processor - DEBUG - 行 0: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,537 - utils.excel_processor - DEBUG - 行 1: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,541 - utils.excel_processor - DEBUG - 行 2: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,544 - utils.excel_processor - DEBUG - 行 3: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,547 - utils.excel_processor - DEBUG - 行 4: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,549 - utils.excel_processor - DEBUG - 行 5: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,552 - utils.excel_processor - DEBUG - 行 6: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,556 - utils.excel_processor - DEBUG - 行 7: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,559 - utils.excel_processor - DEBUG - 行 8: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,562 - utils.excel_processor - DEBUG - 行 9: 客户 C001 处理了 5 个服务项目
2025-03-29 01:36:02,565 - utils.excel_processor - DEBUG - 行 10: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,567 - utils.excel_processor - DEBUG - 行 11: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,571 - utils.excel_processor - DEBUG - 行 12: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,574 - utils.excel_processor - DEBUG - 行 13: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,577 - utils.excel_processor - DEBUG - 行 14: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,580 - utils.excel_processor - DEBUG - 行 15: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,583 - utils.excel_processor - DEBUG - 行 16: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,587 - utils.excel_processor - DEBUG - 行 17: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,590 - utils.excel_processor - DEBUG - 行 18: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,594 - utils.excel_processor - DEBUG - 行 19: 客户 C002 处理了 5 个服务项目
2025-03-29 01:36:02,596 - utils.excel_processor - DEBUG - 行 20: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,599 - utils.excel_processor - DEBUG - 行 21: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,602 - utils.excel_processor - DEBUG - 行 22: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,606 - utils.excel_processor - DEBUG - 行 23: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,609 - utils.excel_processor - DEBUG - 行 24: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,612 - utils.excel_processor - DEBUG - 行 25: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,614 - utils.excel_processor - DEBUG - 行 26: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,617 - utils.excel_processor - DEBUG - 行 27: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,620 - utils.excel_processor - DEBUG - 行 28: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,624 - utils.excel_processor - DEBUG - 行 29: 客户 C003 处理了 5 个服务项目
2025-03-29 01:36:02,625 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 150 条记录，跳过 0 行
2025-03-29 01:36:02,625 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:36:02,625 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:36:02,625 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:36:02,625 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:36:02,625 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:36:02,625 - utils.excel_processor - INFO - 第一行内容: ['C001', '林晓薇', '2023-07-05 10:15:00', '分店A前台', '首次咨询冰肌焕颜护理，要求对比不同补水项目差异']
2025-03-29 01:36:02,626 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:36:02,626 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:36:02,626 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:36:02,626 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'comm_time', 'comm_location', 'comm_content']
2025-03-29 01:36:02,626 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:36:02,626 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:36:02,627 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:36:02,628 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:36:02,628 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:36:02,628 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:36:02,628 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:36:02,628 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:36:02,628 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:36:02,628 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:36:02,628 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:36:02,628 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:36:02,628 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:36:02,632 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:36:02,632 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:36:02,632 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:36:02,632 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:36:02,632 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:36:02,632 - ExcelTest - INFO -   services: 150项
2025-03-29 01:36:02,632 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:36:02,632 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:36:02,632 - ExcelTest - INFO -   id: C001
2025-03-29 01:36:02,633 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:36:02,633 - ExcelTest - INFO -   gender: 女
2025-03-29 01:36:02,633 - ExcelTest - INFO -   age: 28
2025-03-29 01:36:02,633 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:36:02,633 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:36:02,633 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:36:02,633 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:36:02,633 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:36:02,633 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:36:02,633 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:36:02,633 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:36:02,633 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:36:02,633 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:36:02,633 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:36:02,634 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:36:02,634 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:36:02,634 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:36:02,634 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:36:02,634 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:36:02,634 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:36:02,634 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:36:02,634 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:49:38,272 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:49:38,273 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:49:38,455 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:49:38,455 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:49:38,456 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:49:38,456 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:49:38,456 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:49:38,456 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:49:38,456 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:49:38,684 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:49:38,684 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:49:38,684 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:49:38,684 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:49:38,684 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:49:38,685 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:49:38,692 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:49:38,692 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:49:38,692 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:49:38,692 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:49:38,694 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:49:38,694 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:49:38,694 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:49:38,694 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:49:38,694 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:49:38,694 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:49:38,694 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:49:38,695 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:49:38,695 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:49:38,695 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:49:38,695 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:49:38,695 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:49:38,696 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:49:38,696 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:49:38,696 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:49:38,696 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:49:38,696 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:49:38,697 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:49:38,697 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:49:38,697 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:49:38,698 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:49:38,698 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:49:38,698 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:49:38,698 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:49:38,699 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:49:38,699 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:49:38,699 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:49:38,699 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:49:38,699 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:49:38,699 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:49:38,699 - utils.excel_processor - INFO - 开始处理服务记录数据
2025-03-29 01:49:38,699 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:49:38,699 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:49:38,700 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:49:38,700 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:49:38,700 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 01:49:38,700 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:49:38,700 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-03-29 01:49:38,701 - utils.excel_processor - ERROR - 处理第 0 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,703 - utils.excel_processor - ERROR - 处理第 1 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,704 - utils.excel_processor - ERROR - 处理第 2 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,705 - utils.excel_processor - ERROR - 处理第 3 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,705 - utils.excel_processor - ERROR - 处理第 4 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,706 - utils.excel_processor - ERROR - 处理第 5 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,707 - utils.excel_processor - ERROR - 处理第 6 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,708 - utils.excel_processor - ERROR - 处理第 7 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,708 - utils.excel_processor - ERROR - 处理第 8 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,709 - utils.excel_processor - ERROR - 处理第 9 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,710 - utils.excel_processor - ERROR - 处理第 10 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,711 - utils.excel_processor - ERROR - 处理第 11 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,712 - utils.excel_processor - ERROR - 处理第 12 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,712 - utils.excel_processor - ERROR - 处理第 13 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,714 - utils.excel_processor - ERROR - 处理第 14 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,715 - utils.excel_processor - ERROR - 处理第 15 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,715 - utils.excel_processor - ERROR - 处理第 16 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,716 - utils.excel_processor - ERROR - 处理第 17 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,717 - utils.excel_processor - ERROR - 处理第 18 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,717 - utils.excel_processor - ERROR - 处理第 19 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,718 - utils.excel_processor - ERROR - 处理第 20 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,719 - utils.excel_processor - ERROR - 处理第 21 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,720 - utils.excel_processor - ERROR - 处理第 22 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,721 - utils.excel_processor - ERROR - 处理第 23 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,721 - utils.excel_processor - ERROR - 处理第 24 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,722 - utils.excel_processor - ERROR - 处理第 25 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,724 - utils.excel_processor - ERROR - 处理第 26 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,724 - utils.excel_processor - ERROR - 处理第 27 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,725 - utils.excel_processor - ERROR - 处理第 28 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,726 - utils.excel_processor - ERROR - 处理第 29 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 672, in _process_services
    if pd.isna(project_val) or str(project_val).strip() == "":
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:49:38,727 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 0 条记录，跳过 30 行
2025-03-29 01:49:38,727 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:49:38,727 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:49:38,727 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:49:38,727 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:49:38,727 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:49:38,727 - utils.excel_processor - INFO - 第一行内容: ['C001', '林晓薇', '2023-07-05 10:15:00', '分店A前台', '首次咨询冰肌焕颜护理，要求对比不同补水项目差异']
2025-03-29 01:49:38,728 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:49:38,728 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content'}
2025-03-29 01:49:38,728 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:49:38,728 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:49:38,728 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:49:38,729 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:49:38,729 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:49:38,729 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:49:38,729 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:49:38,729 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:49:38,730 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:49:38,730 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:49:38,730 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:49:38,730 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:49:38,731 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:49:38,732 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:49:38,732 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:49:38,732 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:49:38,732 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:49:38,732 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:49:38,732 - ExcelTest - INFO -   services: 0项
2025-03-29 01:49:38,732 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:49:38,732 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:49:38,732 - ExcelTest - INFO -   id: C001
2025-03-29 01:49:38,733 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:49:38,733 - ExcelTest - INFO -   gender: 女
2025-03-29 01:49:38,733 - ExcelTest - INFO -   age: 28
2025-03-29 01:49:38,733 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:49:38,733 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:49:38,733 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:49:38,733 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:49:38,733 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:49:38,733 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:49:38,733 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:49:38,733 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:49:38,733 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:49:38,733 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:49:38,733 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:49:38,734 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:49:38,734 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:49:38,734 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:49:38,734 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:49:38,734 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:49:38,734 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:49:38,734 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:49:38,734 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:51:51,554 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:51:51,555 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:51:51,734 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:51:51,734 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:51:51,735 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:51:51,735 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:51:51,735 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:51:51,735 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:51:51,735 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:51:51,952 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:51:51,954 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:51:51,954 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:51:51,954 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:51:51,954 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:51:51,955 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:51:51,962 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:51:51,962 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:51:51,962 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:51:51,963 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:51:51,963 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:51:51,963 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:51:51,964 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:51:51,965 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:51:51,965 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:51:51,965 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:51:51,965 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:51:51,965 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:51:51,965 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:51:51,965 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:51:51,966 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:51:51,966 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:51:51,966 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:51:51,966 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:51:51,966 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:51:51,967 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:51:51,967 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:51:51,967 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:51:51,967 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:51:51,967 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:51:51,967 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:51:51,967 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:51:51,967 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:51:51,968 - utils.excel_processor - ERROR - Excel文件处理错误: 'ExcelProcessor' object has no attribute 'logger'
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 520, in _process_services
    self.logger.info(f"DataFrame形状: {df.shape}")
    ^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute 'logger'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 244, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 667, in _process_services
    self.logger.error(f"处理服务记录时出错: {str(e)}")
    ^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute 'logger'
2025-03-29 01:51:51,969 - ExcelTest - ERROR - Excel处理过程中出错: 'ExcelProcessor' object has no attribute 'logger'
Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 520, in _process_services
    self.logger.info(f"DataFrame形状: {df.shape}")
    ^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute 'logger'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\test_excel.py", line 57, in test_excel_processor
    result = processor.process_file(excel_file)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 278, in process_file
    raise e
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 244, in process_file
    services = self._process_services(df)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 667, in _process_services
    self.logger.error(f"处理服务记录时出错: {str(e)}")
    ^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute 'logger'
2025-03-29 01:51:51,970 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:54:02,860 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:54:02,860 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:54:03,042 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:54:03,043 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:54:03,043 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:54:03,043 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:54:03,043 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:54:03,043 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:54:03,043 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:54:03,262 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:54:03,262 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:54:03,262 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:54:03,262 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:54:03,262 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:54:03,262 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:54:03,272 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:54:03,272 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:54:03,272 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:54:03,273 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:54:03,273 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:54:03,273 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:54:03,273 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:54:03,273 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:54:03,273 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:54:03,273 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:54:03,274 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:54:03,275 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:54:03,275 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:54:03,275 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:54:03,276 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:54:03,276 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:54:03,276 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:54:03,276 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:54:03,277 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:54:03,277 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:54:03,277 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:54:03,277 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:54:03,277 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:54:03,277 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:54:03,277 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:54:03,277 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:54:03,277 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:54:03,278 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:54:03,278 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:54:03,278 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师']
2025-03-29 01:54:03,278 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:54:03,278 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}]
2025-03-29 01:54:03,278 - utils.excel_processor - ERROR - 处理第 0 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,280 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,280 - utils.excel_processor - ERROR - 处理第 1 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,281 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,281 - utils.excel_processor - ERROR - 处理第 2 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,282 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,282 - utils.excel_processor - ERROR - 处理第 3 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,282 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,284 - utils.excel_processor - ERROR - 处理第 4 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,284 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,284 - utils.excel_processor - ERROR - 处理第 5 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,285 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,285 - utils.excel_processor - ERROR - 处理第 6 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,286 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,286 - utils.excel_processor - ERROR - 处理第 7 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,287 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,287 - utils.excel_processor - ERROR - 处理第 8 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,288 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,288 - utils.excel_processor - ERROR - 处理第 9 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,289 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,289 - utils.excel_processor - ERROR - 处理第 10 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,290 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,290 - utils.excel_processor - ERROR - 处理第 11 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,291 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,291 - utils.excel_processor - ERROR - 处理第 12 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,292 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,292 - utils.excel_processor - ERROR - 处理第 13 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,293 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,293 - utils.excel_processor - ERROR - 处理第 14 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,294 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,294 - utils.excel_processor - ERROR - 处理第 15 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,294 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,294 - utils.excel_processor - ERROR - 处理第 16 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,295 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,295 - utils.excel_processor - ERROR - 处理第 17 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,296 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,296 - utils.excel_processor - ERROR - 处理第 18 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,297 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,297 - utils.excel_processor - ERROR - 处理第 19 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,298 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,298 - utils.excel_processor - ERROR - 处理第 20 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,299 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,299 - utils.excel_processor - ERROR - 处理第 21 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,300 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,300 - utils.excel_processor - ERROR - 处理第 22 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,301 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,301 - utils.excel_processor - ERROR - 处理第 23 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,302 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,302 - utils.excel_processor - ERROR - 处理第 24 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,302 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,304 - utils.excel_processor - ERROR - 处理第 25 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,304 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,305 - utils.excel_processor - ERROR - 处理第 26 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,305 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,306 - utils.excel_processor - ERROR - 处理第 27 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,306 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,307 - utils.excel_processor - ERROR - 处理第 28 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,308 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,308 - utils.excel_processor - ERROR - 处理第 29 行时出错: 'ExcelProcessor' object has no attribute '_parse_date'
2025-03-29 01:54:03,309 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 613, in _process_services
    service_date = self._parse_date(row[base_fields['service_date']]) if pd.notna(row[base_fields['service_date']]) else None
                   ^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_parse_date'. Did you mean: '_parse_datetime'?

2025-03-29 01:54:03,309 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 0 条记录，跳过 30 行
2025-03-29 01:54:03,309 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:54:03,309 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:54:03,309 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:54:03,309 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:54:03,309 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:54:03,310 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:54:03,310 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content', '需要跟进': 'follow_up_needed', '负责人': 'staff'}
2025-03-29 01:54:03,310 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:54:03,311 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:54:03,311 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:54:03,311 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:54:03,311 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:54:03,311 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:54:03,311 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:54:03,311 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:54:03,312 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:54:03,313 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:54:03,313 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:54:03,313 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:54:03,313 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:54:03,314 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:54:03,314 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:54:03,314 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:54:03,314 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:54:03,315 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:54:03,315 - ExcelTest - INFO -   services: 0项
2025-03-29 01:54:03,315 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:54:03,315 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:54:03,315 - ExcelTest - INFO -   id: C001
2025-03-29 01:54:03,315 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:54:03,315 - ExcelTest - INFO -   gender: 女
2025-03-29 01:54:03,315 - ExcelTest - INFO -   age: 28
2025-03-29 01:54:03,315 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:54:03,315 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:54:03,315 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:54:03,315 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:54:03,315 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:54:03,315 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:54:03,315 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:54:03,315 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:54:03,316 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:54:03,316 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:54:03,316 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:54:03,316 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:54:03,316 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:54:03,316 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:54:03,316 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:54:03,316 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:54:03,316 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:54:03,316 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:54:03,316 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:55:40,921 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:55:40,921 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:55:41,100 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:55:41,100 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:55:41,100 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:55:41,100 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:55:41,100 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:55:41,100 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:55:41,100 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:55:41,318 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:55:41,319 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:55:41,319 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:55:41,319 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:55:41,319 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:55:41,319 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:55:41,327 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:55:41,327 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:55:41,327 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:55:41,328 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:55:41,328 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:55:41,328 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:55:41,328 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:55:41,328 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:55:41,329 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:55:41,329 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:55:41,329 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:55:41,329 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:55:41,329 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:55:41,330 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:55:41,330 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:55:41,330 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:55:41,331 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:55:41,331 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:55:41,331 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:55:41,331 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:55:41,331 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:55:41,332 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:55:41,332 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:55:41,332 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:55:41,332 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:55:41,332 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:55:41,332 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:55:41,333 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:55:41,333 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:55:41,333 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:55:41,333 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:55:41,333 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师']
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:55:41,334 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}]
2025-03-29 01:55:41,334 - utils.excel_processor - ERROR - 处理第 0 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,336 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,336 - utils.excel_processor - ERROR - 处理第 1 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,337 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,338 - utils.excel_processor - ERROR - 处理第 2 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,339 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,339 - utils.excel_processor - ERROR - 处理第 3 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,340 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,341 - utils.excel_processor - ERROR - 处理第 4 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,342 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,342 - utils.excel_processor - ERROR - 处理第 5 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,344 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,344 - utils.excel_processor - ERROR - 处理第 6 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,345 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,346 - utils.excel_processor - ERROR - 处理第 7 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,347 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,347 - utils.excel_processor - ERROR - 处理第 8 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,349 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,349 - utils.excel_processor - ERROR - 处理第 9 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,350 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,350 - utils.excel_processor - ERROR - 处理第 10 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,351 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,352 - utils.excel_processor - ERROR - 处理第 11 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,353 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,353 - utils.excel_processor - ERROR - 处理第 12 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,354 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,354 - utils.excel_processor - ERROR - 处理第 13 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,356 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,356 - utils.excel_processor - ERROR - 处理第 14 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,357 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,357 - utils.excel_processor - ERROR - 处理第 15 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,358 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,359 - utils.excel_processor - ERROR - 处理第 16 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,360 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,361 - utils.excel_processor - ERROR - 处理第 17 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,362 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,362 - utils.excel_processor - ERROR - 处理第 18 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,363 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,363 - utils.excel_processor - ERROR - 处理第 19 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,365 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,365 - utils.excel_processor - ERROR - 处理第 20 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,366 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,367 - utils.excel_processor - ERROR - 处理第 21 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,368 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,369 - utils.excel_processor - ERROR - 处理第 22 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,370 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,370 - utils.excel_processor - ERROR - 处理第 23 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,371 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,371 - utils.excel_processor - ERROR - 处理第 24 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,372 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,373 - utils.excel_processor - ERROR - 处理第 25 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,373 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,374 - utils.excel_processor - ERROR - 处理第 26 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,375 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,375 - utils.excel_processor - ERROR - 处理第 27 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,376 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,377 - utils.excel_processor - ERROR - 处理第 28 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,378 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,378 - utils.excel_processor - ERROR - 处理第 29 行时出错: 'ExcelProcessor' object has no attribute '_convert_amount'
2025-03-29 01:55:41,379 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 615, in _process_services
    total_amount = self._convert_amount(row[base_fields['total_amount']]) if pd.notna(row[base_fields['total_amount']]) else None
                   ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ExcelProcessor' object has no attribute '_convert_amount'

2025-03-29 01:55:41,379 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 0 条记录，跳过 30 行
2025-03-29 01:55:41,380 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:55:41,380 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:55:41,380 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:55:41,380 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:55:41,380 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:55:41,380 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:55:41,380 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content', '需要跟进': 'follow_up_needed', '负责人': 'staff'}
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:55:41,381 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:55:41,382 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:55:41,382 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:55:41,383 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:55:41,383 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:55:41,383 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:55:41,384 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:55:41,384 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:55:41,384 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:55:41,384 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:55:41,384 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:55:41,385 - ExcelTest - INFO -   services: 0项
2025-03-29 01:55:41,385 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:55:41,385 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:55:41,385 - ExcelTest - INFO -   id: C001
2025-03-29 01:55:41,385 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:55:41,385 - ExcelTest - INFO -   gender: 女
2025-03-29 01:55:41,385 - ExcelTest - INFO -   age: 28
2025-03-29 01:55:41,385 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:55:41,385 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:55:41,385 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:55:41,385 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:55:41,385 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:55:41,385 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:55:41,385 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:55:41,386 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:55:41,386 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:55:41,386 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:55:41,386 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:55:41,386 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:55:41,386 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:55:41,386 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:55:41,386 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:55:41,386 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:55:41,386 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:55:41,386 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:55:41,386 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:57:07,340 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:57:07,340 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:57:07,519 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:57:07,519 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:57:07,519 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:57:07,519 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:57:07,519 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:57:07,519 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:57:07,519 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:57:07,736 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:57:07,736 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:57:07,736 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:57:07,736 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:57:07,736 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:57:07,737 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:57:07,744 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:57:07,744 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:57:07,744 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:57:07,744 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:57:07,745 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:57:07,746 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:57:07,746 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:57:07,746 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:57:07,746 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:57:07,747 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:57:07,747 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:57:07,747 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:57:07,747 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:57:07,747 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:57:07,748 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:57:07,748 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:57:07,748 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:57:07,748 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:57:07,748 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:57:07,748 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:57:07,748 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:57:07,749 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:57:07,749 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:57:07,749 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:57:07,749 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:57:07,749 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:57:07,749 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:57:07,749 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:57:07,749 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:57:07,749 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:57:07,749 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:57:07,750 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师']
2025-03-29 01:57:07,750 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:57:07,750 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}]
2025-03-29 01:57:07,750 - utils.excel_processor - ERROR - 处理第 0 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,752 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,754 - utils.excel_processor - ERROR - 处理第 1 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,754 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,755 - utils.excel_processor - ERROR - 处理第 2 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,755 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,756 - utils.excel_processor - ERROR - 处理第 3 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,756 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,756 - utils.excel_processor - ERROR - 处理第 4 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,757 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,757 - utils.excel_processor - ERROR - 处理第 5 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,758 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,758 - utils.excel_processor - ERROR - 处理第 6 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,759 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,759 - utils.excel_processor - ERROR - 处理第 7 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,760 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,760 - utils.excel_processor - ERROR - 处理第 8 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,761 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,761 - utils.excel_processor - ERROR - 处理第 9 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,762 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,762 - utils.excel_processor - ERROR - 处理第 10 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,762 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,763 - utils.excel_processor - ERROR - 处理第 11 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,763 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,764 - utils.excel_processor - ERROR - 处理第 12 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,764 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,764 - utils.excel_processor - ERROR - 处理第 13 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,765 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,765 - utils.excel_processor - ERROR - 处理第 14 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,766 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,766 - utils.excel_processor - ERROR - 处理第 15 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,766 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,767 - utils.excel_processor - ERROR - 处理第 16 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,767 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,768 - utils.excel_processor - ERROR - 处理第 17 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,768 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,768 - utils.excel_processor - ERROR - 处理第 18 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,769 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,769 - utils.excel_processor - ERROR - 处理第 19 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,770 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,771 - utils.excel_processor - ERROR - 处理第 20 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,771 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,772 - utils.excel_processor - ERROR - 处理第 21 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,772 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,772 - utils.excel_processor - ERROR - 处理第 22 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,772 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,774 - utils.excel_processor - ERROR - 处理第 23 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,774 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,775 - utils.excel_processor - ERROR - 处理第 24 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,775 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,775 - utils.excel_processor - ERROR - 处理第 25 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,776 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,776 - utils.excel_processor - ERROR - 处理第 26 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,777 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,777 - utils.excel_processor - ERROR - 处理第 27 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,778 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,778 - utils.excel_processor - ERROR - 处理第 28 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,779 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,779 - utils.excel_processor - ERROR - 处理第 29 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:57:07,780 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 634, in _process_services
    if pd.isna(project_val) or (isinstance(project_val, str) and project_val.strip() == ""):
       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:57:07,780 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 0 条记录，跳过 30 行
2025-03-29 01:57:07,780 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:57:07,780 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:57:07,780 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:57:07,780 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:57:07,780 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:57:07,780 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:57:07,781 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content', '需要跟进': 'follow_up_needed', '负责人': 'staff'}
2025-03-29 01:57:07,781 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:57:07,781 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:57:07,781 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:57:07,781 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:57:07,781 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:57:07,781 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:57:07,781 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:57:07,782 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:57:07,782 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:57:07,783 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:57:07,783 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:57:07,783 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:57:07,784 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:57:07,784 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:57:07,784 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:57:07,784 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:57:07,784 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:57:07,784 - ExcelTest - INFO -   services: 0项
2025-03-29 01:57:07,785 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:57:07,785 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:57:07,785 - ExcelTest - INFO -   id: C001
2025-03-29 01:57:07,785 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:57:07,785 - ExcelTest - INFO -   gender: 女
2025-03-29 01:57:07,785 - ExcelTest - INFO -   age: 28
2025-03-29 01:57:07,785 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:57:07,785 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:57:07,785 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:57:07,786 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:57:07,786 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:57:07,786 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:57:07,786 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:57:07,786 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:57:07,786 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:57:07,786 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:57:07,786 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:57:07,786 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:57:07,786 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:57:07,786 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:57:07,786 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:57:07,786 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:57:07,786 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:57:07,786 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:57:07,786 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:58:27,372 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:58:27,372 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:58:27,554 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:58:27,554 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:58:27,554 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:58:27,554 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:58:27,554 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:58:27,554 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:58:27,554 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:58:27,775 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:58:27,776 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:58:27,776 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:58:27,776 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:58:27,776 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:58:27,777 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:58:27,785 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:58:27,786 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:58:27,786 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:58:27,786 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:58:27,787 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:58:27,787 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:58:27,787 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:58:27,787 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:58:27,787 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:58:27,788 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:58:27,788 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:58:27,788 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:58:27,788 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:58:27,788 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:58:27,788 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:58:27,789 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:58:27,789 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:58:27,789 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:58:27,789 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:58:27,789 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:58:27,790 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:58:27,790 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:58:27,790 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:58:27,790 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:58:27,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:58:27,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:58:27,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:58:27,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:58:27,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:58:27,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:58:27,792 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:58:27,792 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师']
2025-03-29 01:58:27,793 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:58:27,793 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}]
2025-03-29 01:58:27,793 - utils.excel_processor - ERROR - 处理第 0 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,796 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,796 - utils.excel_processor - ERROR - 处理第 1 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,797 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,798 - utils.excel_processor - ERROR - 处理第 2 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,798 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,799 - utils.excel_processor - ERROR - 处理第 3 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,799 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,800 - utils.excel_processor - ERROR - 处理第 4 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,800 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,801 - utils.excel_processor - ERROR - 处理第 5 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,802 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,802 - utils.excel_processor - ERROR - 处理第 6 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,803 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,803 - utils.excel_processor - ERROR - 处理第 7 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,804 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,804 - utils.excel_processor - ERROR - 处理第 8 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,805 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,805 - utils.excel_processor - ERROR - 处理第 9 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,806 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,806 - utils.excel_processor - ERROR - 处理第 10 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,807 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,808 - utils.excel_processor - ERROR - 处理第 11 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,808 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,809 - utils.excel_processor - ERROR - 处理第 12 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,809 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,809 - utils.excel_processor - ERROR - 处理第 13 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,810 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,810 - utils.excel_processor - ERROR - 处理第 14 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,811 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,811 - utils.excel_processor - ERROR - 处理第 15 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,812 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,813 - utils.excel_processor - ERROR - 处理第 16 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,813 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,814 - utils.excel_processor - ERROR - 处理第 17 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,814 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,814 - utils.excel_processor - ERROR - 处理第 18 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,815 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,815 - utils.excel_processor - ERROR - 处理第 19 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,816 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,816 - utils.excel_processor - ERROR - 处理第 20 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,817 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,817 - utils.excel_processor - ERROR - 处理第 21 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,818 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,819 - utils.excel_processor - ERROR - 处理第 22 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,819 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,820 - utils.excel_processor - ERROR - 处理第 23 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,820 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,821 - utils.excel_processor - ERROR - 处理第 24 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,821 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,822 - utils.excel_processor - ERROR - 处理第 25 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,822 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,823 - utils.excel_processor - ERROR - 处理第 26 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,823 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,824 - utils.excel_processor - ERROR - 处理第 27 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,824 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,824 - utils.excel_processor - ERROR - 处理第 28 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,825 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,825 - utils.excel_processor - ERROR - 处理第 29 行时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-03-29 01:58:27,826 - utils.excel_processor - ERROR - Traceback (most recent call last):
  File "D:\BeautyCRM-Mini\server\utils\excel_processor.py", line 649, in _process_services
    beautician = row[group['beautician']] if pd.notna(row[group['beautician']]) else None
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\chhtw\anaconda3\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2025-03-29 01:58:27,826 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 0 条记录，跳过 30 行
2025-03-29 01:58:27,826 - utils.excel_processor - INFO - 处理服务记录完成，共0条记录
2025-03-29 01:58:27,826 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:58:27,826 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:58:27,826 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:58:27,826 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:58:27,826 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:58:27,826 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content', '需要跟进': 'follow_up_needed', '负责人': 'staff'}
2025-03-29 01:58:27,827 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:58:27,827 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:58:27,827 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:58:27,827 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:58:27,827 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:58:27,827 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:58:27,827 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:58:27,828 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:58:27,828 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:58:27,829 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 0, '沟通记录数量': 15}
2025-03-29 01:58:27,829 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:58:27,829 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:58:27,830 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:58:27,830 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:58:27,830 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:58:27,830 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:58:27,830 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:58:27,831 - ExcelTest - INFO -   services: 0项
2025-03-29 01:58:27,831 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:58:27,831 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:58:27,831 - ExcelTest - INFO -   id: C001
2025-03-29 01:58:27,831 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:58:27,831 - ExcelTest - INFO -   gender: 女
2025-03-29 01:58:27,831 - ExcelTest - INFO -   age: 28
2025-03-29 01:58:27,831 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:58:27,832 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:58:27,832 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:58:27,832 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:58:27,832 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:58:27,832 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:58:27,832 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:58:27,832 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:58:27,832 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:58:27,832 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:58:27,832 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:58:27,832 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:58:27,832 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:58:27,832 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:58:27,832 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:58:27,832 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:58:27,832 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:58:27,832 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:58:27,832 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 01:59:33,441 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 01:59:33,442 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 01:59:33,624 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 01:59:33,624 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 01:59:33,624 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:59:33,624 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 01:59:33,624 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 01:59:33,624 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:59:33,624 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:59:33,842 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 01:59:33,842 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 01:59:33,842 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 01:59:33,842 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 01:59:33,842 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 01:59:33,844 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 01:59:33,852 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 01:59:33,852 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:59:33,852 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 01:59:33,852 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 01:59:33,852 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 01:59:33,853 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 01:59:33,854 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:59:33,854 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 01:59:33,854 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 01:59:33,854 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 01:59:33,855 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 01:59:33,855 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 01:59:33,855 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 01:59:33,855 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 01:59:33,855 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 01:59:33,856 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:59:33,856 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:59:33,856 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:59:33,856 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 01:59:33,856 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 01:59:33,857 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:59:33,857 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 01:59:33,857 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 01:59:33,857 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 01:59:33,857 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:59:33,857 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 01:59:33,857 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 01:59:33,857 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 01:59:33,857 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 01:59:33,858 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 01:59:33,858 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 01:59:33,858 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师']
2025-03-29 01:59:33,858 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 01:59:33,858 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}]
2025-03-29 01:59:33,859 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,859 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,860 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,860 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,861 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,861 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,862 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,862 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,862 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,863 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,864 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,864 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,865 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,865 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,866 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,867 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,867 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,868 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,868 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,869 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,869 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,870 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,870 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,871 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,871 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,872 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,873 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,873 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,874 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,874 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,875 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,875 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,875 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,876 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,876 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,877 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,877 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,878 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,878 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,879 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,880 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,880 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,881 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,881 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,881 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,882 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,882 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,882 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,884 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,884 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,885 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,885 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,886 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,886 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,887 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,887 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,888 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,888 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,888 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,889 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,890 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,890 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,891 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,891 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,892 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,892 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,893 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,893 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,894 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,894 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,895 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,895 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,896 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,896 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,897 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,897 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,898 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,898 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,899 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,899 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,900 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,900 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,901 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,901 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,902 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,902 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,903 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,904 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,904 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,904 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,905 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,905 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,906 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,906 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,906 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 01:59:33,907 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,907 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,908 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,908 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,909 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 01:59:33,909 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,910 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,910 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,911 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,911 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,912 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,912 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,913 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,913 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,913 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,914 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,915 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,915 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,916 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,916 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,917 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,917 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,917 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,918 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,918 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,919 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,919 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,920 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,920 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,920 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,921 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,922 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,922 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,923 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,923 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,924 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,924 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,924 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,924 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,925 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 01:59:33,925 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,926 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,927 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,927 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,928 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 01:59:33,928 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,929 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,929 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,930 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,930 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 01:59:33,931 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,931 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,932 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,932 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,932 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 150 条记录，跳过 -120 行
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 01:59:33,934 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content', '需要跟进': 'follow_up_needed', '负责人': 'staff'}
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 01:59:33,935 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 01:59:33,936 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 01:59:33,936 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 01:59:33,936 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 01:59:33,936 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 01:59:33,936 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 01:59:33,940 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 01:59:33,940 - ExcelTest - INFO - 处理结果统计:
2025-03-29 01:59:33,940 - ExcelTest - INFO -   customers: 3项
2025-03-29 01:59:33,940 - ExcelTest - INFO -   health_records: 3项
2025-03-29 01:59:33,940 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 01:59:33,940 - ExcelTest - INFO -   services: 150项
2025-03-29 01:59:33,940 - ExcelTest - INFO -   communications: 15项
2025-03-29 01:59:33,940 - ExcelTest - INFO - 客户数据示例:
2025-03-29 01:59:33,940 - ExcelTest - INFO -   id: C001
2025-03-29 01:59:33,940 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 01:59:33,941 - ExcelTest - INFO -   gender: 女
2025-03-29 01:59:33,941 - ExcelTest - INFO -   age: 28
2025-03-29 01:59:33,941 - ExcelTest - INFO -   store: 分店A
2025-03-29 01:59:33,941 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 01:59:33,941 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 01:59:33,941 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 01:59:33,941 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 01:59:33,941 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 01:59:33,942 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 01:59:33,942 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 01:59:33,942 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 01:59:33,942 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 01:59:33,942 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 01:59:33,942 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 01:59:33,942 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 01:59:33,942 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 01:59:33,942 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 01:59:33,942 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 01:59:33,942 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 01:59:33,942 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 01:59:33,942 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 02:00:46,754 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 02:00:46,754 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 02:00:46,932 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 02:00:46,932 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 02:00:46,932 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:00:46,932 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 02:00:46,932 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 02:00:46,932 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:00:46,932 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:00:47,148 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 02:00:47,148 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 02:00:47,148 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 02:00:47,148 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 02:00:47,149 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 02:00:47,149 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 02:00:47,156 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 02:00:47,156 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 02:00:47,156 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 02:00:47,157 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 02:00:47,157 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 02:00:47,157 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 02:00:47,158 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 02:00:47,159 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 02:00:47,159 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 02:00:47,159 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 02:00:47,159 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 02:00:47,159 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 02:00:47,159 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 02:00:47,159 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 02:00:47,160 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:00:47,160 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 02:00:47,160 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:00:47,160 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 02:00:47,160 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 02:00:47,160 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:00:47,161 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 02:00:47,161 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:00:47,161 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 02:00:47,161 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 02:00:47,161 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 02:00:47,161 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 02:00:47,161 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 02:00:47,161 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 02:00:47,162 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 02:00:47,162 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 02:00:47,162 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师', '耗卡金额', '是否指定', '耗卡金额', '操作美容师']
2025-03-29 02:00:47,162 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 02:00:47,162 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}, {'project': '耗卡金额', 'beautician': '是否指定', 'amount': '耗卡金额', 'is_specified': '操作美容师'}]
2025-03-29 02:00:47,164 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,164 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,165 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,165 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,165 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,166 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,166 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,167 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,167 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,168 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,169 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,169 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,170 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,170 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,171 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,171 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,172 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,172 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,172 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,173 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,173 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,174 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,174 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,174 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,175 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,176 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,176 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,176 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,177 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,177 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,178 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,178 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,178 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,179 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,179 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,179 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,180 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,180 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,181 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,182 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,182 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,183 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,183 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,184 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,184 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,184 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,184 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,185 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,185 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,186 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,186 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,187 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,187 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,188 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,188 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,189 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,189 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,189 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,190 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,190 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,191 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,191 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,192 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,192 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,192 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,194 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,195 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,195 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,195 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,196 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,196 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,197 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,197 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,197 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,198 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,198 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,199 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,200 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,200 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,200 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,201 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,201 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,202 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,202 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,202 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,203 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,203 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,204 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,204 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,204 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,205 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,205 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,206 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,206 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,207 - utils.excel_processor - WARNING - 金额转换失败: 草本熏蒸SPA
2025-03-29 02:00:47,207 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,208 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,208 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,208 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,209 - utils.excel_processor - WARNING - 金额转换失败: 经络排毒塑身
2025-03-29 02:00:47,209 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,209 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,210 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,210 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,211 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,212 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,213 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,213 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,213 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,214 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,214 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,214 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,215 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,215 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,216 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,216 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,217 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,217 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,218 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,218 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,218 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,220 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,220 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,220 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,221 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,222 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,222 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,222 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,223 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,224 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,224 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,224 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,225 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,225 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,225 - utils.excel_processor - WARNING - 金额转换失败: 冰肌焕颜护理
2025-03-29 02:00:47,226 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,226 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,227 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,227 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,228 - utils.excel_processor - WARNING - 金额转换失败: 帝王艾灸调理
2025-03-29 02:00:47,229 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,229 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,230 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,230 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,231 - utils.excel_processor - WARNING - 金额转换失败: 极光净透泡泡
2025-03-29 02:00:47,231 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,232 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,232 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,232 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,232 - utils.excel_processor - WARNING - 金额转换失败: 黄金射频紧致疗程
2025-03-29 02:00:47,232 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 150 条记录，跳过 -120 行
2025-03-29 02:00:47,232 - utils.excel_processor - INFO - 处理服务记录完成，共150条记录
2025-03-29 02:00:47,232 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 02:00:47,232 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 02:00:47,234 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 02:00:47,234 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 02:00:47,234 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 02:00:47,234 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content', '需要跟进': 'follow_up_needed', '负责人': 'staff'}
2025-03-29 02:00:47,234 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 02:00:47,234 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 02:00:47,234 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 02:00:47,235 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 02:00:47,235 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 02:00:47,235 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 02:00:47,235 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 02:00:47,235 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 02:00:47,235 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 02:00:47,236 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 02:00:47,236 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 02:00:47,236 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 02:00:47,236 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 02:00:47,236 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 02:00:47,237 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 02:00:47,237 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 02:00:47,237 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 02:00:47,237 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 150, '沟通记录数量': 15}
2025-03-29 02:00:47,237 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:00:47,237 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 02:00:47,240 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 02:00:47,240 - ExcelTest - INFO - 处理结果统计:
2025-03-29 02:00:47,240 - ExcelTest - INFO -   customers: 3项
2025-03-29 02:00:47,240 - ExcelTest - INFO -   health_records: 3项
2025-03-29 02:00:47,240 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 02:00:47,240 - ExcelTest - INFO -   services: 150项
2025-03-29 02:00:47,240 - ExcelTest - INFO -   communications: 15项
2025-03-29 02:00:47,241 - ExcelTest - INFO - 客户数据示例:
2025-03-29 02:00:47,241 - ExcelTest - INFO -   id: C001
2025-03-29 02:00:47,241 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 02:00:47,241 - ExcelTest - INFO -   gender: 女
2025-03-29 02:00:47,241 - ExcelTest - INFO -   age: 28
2025-03-29 02:00:47,241 - ExcelTest - INFO -   store: 分店A
2025-03-29 02:00:47,241 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 02:00:47,241 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 02:00:47,241 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 02:00:47,241 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 02:00:47,242 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 02:00:47,242 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 02:00:47,242 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 02:00:47,242 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 02:00:47,242 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 02:00:47,242 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 02:00:47,242 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 02:00:47,242 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 02:00:47,242 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 02:00:47,242 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 02:00:47,242 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 02:00:47,242 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 02:00:47,243 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 02:00:47,243 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-03-29 02:17:15,717 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-03-29 02:17:15,717 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-03-29 02:17:15,892 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-03-29 02:17:15,892 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-03-29 02:17:15,894 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:17:15,894 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-03-29 02:17:15,894 - ExcelTest - INFO - 开始调用process_file方法
2025-03-29 02:17:15,894 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:17:15,894 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:17:16,112 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-03-29 02:17:16,112 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-03-29 02:17:16,113 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-03-29 02:17:16,113 - utils.excel_processor - INFO - 开始处理客户数据
2025-03-29 02:17:16,113 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-03-29 02:17:16,113 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-03-29 02:17:16,120 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-03-29 02:17:16,121 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 02:17:16,121 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-03-29 02:17:16,121 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-03-29 02:17:16,121 - utils.excel_processor - INFO - 处理客户ID: C001
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 处理客户ID: C002
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 处理客户ID: C003
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-03-29 02:17:16,122 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-03-29 02:17:16,124 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-03-29 02:17:16,124 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-03-29 02:17:16,124 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-03-29 02:17:16,124 - utils.excel_processor - INFO - 开始处理消费记录
2025-03-29 02:17:16,124 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-03-29 02:17:16,124 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-03-29 02:17:16,125 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:17:16,125 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 02:17:16,125 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:17:16,125 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-03-29 02:17:16,125 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-03-29 02:17:16,125 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:17:16,126 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-03-29 02:17:16,126 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-03-29 02:17:16,126 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-03-29 02:17:16,126 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - DataFrame形状: (31, 26)
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', '消耗项目1', 'Unnamed: 7', 'Unnamed: 8', 'Unnamed: 9', '消耗项目2', 'Unnamed: 11', 'Unnamed: 12', 'Unnamed: 13', '消耗项目3', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', '消耗项目4', 'Unnamed: 19', 'Unnamed: 20', 'Unnamed: 21', '消耗项目5', 'Unnamed: 23', 'Unnamed: 24', 'Unnamed: 25']
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额']
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-03-29 02:17:16,127 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-03-29 02:17:16,128 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-03-29 02:17:16,171 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-03-29 02:17:16,171 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-03-29 02:17:16,171 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-03-29 02:17:16,171 - utils.excel_processor - INFO - 开始处理沟通记录
2025-03-29 02:17:16,171 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-03-29 02:17:16,171 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 02:17:16,172 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-03-29 02:17:16,172 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'comm_time', '沟通地点': 'comm_location', '沟通主要内容': 'comm_content', '需要跟进': 'follow_up_needed', '负责人': 'staff'}
2025-03-29 02:17:16,172 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-03-29 02:17:16,172 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-03-29 02:17:16,172 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-03-29 02:17:16,173 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-03-29 02:17:16,174 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-03-29 02:17:16,174 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-03-29 02:17:16,174 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-03-29 02:17:16,174 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-03-29 02:17:16,174 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-03-29 02:17:16,174 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-03-29 02:17:16,174 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-03-29 02:17:16,174 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-03-29 02:17:16,177 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-03-29 02:17:16,177 - ExcelTest - INFO - 处理结果统计:
2025-03-29 02:17:16,177 - ExcelTest - INFO -   customers: 3项
2025-03-29 02:17:16,177 - ExcelTest - INFO -   health_records: 3项
2025-03-29 02:17:16,177 - ExcelTest - INFO -   consumptions: 9项
2025-03-29 02:17:16,177 - ExcelTest - INFO -   services: 30项
2025-03-29 02:17:16,178 - ExcelTest - INFO -   communications: 15项
2025-03-29 02:17:16,178 - ExcelTest - INFO - 客户数据示例:
2025-03-29 02:17:16,178 - ExcelTest - INFO -   id: C001
2025-03-29 02:17:16,178 - ExcelTest - INFO -   name: 林晓薇
2025-03-29 02:17:16,178 - ExcelTest - INFO -   gender: 女
2025-03-29 02:17:16,178 - ExcelTest - INFO -   age: 28
2025-03-29 02:17:16,178 - ExcelTest - INFO -   store: 分店A
2025-03-29 02:17:16,178 - ExcelTest - INFO -   hometown: 浙江杭州
2025-03-29 02:17:16,178 - ExcelTest - INFO -   residence: 上海浦东
2025-03-29 02:17:16,178 - ExcelTest - INFO -   residence_years: 6年
2025-03-29 02:17:16,178 - ExcelTest - INFO -   family_structure: 单身独居
2025-03-29 02:17:16,178 - ExcelTest - INFO -   family_age_distribution: 无
2025-03-29 02:17:16,178 - ExcelTest - INFO -   living_condition: 自有公寓
2025-03-29 02:17:16,178 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-03-29 02:17:16,178 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-03-29 02:17:16,178 - ExcelTest - INFO -   risk_sensitivity: 低
2025-03-29 02:17:16,179 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-03-29 02:17:16,179 - ExcelTest - INFO -   routine: 23:00-7:00
2025-03-29 02:17:16,179 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-03-29 02:17:16,179 - ExcelTest - INFO -   menstrual_record: 记录
2025-03-29 02:17:16,179 - ExcelTest - INFO -   family_medical_history: 无
2025-03-29 02:17:16,179 - ExcelTest - INFO -   occupation: 时尚编辑
2025-03-29 02:17:16,179 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-03-29 02:17:16,179 - ExcelTest - INFO -   annual_income: 35万
2025-03-29 02:17:16,179 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 13:26:58,636 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 13:26:58,636 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 13:26:58,817 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 13:26:58,817 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 13:26:58,817 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:26:58,817 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 13:26:58,817 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 13:26:58,818 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:26:58,818 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:26:59,043 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 13:26:59,044 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 13:26:59,044 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 13:26:59,044 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 13:26:59,044 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 13:26:59,045 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 13:26:59,051 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 13:26:59,053 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:26:59,053 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 13:26:59,053 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 13:26:59,054 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 13:26:59,055 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 13:26:59,055 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:26:59,055 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:26:59,055 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 13:26:59,056 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 13:26:59,056 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 13:26:59,056 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 13:26:59,056 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 13:26:59,056 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 13:26:59,057 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 13:26:59,057 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:26:59,057 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:26:59,058 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:26:59,058 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 13:26:59,058 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 13:26:59,058 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:26:59,058 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 13:26:59,058 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:26:59,058 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 13:26:59,059 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 13:26:59,060 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 13:26:59,100 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 13:26:59,101 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 13:26:59,101 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 13:26:59,101 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 13:26:59,101 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 13:26:59,101 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:26:59,101 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:26:59,101 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 13:26:59,101 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 13:26:59,101 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 13:26:59,103 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 13:26:59,104 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 13:26:59,104 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 13:26:59,104 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 13:26:59,104 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 13:26:59,104 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 13:26:59,104 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 13:26:59,104 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 13:26:59,105 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 13:26:59,105 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:26:59,105 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 13:26:59,107 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 13:26:59,107 - ExcelTest - INFO - 处理结果统计:
2025-04-01 13:26:59,107 - ExcelTest - INFO -   customers: 3项
2025-04-01 13:26:59,107 - ExcelTest - INFO -   health_records: 3项
2025-04-01 13:26:59,108 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 13:26:59,108 - ExcelTest - INFO -   services: 30项
2025-04-01 13:26:59,108 - ExcelTest - INFO -   communications: 15项
2025-04-01 13:26:59,108 - ExcelTest - INFO - 客户数据示例:
2025-04-01 13:26:59,108 - ExcelTest - INFO -   id: C001
2025-04-01 13:26:59,108 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 13:26:59,108 - ExcelTest - INFO -   gender: 女
2025-04-01 13:26:59,108 - ExcelTest - INFO -   age: 28
2025-04-01 13:26:59,108 - ExcelTest - INFO -   store: 分店A
2025-04-01 13:26:59,108 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 13:26:59,108 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 13:26:59,108 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 13:26:59,108 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 13:26:59,109 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 13:26:59,109 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 13:26:59,109 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 13:26:59,109 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 13:26:59,109 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 13:26:59,109 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 13:26:59,109 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 13:26:59,109 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 13:26:59,109 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 13:26:59,109 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 13:26:59,109 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 13:26:59,109 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 13:26:59,109 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 13:26:59,109 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 13:46:01,992 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 13:46:01,992 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 13:46:02,171 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 13:46:02,171 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 13:46:02,173 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:46:02,173 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 13:46:02,173 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 13:46:02,173 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:46:02,173 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:46:02,386 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 13:46:02,386 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 13:46:02,386 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 13:46:02,386 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 13:46:02,386 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 13:46:02,387 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 13:46:02,394 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 13:46:02,395 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:46:02,395 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 13:46:02,395 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:46:02,395 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 13:46:02,396 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 13:46:02,396 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 13:46:02,396 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 13:46:02,396 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 13:46:02,396 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 13:46:02,396 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 13:46:02,396 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 13:46:02,397 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 13:46:02,397 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:46:02,397 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:46:02,397 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 13:46:02,398 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 13:46:02,398 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 13:46:02,398 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 13:46:02,398 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 13:46:02,398 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 13:46:02,398 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 13:46:02,399 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:46:02,399 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:46:02,399 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:46:02,399 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 13:46:02,399 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 13:46:02,400 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:46:02,400 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 13:46:02,400 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:46:02,400 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:46:02,400 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:46:02,400 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:46:02,400 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 13:46:02,400 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 13:46:02,401 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 13:46:02,401 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 13:46:02,401 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 13:46:02,401 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 13:46:02,401 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 13:46:02,401 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 13:46:02,445 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 13:46:02,445 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 13:46:02,445 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 13:46:02,445 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 13:46:02,445 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 13:46:02,445 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:46:02,446 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:46:02,446 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 13:46:02,446 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 13:46:02,446 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 13:46:02,447 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 13:46:02,448 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 13:46:02,448 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 13:46:02,448 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 13:46:02,448 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 13:46:02,448 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 13:46:02,448 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 13:46:02,448 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 13:46:02,448 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 13:46:02,448 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:46:02,448 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 13:46:02,451 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 13:46:02,451 - ExcelTest - INFO - 处理结果统计:
2025-04-01 13:46:02,451 - ExcelTest - INFO -   customers: 3项
2025-04-01 13:46:02,451 - ExcelTest - INFO -   health_records: 3项
2025-04-01 13:46:02,452 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 13:46:02,452 - ExcelTest - INFO -   services: 30项
2025-04-01 13:46:02,452 - ExcelTest - INFO -   communications: 15项
2025-04-01 13:46:02,452 - ExcelTest - INFO - 客户数据示例:
2025-04-01 13:46:02,452 - ExcelTest - INFO -   id: C001
2025-04-01 13:46:02,452 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 13:46:02,452 - ExcelTest - INFO -   gender: 女
2025-04-01 13:46:02,452 - ExcelTest - INFO -   age: 28
2025-04-01 13:46:02,452 - ExcelTest - INFO -   store: 分店A
2025-04-01 13:46:02,452 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 13:46:02,452 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 13:46:02,452 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 13:46:02,452 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 13:46:02,452 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 13:46:02,453 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 13:46:02,453 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 13:46:02,453 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 13:46:02,453 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 13:46:02,453 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 13:46:02,453 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 13:46:02,453 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 13:46:02,453 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 13:46:02,453 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 13:46:02,453 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 13:46:02,453 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 13:46:02,453 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 13:46:02,453 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 13:56:03,379 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 13:56:03,379 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 13:56:03,561 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 13:56:03,562 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 13:56:03,562 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:03,562 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 13:56:03,562 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 13:56:03,562 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:03,562 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:03,778 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 13:56:03,778 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 13:56:03,779 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 13:56:03,779 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 13:56:03,779 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 13:56:03,779 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 13:56:03,787 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 13:56:03,787 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:56:03,787 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 13:56:03,787 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:56:03,787 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 13:56:03,788 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:56:03,789 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:56:03,789 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 13:56:03,789 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 13:56:03,789 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 13:56:03,789 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 13:56:03,789 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 13:56:03,790 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 13:56:03,790 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 13:56:03,790 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:56:03,791 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 13:56:03,792 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 13:56:03,837 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 13:56:03,837 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 13:56:03,837 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 13:56:03,837 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 13:56:03,837 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 13:56:03,837 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:56:03,837 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:56:03,838 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 13:56:03,838 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:03,838 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:03,839 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:03,839 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:03,839 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:03,839 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:03,840 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:03,841 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:03,841 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 13:56:03,841 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 13:56:03,841 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 13:56:03,841 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:03,841 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 13:56:03,843 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 13:56:03,843 - ExcelTest - INFO - 处理结果统计:
2025-04-01 13:56:03,843 - ExcelTest - INFO -   customers: 3项
2025-04-01 13:56:03,843 - ExcelTest - INFO -   health_records: 3项
2025-04-01 13:56:03,843 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 13:56:03,843 - ExcelTest - INFO -   services: 30项
2025-04-01 13:56:03,843 - ExcelTest - INFO -   communications: 15项
2025-04-01 13:56:03,843 - ExcelTest - INFO - 客户数据示例:
2025-04-01 13:56:03,844 - ExcelTest - INFO -   id: C001
2025-04-01 13:56:03,844 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 13:56:03,844 - ExcelTest - INFO -   gender: 女
2025-04-01 13:56:03,844 - ExcelTest - INFO -   age: 28
2025-04-01 13:56:03,844 - ExcelTest - INFO -   store: 分店A
2025-04-01 13:56:03,844 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 13:56:03,844 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 13:56:03,844 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 13:56:03,844 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 13:56:03,844 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 13:56:03,845 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 13:56:03,845 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 13:56:03,845 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 13:56:03,845 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 13:56:03,845 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 13:56:03,845 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 13:56:03,845 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 13:56:03,845 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 13:56:03,845 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 13:56:03,846 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 13:56:03,846 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 13:56:03,846 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 13:56:03,846 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 13:56:18,772 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 13:56:18,772 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 13:56:18,951 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 13:56:18,951 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 13:56:18,951 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:18,951 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 13:56:18,951 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 13:56:18,951 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:18,951 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:19,168 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 13:56:19,168 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 13:56:19,168 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 13:56:19,168 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 13:56:19,169 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 13:56:19,169 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 13:56:19,177 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 13:56:19,177 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:56:19,177 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 13:56:19,178 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 13:56:19,178 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 13:56:19,178 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:56:19,179 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 13:56:19,180 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 13:56:19,180 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 13:56:19,180 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 13:56:19,180 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 13:56:19,180 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 13:56:19,180 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 13:56:19,180 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 13:56:19,181 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:56:19,181 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 13:56:19,181 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 13:56:19,183 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 13:56:19,183 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 13:56:19,183 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 13:56:19,183 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 13:56:19,183 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 13:56:19,183 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 13:56:19,183 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 13:56:19,224 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 13:56:19,224 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 13:56:19,224 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 13:56:19,224 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 13:56:19,224 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 13:56:19,224 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:56:19,224 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 13:56:19,225 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 13:56:19,225 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:19,225 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:19,225 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:19,226 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:19,226 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 13:56:19,226 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:19,226 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:19,226 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:19,226 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:19,227 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 13:56:19,227 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:19,227 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:19,227 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:19,227 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:19,227 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 13:56:19,228 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 13:56:19,228 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 13:56:19,228 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 13:56:19,228 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 13:56:19,228 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 13:56:19,230 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 13:56:19,230 - ExcelTest - INFO - 处理结果统计:
2025-04-01 13:56:19,230 - ExcelTest - INFO -   customers: 3项
2025-04-01 13:56:19,231 - ExcelTest - INFO -   health_records: 3项
2025-04-01 13:56:19,231 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 13:56:19,231 - ExcelTest - INFO -   services: 30项
2025-04-01 13:56:19,231 - ExcelTest - INFO -   communications: 15项
2025-04-01 13:56:19,231 - ExcelTest - INFO - 客户数据示例:
2025-04-01 13:56:19,231 - ExcelTest - INFO -   id: C001
2025-04-01 13:56:19,231 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 13:56:19,231 - ExcelTest - INFO -   gender: 女
2025-04-01 13:56:19,231 - ExcelTest - INFO -   age: 28
2025-04-01 13:56:19,231 - ExcelTest - INFO -   store: 分店A
2025-04-01 13:56:19,231 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 13:56:19,231 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 13:56:19,231 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 13:56:19,231 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 13:56:19,233 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 13:56:19,233 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 13:56:19,233 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 13:56:19,233 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 13:56:19,233 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 13:56:19,233 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 13:56:19,233 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 13:56:19,233 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 13:56:19,233 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 13:56:19,233 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 13:56:19,233 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 13:56:19,233 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 13:56:19,233 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 13:56:19,234 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 14:07:57,001 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 14:07:57,001 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 14:07:57,183 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 14:07:57,183 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 14:07:57,184 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:07:57,184 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 14:07:57,184 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 14:07:57,184 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:07:57,184 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:07:57,403 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 14:07:57,404 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 14:07:57,404 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 14:07:57,404 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 14:07:57,404 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 14:07:57,404 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 14:07:57,413 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 14:07:57,413 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:07:57,413 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 14:07:57,413 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:07:57,413 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 14:07:57,413 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 14:07:57,414 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 14:07:57,414 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 14:07:57,414 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 14:07:57,414 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 14:07:57,414 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 14:07:57,414 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 14:07:57,414 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 14:07:57,415 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:07:57,415 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:07:57,416 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 14:07:57,416 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 14:07:57,416 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 14:07:57,416 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 14:07:57,416 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 14:07:57,416 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 14:07:57,416 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 14:07:57,417 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:07:57,417 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:07:57,417 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:07:57,417 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 14:07:57,417 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 14:07:57,417 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:07:57,417 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 14:07:57,418 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:07:57,418 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:07:57,418 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:07:57,418 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:07:57,418 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 14:07:57,418 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 14:07:57,418 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 14:07:57,419 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 14:07:57,419 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 14:07:57,419 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 14:07:57,419 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 14:07:57,419 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 14:07:57,459 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 14:07:57,459 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 14:07:57,459 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 14:07:57,460 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 14:07:57,460 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 14:07:57,460 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:07:57,460 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:07:57,460 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 14:07:57,460 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 14:07:57,460 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 14:07:57,461 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 14:07:57,461 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 14:07:57,461 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 14:07:57,461 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 14:07:57,461 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 14:07:57,462 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 14:07:57,462 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 14:07:57,462 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 14:07:57,462 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 14:07:57,462 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 14:07:57,463 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 14:07:57,463 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 14:07:57,463 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 14:07:57,463 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 14:07:57,463 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 14:07:57,463 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 14:07:57,463 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:07:57,463 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 14:07:57,466 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 14:07:57,466 - ExcelTest - INFO - 处理结果统计:
2025-04-01 14:07:57,466 - ExcelTest - INFO -   customers: 3项
2025-04-01 14:07:57,466 - ExcelTest - INFO -   health_records: 3项
2025-04-01 14:07:57,466 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 14:07:57,466 - ExcelTest - INFO -   services: 30项
2025-04-01 14:07:57,466 - ExcelTest - INFO -   communications: 15项
2025-04-01 14:07:57,467 - ExcelTest - INFO - 客户数据示例:
2025-04-01 14:07:57,467 - ExcelTest - INFO -   id: C001
2025-04-01 14:07:57,467 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 14:07:57,467 - ExcelTest - INFO -   gender: 女
2025-04-01 14:07:57,467 - ExcelTest - INFO -   age: 28
2025-04-01 14:07:57,467 - ExcelTest - INFO -   store: 分店A
2025-04-01 14:07:57,467 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 14:07:57,467 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 14:07:57,467 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 14:07:57,467 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 14:07:57,467 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 14:07:57,467 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 14:07:57,468 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 14:07:57,468 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 14:07:57,468 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 14:07:57,468 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 14:07:57,468 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 14:07:57,468 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 14:07:57,468 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 14:07:57,468 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 14:07:57,468 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 14:07:57,468 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 14:07:57,468 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 14:07:57,469 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 14:09:26,401 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 14:09:26,401 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 14:09:26,579 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 14:09:26,579 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 14:09:26,579 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:09:26,579 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 14:09:26,579 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 14:09:26,579 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:09:26,579 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:09:26,799 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 14:09:26,800 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 14:09:26,800 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 14:09:26,800 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 14:09:26,800 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 14:09:26,801 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 14:09:26,808 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 14:09:26,809 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:09:26,809 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 14:09:26,809 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:09:26,809 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 14:09:26,810 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:09:26,811 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:09:26,811 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 14:09:26,811 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 14:09:26,811 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 14:09:26,811 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 14:09:26,812 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 14:09:26,812 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 14:09:26,812 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:09:26,813 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:09:26,813 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:09:26,813 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 14:09:26,814 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 14:09:26,814 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 14:09:26,814 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 14:09:26,814 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 14:09:26,814 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 14:09:26,815 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 14:09:26,815 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 14:09:26,856 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 14:09:26,856 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 14:09:26,856 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 14:09:26,856 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 14:09:26,856 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 14:09:26,857 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:09:26,857 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:09:26,857 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 14:09:26,857 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 14:09:26,857 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 14:09:26,857 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 14:09:26,857 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 14:09:26,858 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 14:09:26,859 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 14:09:26,859 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 14:09:26,859 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 14:09:26,859 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 14:09:26,859 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 14:09:26,859 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:09:26,859 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 14:09:26,861 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 14:09:26,861 - ExcelTest - INFO - 处理结果统计:
2025-04-01 14:09:26,861 - ExcelTest - INFO -   customers: 3项
2025-04-01 14:09:26,861 - ExcelTest - INFO -   health_records: 3项
2025-04-01 14:09:26,861 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 14:09:26,863 - ExcelTest - INFO -   services: 30项
2025-04-01 14:09:26,863 - ExcelTest - INFO -   communications: 15项
2025-04-01 14:09:26,863 - ExcelTest - INFO - 客户数据示例:
2025-04-01 14:09:26,863 - ExcelTest - INFO -   id: C001
2025-04-01 14:09:26,863 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 14:09:26,863 - ExcelTest - INFO -   gender: 女
2025-04-01 14:09:26,863 - ExcelTest - INFO -   age: 28
2025-04-01 14:09:26,863 - ExcelTest - INFO -   store: 分店A
2025-04-01 14:09:26,863 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 14:09:26,863 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 14:09:26,863 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 14:09:26,863 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 14:09:26,863 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 14:09:26,863 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 14:09:26,864 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 14:09:26,864 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 14:09:26,864 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 14:09:26,864 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 14:09:26,864 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 14:09:26,864 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 14:09:26,864 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 14:09:26,864 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 14:09:26,864 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 14:09:26,864 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 14:09:26,864 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 14:09:26,864 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 14:10:43,008 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 14:10:43,009 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 14:10:43,190 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 14:10:43,191 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 14:10:43,191 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:10:43,191 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 14:10:43,191 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 14:10:43,191 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:10:43,191 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:10:43,433 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 14:10:43,433 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 14:10:43,433 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 14:10:43,433 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 14:10:43,433 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 14:10:43,434 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 14:10:43,441 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 14:10:43,441 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:10:43,441 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 14:10:43,442 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:10:43,442 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 14:10:43,442 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:10:43,443 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:10:43,444 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 14:10:43,444 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 14:10:43,444 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 14:10:43,444 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 14:10:43,444 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 14:10:43,444 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 14:10:43,444 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 14:10:43,445 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:10:43,445 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:10:43,445 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:10:43,445 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 14:10:43,445 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 14:10:43,445 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:10:43,445 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 14:10:43,446 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:10:43,446 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:10:43,446 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:10:43,446 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:10:43,446 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 14:10:43,446 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 14:10:43,446 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 14:10:43,446 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 14:10:43,447 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 14:10:43,447 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 14:10:43,448 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 14:10:43,448 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 14:10:43,491 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 14:10:43,491 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 14:10:43,491 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 14:10:43,491 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 14:10:43,493 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 14:10:43,493 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:10:43,493 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:10:43,493 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 14:10:43,493 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 14:10:43,493 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 14:10:43,493 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 14:10:43,494 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 14:10:43,494 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 14:10:43,494 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 14:10:43,494 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 14:10:43,494 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 14:10:43,495 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 14:10:43,495 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 14:10:43,495 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 14:10:43,495 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 14:10:43,495 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 14:10:43,495 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 14:10:43,495 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 14:10:43,496 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 14:10:43,496 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 14:10:43,496 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 14:10:43,496 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:10:43,496 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 14:10:43,499 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 14:10:43,499 - ExcelTest - INFO - 处理结果统计:
2025-04-01 14:10:43,499 - ExcelTest - INFO -   customers: 3项
2025-04-01 14:10:43,499 - ExcelTest - INFO -   health_records: 3项
2025-04-01 14:10:43,499 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 14:10:43,499 - ExcelTest - INFO -   services: 30项
2025-04-01 14:10:43,499 - ExcelTest - INFO -   communications: 15项
2025-04-01 14:10:43,499 - ExcelTest - INFO - 客户数据示例:
2025-04-01 14:10:43,499 - ExcelTest - INFO -   id: C001
2025-04-01 14:10:43,500 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 14:10:43,500 - ExcelTest - INFO -   gender: 女
2025-04-01 14:10:43,500 - ExcelTest - INFO -   age: 28
2025-04-01 14:10:43,500 - ExcelTest - INFO -   store: 分店A
2025-04-01 14:10:43,500 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 14:10:43,500 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 14:10:43,500 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 14:10:43,500 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 14:10:43,500 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 14:10:43,500 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 14:10:43,500 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 14:10:43,500 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 14:10:43,500 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 14:10:43,501 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 14:10:43,501 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 14:10:43,501 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 14:10:43,501 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 14:10:43,501 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 14:10:43,501 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 14:10:43,501 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 14:10:43,501 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 14:10:43,501 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 14:12:04,964 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 14:12:04,964 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 14:12:05,148 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 14:12:05,148 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 14:12:05,148 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:12:05,148 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 14:12:05,149 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 14:12:05,149 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:12:05,149 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:12:05,373 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 14:12:05,373 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 14:12:05,373 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 14:12:05,373 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 14:12:05,373 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 14:12:05,374 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 14:12:05,381 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 14:12:05,381 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:12:05,381 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 14:12:05,381 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:12:05,381 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 14:12:05,382 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 14:12:05,382 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 14:12:05,382 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 14:12:05,382 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 14:12:05,382 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 14:12:05,382 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 14:12:05,382 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 14:12:05,383 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 14:12:05,383 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:12:05,383 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:12:05,383 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 14:12:05,384 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 14:12:05,384 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 14:12:05,384 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 14:12:05,384 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 14:12:05,384 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 14:12:05,385 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 14:12:05,385 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:12:05,385 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:12:05,386 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:12:05,386 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 14:12:05,386 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 14:12:05,386 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:12:05,386 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 14:12:05,387 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:12:05,387 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:12:05,387 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:12:05,387 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:12:05,387 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 14:12:05,387 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 14:12:05,387 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 14:12:05,388 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 14:12:05,388 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 14:12:05,388 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 14:12:05,388 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 14:12:05,388 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 14:12:05,429 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 14:12:05,429 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 14:12:05,429 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 14:12:05,429 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 14:12:05,430 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 14:12:05,430 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:12:05,430 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:12:05,430 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 14:12:05,431 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 14:12:05,431 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 14:12:05,431 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 14:12:05,431 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 14:12:05,431 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 14:12:05,431 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 14:12:05,432 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 14:12:05,432 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 14:12:05,432 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 14:12:05,432 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 14:12:05,432 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 14:12:05,432 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 14:12:05,432 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 14:12:05,433 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 14:12:05,433 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 14:12:05,433 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 14:12:05,433 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 14:12:05,433 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 14:12:05,433 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:12:05,433 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 14:12:05,436 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 14:12:05,436 - ExcelTest - INFO - 处理结果统计:
2025-04-01 14:12:05,436 - ExcelTest - INFO -   customers: 3项
2025-04-01 14:12:05,436 - ExcelTest - INFO -   health_records: 3项
2025-04-01 14:12:05,436 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 14:12:05,436 - ExcelTest - INFO -   services: 30项
2025-04-01 14:12:05,436 - ExcelTest - INFO -   communications: 15项
2025-04-01 14:12:05,436 - ExcelTest - INFO - 客户数据示例:
2025-04-01 14:12:05,436 - ExcelTest - INFO -   id: C001
2025-04-01 14:12:05,436 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 14:12:05,436 - ExcelTest - INFO -   gender: 女
2025-04-01 14:12:05,437 - ExcelTest - INFO -   age: 28
2025-04-01 14:12:05,437 - ExcelTest - INFO -   store: 分店A
2025-04-01 14:12:05,437 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 14:12:05,437 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 14:12:05,437 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 14:12:05,437 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 14:12:05,437 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 14:12:05,437 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 14:12:05,437 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 14:12:05,437 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 14:12:05,437 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 14:12:05,437 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 14:12:05,437 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 14:12:05,438 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 14:12:05,438 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 14:12:05,438 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 14:12:05,438 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 14:12:05,439 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 14:12:05,439 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 14:12:05,439 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 14:23:59,468 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 14:23:59,469 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 14:23:59,649 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 14:23:59,650 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 14:23:59,650 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:23:59,650 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 14:23:59,650 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 14:23:59,650 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:23:59,650 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:23:59,869 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 14:23:59,869 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 14:23:59,869 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 14:23:59,869 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 14:23:59,869 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 14:23:59,870 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 14:23:59,877 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 14:23:59,877 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:23:59,878 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 14:23:59,878 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 14:23:59,878 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 14:23:59,878 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 14:23:59,878 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:23:59,879 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 14:23:59,880 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 14:23:59,880 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 14:23:59,880 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 14:23:59,880 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 14:23:59,880 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 14:23:59,880 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 14:23:59,880 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 14:23:59,881 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:23:59,881 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:23:59,881 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:23:59,881 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 14:23:59,881 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 14:23:59,881 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:23:59,881 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 14:23:59,882 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 14:23:59,882 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 14:23:59,882 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:23:59,882 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 14:23:59,882 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 14:23:59,882 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 14:23:59,882 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 14:23:59,883 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 14:23:59,883 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 14:23:59,883 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 14:23:59,883 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 14:23:59,883 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 14:23:59,923 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 14:23:59,924 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 14:23:59,924 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 14:23:59,924 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 14:23:59,924 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 14:23:59,924 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:23:59,924 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 14:23:59,924 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 14:23:59,925 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 14:23:59,926 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 14:23:59,926 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 14:23:59,926 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 14:23:59,927 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 14:23:59,927 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 14:23:59,929 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 14:23:59,930 - ExcelTest - INFO - 处理结果统计:
2025-04-01 14:23:59,930 - ExcelTest - INFO -   customers: 3项
2025-04-01 14:23:59,930 - ExcelTest - INFO -   health_records: 3项
2025-04-01 14:23:59,930 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 14:23:59,930 - ExcelTest - INFO -   services: 30项
2025-04-01 14:23:59,930 - ExcelTest - INFO -   communications: 15项
2025-04-01 14:23:59,930 - ExcelTest - INFO - 客户数据示例:
2025-04-01 14:23:59,930 - ExcelTest - INFO -   id: C001
2025-04-01 14:23:59,930 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 14:23:59,930 - ExcelTest - INFO -   gender: 女
2025-04-01 14:23:59,930 - ExcelTest - INFO -   age: 28
2025-04-01 14:23:59,931 - ExcelTest - INFO -   store: 分店A
2025-04-01 14:23:59,931 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 14:23:59,931 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 14:23:59,931 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 14:23:59,931 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 14:23:59,931 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 14:23:59,931 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 14:23:59,931 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 14:23:59,931 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 14:23:59,931 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 14:23:59,931 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 14:23:59,931 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 14:23:59,931 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 14:23:59,931 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 14:23:59,931 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 14:23:59,931 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 14:23:59,931 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 14:23:59,931 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 14:23:59,931 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 15:23:04,501 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 15:23:04,501 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 15:23:04,681 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 15:23:04,681 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 15:23:04,681 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:23:04,681 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 15:23:04,681 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 15:23:04,681 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:23:04,681 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:23:04,911 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 15:23:04,913 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 15:23:04,913 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 15:23:04,913 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 15:23:04,913 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 15:23:04,913 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 15:23:04,920 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 15:23:04,921 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 15:23:04,921 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 15:23:04,921 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 15:23:04,921 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 15:23:04,921 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 15:23:04,922 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 15:23:04,922 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 15:23:04,922 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 15:23:04,922 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 15:23:04,922 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 15:23:04,922 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 15:23:04,922 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 15:23:04,923 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 15:23:04,923 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 15:23:04,923 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 15:23:04,923 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 15:23:04,924 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 15:23:04,924 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 15:23:04,924 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 15:23:04,924 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 15:23:04,924 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 15:23:04,924 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:23:04,925 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 15:23:04,925 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:23:04,925 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 15:23:04,925 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 15:23:04,925 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:23:04,925 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 15:23:04,926 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:23:04,926 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 15:23:04,926 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 15:23:04,927 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 15:23:04,927 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 15:23:04,969 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 15:23:04,969 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 15:23:04,969 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 15:23:04,969 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 15:23:04,969 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 15:23:04,969 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 15:23:04,970 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 15:23:04,970 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 15:23:04,970 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 15:23:04,970 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 15:23:04,970 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 15:23:04,970 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 15:23:04,970 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 15:23:04,971 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 15:23:04,971 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 15:23:04,971 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 15:23:04,971 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 15:23:04,971 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 15:23:04,972 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 15:23:04,972 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 15:23:04,972 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 15:23:04,972 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 15:23:04,972 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 15:23:04,972 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 15:23:04,972 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 15:23:04,972 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 15:23:04,972 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:23:04,972 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 15:23:04,975 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 15:23:04,975 - ExcelTest - INFO - 处理结果统计:
2025-04-01 15:23:04,975 - ExcelTest - INFO -   customers: 3项
2025-04-01 15:23:04,975 - ExcelTest - INFO -   health_records: 3项
2025-04-01 15:23:04,975 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 15:23:04,975 - ExcelTest - INFO -   services: 30项
2025-04-01 15:23:04,976 - ExcelTest - INFO -   communications: 15项
2025-04-01 15:23:04,976 - ExcelTest - INFO - 客户数据示例:
2025-04-01 15:23:04,976 - ExcelTest - INFO -   id: C001
2025-04-01 15:23:04,976 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 15:23:04,976 - ExcelTest - INFO -   gender: 女
2025-04-01 15:23:04,976 - ExcelTest - INFO -   age: 28
2025-04-01 15:23:04,976 - ExcelTest - INFO -   store: 分店A
2025-04-01 15:23:04,976 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 15:23:04,976 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 15:23:04,976 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 15:23:04,976 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 15:23:04,977 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 15:23:04,977 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 15:23:04,977 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 15:23:04,977 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 15:23:04,977 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 15:23:04,977 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 15:23:04,977 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 15:23:04,977 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 15:23:04,977 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 15:23:04,977 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 15:23:04,977 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 15:23:04,977 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 15:23:04,978 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 15:23:04,978 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 15:47:58,530 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 15:47:58,530 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 15:47:58,702 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 15:47:58,702 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 15:47:58,702 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:47:58,702 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 15:47:58,702 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 15:47:58,702 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:47:58,703 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:47:58,913 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 15:47:58,913 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 15:47:58,913 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 15:47:58,913 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 15:47:58,913 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 15:47:58,914 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 15:47:58,920 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-01 15:47:58,920 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 15:47:58,920 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 15:47:58,921 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 15:47:58,921 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 15:47:58,921 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 15:47:58,923 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 15:47:58,923 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 15:47:58,923 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 15:47:58,923 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 15:47:58,923 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 15:47:58,924 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 15:47:58,924 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 15:47:58,924 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 15:47:58,924 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 15:47:58,925 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 15:47:58,925 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 15:47:58,925 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 15:47:58,925 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 15:47:58,925 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 15:47:58,926 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 15:47:58,926 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 15:47:58,927 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:47:58,927 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 15:47:58,928 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:47:58,928 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 15:47:58,928 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 15:47:58,928 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:47:58,928 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 15:47:58,929 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 15:47:58,929 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 15:47:58,929 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 15:47:58,929 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 15:47:58,929 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 15:47:58,929 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 15:47:58,929 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 15:47:58,930 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 15:47:58,930 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 15:47:58,930 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 15:47:58,931 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 15:47:58,931 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 15:47:58,971 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 15:47:58,972 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 15:47:58,972 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 15:47:58,972 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 15:47:58,972 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 15:47:58,972 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 15:47:58,972 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 15:47:58,972 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 15:47:58,973 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 15:47:58,973 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 15:47:58,973 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 15:47:58,973 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 15:47:58,974 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 15:47:58,974 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 15:47:58,974 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 15:47:58,974 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 15:47:58,975 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 15:47:58,976 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 15:47:58,976 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 15:47:58,976 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 15:47:58,976 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 15:47:58,979 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 15:47:58,979 - ExcelTest - INFO - 处理结果统计:
2025-04-01 15:47:58,979 - ExcelTest - INFO -   customers: 3项
2025-04-01 15:47:58,979 - ExcelTest - INFO -   health_records: 3项
2025-04-01 15:47:58,979 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 15:47:58,979 - ExcelTest - INFO -   services: 30项
2025-04-01 15:47:58,980 - ExcelTest - INFO -   communications: 15项
2025-04-01 15:47:58,980 - ExcelTest - INFO - 客户数据示例:
2025-04-01 15:47:58,980 - ExcelTest - INFO -   id: C001
2025-04-01 15:47:58,980 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 15:47:58,980 - ExcelTest - INFO -   gender: 女
2025-04-01 15:47:58,980 - ExcelTest - INFO -   age: 28
2025-04-01 15:47:58,980 - ExcelTest - INFO -   store: 分店A
2025-04-01 15:47:58,980 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 15:47:58,980 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 15:47:58,981 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 15:47:58,981 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 15:47:58,981 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 15:47:58,981 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 15:47:58,981 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 15:47:58,981 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 15:47:58,981 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 15:47:58,981 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 15:47:58,981 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 15:47:58,981 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 15:47:58,981 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 15:47:58,981 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 15:47:58,981 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 15:47:58,981 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 15:47:58,981 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 15:47:58,981 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 16:23:45,673 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 16:23:45,674 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 16:23:45,851 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 16:23:45,851 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 16:23:45,851 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 16:23:45,851 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 16:23:45,851 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 16:23:45,851 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 16:23:45,851 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 16:23:46,078 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 16:23:46,078 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 16:23:46,078 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 16:23:46,079 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 16:23:46,079 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 16:23:46,079 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 16:23:46,086 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-01 16:23:46,086 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 16:23:46,086 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 16:23:46,087 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 16:23:46,087 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 16:23:46,087 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 16:23:46,087 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 16:23:46,088 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 16:23:46,088 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 16:23:46,088 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 16:23:46,088 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 16:23:46,089 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 16:23:46,089 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 16:23:46,089 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 16:23:46,089 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 16:23:46,089 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 16:23:46,090 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 16:23:46,090 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 16:23:46,090 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 16:23:46,090 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 16:23:46,090 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 16:23:46,090 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 16:23:46,091 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 16:23:46,091 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 16:23:46,091 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 16:23:46,091 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 8次，设为None
2025-04-01 16:23:46,092 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 10次，设为None
2025-04-01 16:23:46,092 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 16:23:46,092 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 3次，设为None
2025-04-01 16:23:46,092 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 6次，设为None
2025-04-01 16:23:46,092 - utils.excel_processor - WARNING - 剩余次数值无法转换为整数: 5次，设为None
2025-04-01 16:23:46,092 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 16:23:46,092 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 16:23:46,092 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 16:23:46,093 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 16:23:46,093 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 16:23:46,093 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 16:23:46,093 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 16:23:46,093 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 16:23:46,093 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'satisfaction': '服务满意度'}
2025-04-01 16:23:46,093 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 16:23:46,134 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 16:23:46,135 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 16:23:46,135 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 16:23:46,135 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 16:23:46,135 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 16:23:46,135 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 16:23:46,135 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 16:23:46,136 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 16:23:46,136 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 16:23:46,136 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 16:23:46,136 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 16:23:46,136 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 16:23:46,137 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 16:23:46,137 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 16:23:46,137 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 16:23:46,137 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 16:23:46,137 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 16:23:46,137 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 16:23:46,137 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 16:23:46,137 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 16:23:46,137 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 16:23:46,140 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 16:23:46,140 - ExcelTest - INFO - 处理结果统计:
2025-04-01 16:23:46,140 - ExcelTest - INFO -   customers: 3项
2025-04-01 16:23:46,140 - ExcelTest - INFO -   health_records: 3项
2025-04-01 16:23:46,140 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 16:23:46,140 - ExcelTest - INFO -   services: 30项
2025-04-01 16:23:46,141 - ExcelTest - INFO -   communications: 15项
2025-04-01 16:23:46,141 - ExcelTest - INFO - 客户数据示例:
2025-04-01 16:23:46,141 - ExcelTest - INFO -   id: C001
2025-04-01 16:23:46,141 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 16:23:46,141 - ExcelTest - INFO -   gender: 女
2025-04-01 16:23:46,141 - ExcelTest - INFO -   age: 28
2025-04-01 16:23:46,141 - ExcelTest - INFO -   store: 分店A
2025-04-01 16:23:46,141 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 16:23:46,141 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 16:23:46,141 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 16:23:46,141 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 16:23:46,141 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 16:23:46,141 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 16:23:46,141 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 16:23:46,142 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 16:23:46,142 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 16:23:46,142 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 16:23:46,142 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 16:23:46,142 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 16:23:46,142 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 16:23:46,142 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 16:23:46,142 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 16:23:46,142 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 16:23:46,142 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 16:23:46,142 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:22:57,492 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:22:57,492 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:22:57,663 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:22:57,663 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:22:57,663 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:22:57,663 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:22:57,663 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:22:57,663 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:22:57,664 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:22:57,871 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:22:57,872 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:22:57,872 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:22:57,872 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:22:57,872 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:22:57,872 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:22:57,878 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-01 19:22:57,878 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:22:57,878 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:22:57,879 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:22:57,879 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:22:57,879 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:22:57,879 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:22:57,879 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:22:57,880 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:22:57,880 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:22:57,880 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:22:57,880 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:22:57,880 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:22:57,880 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:22:57,880 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:22:57,881 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:22:57,881 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:22:57,881 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:22:57,881 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:22:57,881 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:22:57,881 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:22:57,882 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:22:57,882 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:22:57,882 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:22:57,882 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:22:57,883 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:22:57,883 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:22:57,883 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:22:57,883 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:22:57,883 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:22:57,883 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:22:57,884 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:22:57,885 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,886 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,886 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,886 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,888 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,888 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,889 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,889 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,889 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,890 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,890 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,890 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,890 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,891 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,891 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,891 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,891 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,892 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,892 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,892 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,893 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,893 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,894 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,894 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,894 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,895 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,895 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,895 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,896 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,896 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,896 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,896 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,897 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,897 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,897 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,897 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,898 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,898 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,898 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,898 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,898 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,899 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,899 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,900 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,900 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,900 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,900 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,900 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,902 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,902 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,903 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,903 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,903 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,904 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,904 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,904 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,904 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,905 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,905 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,905 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,906 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,906 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,906 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,906 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,907 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,907 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,907 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,907 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,907 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,908 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,908 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,908 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,909 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,909 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,909 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,909 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,910 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,910 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,910 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,911 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,911 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,912 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,912 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,912 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,913 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,913 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,913 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,913 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,914 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,914 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,914 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,915 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,915 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,915 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,915 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,916 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,916 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,916 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,916 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,916 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,917 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,918 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,918 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,918 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,919 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,919 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,919 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,920 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,920 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,920 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,920 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,921 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,921 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,921 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,921 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,922 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,922 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,922 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,922 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,923 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,923 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,923 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,924 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,924 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,924 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,925 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,925 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,925 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,926 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,926 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,926 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,926 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,926 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,926 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,926 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,928 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,928 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,928 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,928 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,929 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,929 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,930 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,930 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,930 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,930 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,931 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,931 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,931 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,932 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,932 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:22:57,932 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:22:57,932 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:22:57,932 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:22:57,932 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:22:57,932 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:22:57,932 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:22:57,933 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:22:57,933 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:22:57,933 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:22:57,933 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:22:57,934 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:22:57,935 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:22:57,935 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:22:57,935 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:22:57,935 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:22:57,935 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:22:57,935 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:22:57,935 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:22:57,936 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:22:57,936 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:22:57,936 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:22:57,938 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:22:57,938 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:22:57,938 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:22:57,938 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:22:57,938 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:22:57,938 - ExcelTest - INFO -   services: 30项
2025-04-01 19:22:57,938 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:22:57,938 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:22:57,939 - ExcelTest - INFO -   id: C001
2025-04-01 19:22:57,939 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:22:57,939 - ExcelTest - INFO -   gender: 女
2025-04-01 19:22:57,939 - ExcelTest - INFO -   age: 28
2025-04-01 19:22:57,939 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:22:57,939 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:22:57,939 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:22:57,939 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:22:57,939 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:22:57,939 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:22:57,940 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:22:57,940 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:22:57,940 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:22:57,940 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:22:57,940 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:22:57,940 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:22:57,940 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:22:57,940 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:22:57,940 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:22:57,940 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:22:57,940 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:22:57,940 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:22:57,940 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:27:35,693 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:27:35,693 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:27:35,871 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:27:35,871 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:27:35,871 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:27:35,872 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:27:35,872 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:27:35,872 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:27:35,872 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:27:36,085 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:27:36,086 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:27:36,086 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:27:36,086 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:27:36,086 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:27:36,086 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:27:36,094 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 19:27:36,094 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:27:36,095 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:27:36,095 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:27:36,095 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:27:36,095 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:27:36,096 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:27:36,096 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:27:36,096 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:27:36,096 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:27:36,096 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:27:36,096 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:27:36,097 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:27:36,098 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:27:36,098 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:27:36,098 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:27:36,098 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:27:36,098 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:27:36,098 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:27:36,099 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:27:36,100 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:27:36,100 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:27:36,100 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:27:36,100 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:27:36,100 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,101 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,101 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,102 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,102 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,103 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,103 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,103 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,104 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,104 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,104 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,104 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,105 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,105 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,105 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,105 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,106 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,106 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,106 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,107 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,107 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,107 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,108 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,108 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,108 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,108 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,109 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,109 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,109 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,110 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,110 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,110 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,111 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,111 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,112 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,112 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,112 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,112 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,113 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,113 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,114 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,114 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,114 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,115 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,115 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,115 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,116 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,116 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,116 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,116 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,117 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,117 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,117 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,118 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,118 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,119 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,119 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,119 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,119 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,120 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,120 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,120 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,121 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,121 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,122 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,122 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,122 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,122 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,123 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,123 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,123 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,123 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,124 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,124 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,124 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,124 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,125 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,125 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,125 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,125 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,126 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,126 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,127 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,127 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,127 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,127 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,128 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,128 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,128 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,129 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,129 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,129 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,130 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,130 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,130 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,131 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,131 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,131 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,131 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,132 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,132 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,133 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,133 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,133 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,133 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,134 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,134 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,134 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,137 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,137 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,137 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,137 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,138 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,138 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,138 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,140 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,140 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,140 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,140 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,141 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,141 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,141 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,142 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,142 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,142 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,144 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,144 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,145 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,145 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,145 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:27:36,146 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:27:36,146 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:27:36,146 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:27:36,148 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:27:36,148 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:27:36,148 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:27:36,148 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:27:36,148 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:27:36,148 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:27:36,148 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:27:36,149 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:27:36,149 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:27:36,149 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:27:36,149 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:27:36,149 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:27:36,149 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:27:36,150 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:27:36,150 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:27:36,150 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:27:36,150 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:27:36,150 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:27:36,151 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:27:36,151 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:27:36,151 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:27:36,151 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:27:36,151 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:27:36,151 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:27:36,151 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:27:36,153 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:27:36,153 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:27:36,153 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:27:36,153 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:27:36,154 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:27:36,154 - ExcelTest - INFO -   services: 30项
2025-04-01 19:27:36,154 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:27:36,154 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:27:36,154 - ExcelTest - INFO -   id: C001
2025-04-01 19:27:36,154 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:27:36,154 - ExcelTest - INFO -   gender: 女
2025-04-01 19:27:36,154 - ExcelTest - INFO -   age: 28
2025-04-01 19:27:36,154 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:27:36,154 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:27:36,154 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:27:36,154 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:27:36,154 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:27:36,154 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:27:36,154 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:27:36,154 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:27:36,155 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:27:36,155 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:27:36,155 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:27:36,155 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:27:36,155 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:27:36,155 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:27:36,155 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:27:36,155 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:27:36,155 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:27:36,155 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:27:36,155 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:29:07,642 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:29:07,643 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:29:07,818 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:29:07,819 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:29:07,819 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:29:07,819 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:29:07,819 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:29:07,819 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:29:07,819 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:29:08,042 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:29:08,042 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:29:08,042 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:29:08,042 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:29:08,042 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:29:08,043 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:29:08,051 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 19:29:08,051 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:29:08,051 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:29:08,052 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:29:08,052 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:29:08,052 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:29:08,052 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:29:08,052 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:29:08,052 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:29:08,052 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:29:08,053 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:29:08,053 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:29:08,053 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:29:08,053 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:29:08,053 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:29:08,053 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:29:08,054 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:29:08,054 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:29:08,054 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:29:08,054 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:29:08,054 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:29:08,054 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:29:08,055 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:29:08,055 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:29:08,055 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:29:08,055 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:29:08,055 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:29:08,055 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:29:08,055 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:29:08,056 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:29:08,057 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:29:08,057 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:29:08,057 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:29:08,057 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,058 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,058 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,058 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,058 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,059 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,059 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,059 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,060 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,060 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,060 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,060 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,061 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,061 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,061 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,062 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,063 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,063 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,064 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,064 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,064 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,065 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,065 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,066 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,066 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,066 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,066 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,067 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,067 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,067 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,067 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,068 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,068 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,068 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,068 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,070 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,070 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,071 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,071 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,071 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,071 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,072 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,072 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,072 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,072 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,073 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,073 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,073 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,073 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,074 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,074 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,074 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,075 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,075 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,076 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,076 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,076 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,077 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,077 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,077 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,077 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,077 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,077 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,078 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,078 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,079 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,079 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,079 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,079 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,080 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,080 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,081 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,081 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,081 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,082 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,082 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,083 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,083 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,083 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,083 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,084 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,084 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,084 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,084 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,085 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,085 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,085 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,085 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,085 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,087 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,087 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,087 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,088 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,088 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,088 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,089 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,089 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,089 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,089 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,089 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,089 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,091 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,091 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,091 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,092 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,092 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,092 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,092 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,093 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,093 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,094 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,094 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,094 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,095 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,095 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,095 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,095 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,096 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,096 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,096 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,096 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,097 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,097 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,097 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,097 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,097 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,097 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,098 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,098 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,098 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,099 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,099 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,100 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,100 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,100 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,100 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,101 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,101 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,101 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,101 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,102 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,102 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,102 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,102 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,103 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,103 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,103 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,103 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,104 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,104 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:29:08,104 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:29:08,104 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:29:08,104 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:29:08,104 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:29:08,104 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:29:08,105 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:29:08,105 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:29:08,105 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:29:08,105 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:29:08,106 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:29:08,106 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:29:08,106 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:29:08,106 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:29:08,106 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:29:08,106 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:29:08,107 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:29:08,107 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:29:08,108 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:29:08,108 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:29:08,108 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:29:08,110 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:29:08,110 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:29:08,110 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:29:08,110 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:29:08,110 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:29:08,110 - ExcelTest - INFO -   services: 30项
2025-04-01 19:29:08,110 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:29:08,110 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:29:08,110 - ExcelTest - INFO -   id: C001
2025-04-01 19:29:08,110 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:29:08,111 - ExcelTest - INFO -   gender: 女
2025-04-01 19:29:08,111 - ExcelTest - INFO -   age: 28
2025-04-01 19:29:08,111 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:29:08,111 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:29:08,111 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:29:08,111 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:29:08,111 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:29:08,111 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:29:08,111 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:29:08,112 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:29:08,112 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:29:08,112 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:29:08,112 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:29:08,112 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:29:08,112 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:29:08,112 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:29:08,112 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:29:08,112 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:29:08,112 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:29:08,112 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:29:08,112 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:31:40,188 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:31:40,189 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:31:40,363 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:31:40,363 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:31:40,363 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:31:40,363 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:31:40,365 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:31:40,365 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:31:40,365 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:31:40,583 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:31:40,583 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:31:40,583 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:31:40,583 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:31:40,583 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:31:40,584 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:31:40,591 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 19:31:40,591 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:31:40,591 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:31:40,592 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:31:40,592 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:31:40,592 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:31:40,593 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:31:40,595 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:31:40,595 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:31:40,595 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:31:40,595 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:31:40,595 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:31:40,595 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:31:40,595 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:31:40,596 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:31:40,596 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:31:40,596 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:31:40,596 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:31:40,596 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:31:40,596 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:31:40,597 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:31:40,598 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:31:40,598 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:31:40,598 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:31:40,598 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:31:40,599 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,599 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,600 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,600 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,600 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,601 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,601 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,601 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,602 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,602 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,602 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,602 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,603 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,603 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,603 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,604 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,604 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,604 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,604 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,605 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,605 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,605 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,605 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,606 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,606 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,606 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,607 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,607 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,607 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,607 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,608 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,608 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,608 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,608 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,609 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,609 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,609 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,610 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,610 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,610 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,611 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,611 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,611 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,612 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,612 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,612 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,613 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,613 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,613 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,613 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,613 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,613 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,615 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,615 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,615 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,616 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,616 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,616 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,617 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,617 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,618 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,618 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,619 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,619 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,619 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,620 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,620 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,620 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,620 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,620 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,621 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,621 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,621 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,622 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,622 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,622 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,623 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,623 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,624 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,624 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,624 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,625 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,625 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,625 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,625 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,625 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,626 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,626 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,626 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,627 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,627 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,627 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,627 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,628 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,628 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,628 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,628 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,629 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,629 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,629 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,630 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,630 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,630 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,631 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,631 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,631 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,632 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,632 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,632 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,632 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,633 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,633 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,633 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,633 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,634 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,634 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,634 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,634 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,635 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,635 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,636 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,636 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,636 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,637 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,637 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,637 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,637 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,638 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,638 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,638 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,639 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,639 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,639 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,639 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,640 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,640 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,640 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,641 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,641 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,641 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,642 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,642 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,643 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,643 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,643 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,643 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,643 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,644 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,644 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,644 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:31:40,644 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:31:40,644 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:31:40,644 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:31:40,644 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:31:40,644 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:31:40,645 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:31:40,645 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:31:40,645 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:31:40,645 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:31:40,645 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:31:40,645 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:31:40,646 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:31:40,646 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:31:40,646 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:31:40,646 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:31:40,647 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:31:40,647 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:31:40,647 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:31:40,647 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:31:40,648 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:31:40,648 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:31:40,648 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:31:40,648 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:31:40,648 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:31:40,648 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:31:40,648 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:31:40,648 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:31:40,648 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:31:40,650 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:31:40,650 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:31:40,650 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:31:40,650 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:31:40,650 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:31:40,650 - ExcelTest - INFO -   services: 30项
2025-04-01 19:31:40,650 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:31:40,651 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:31:40,651 - ExcelTest - INFO -   id: C001
2025-04-01 19:31:40,651 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:31:40,651 - ExcelTest - INFO -   gender: 女
2025-04-01 19:31:40,651 - ExcelTest - INFO -   age: 28
2025-04-01 19:31:40,651 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:31:40,651 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:31:40,651 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:31:40,651 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:31:40,651 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:31:40,651 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:31:40,651 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:31:40,651 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:31:40,652 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:31:40,652 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:31:40,652 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:31:40,652 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:31:40,652 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:31:40,652 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:31:40,652 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:31:40,652 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:31:40,652 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:31:40,652 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:31:40,652 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:34:00,256 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:34:00,256 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:34:00,434 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:34:00,434 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:34:00,434 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:34:00,434 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:34:00,434 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:34:00,434 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:34:00,435 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:34:00,651 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:34:00,651 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:34:00,651 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:34:00,651 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:34:00,651 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:34:00,652 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:34:00,659 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-01 19:34:00,659 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:34:00,660 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:34:00,660 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:34:00,660 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:34:00,660 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:34:00,661 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:34:00,662 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:34:00,662 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:34:00,662 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:34:00,662 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:34:00,662 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:34:00,662 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:34:00,663 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:34:00,663 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:34:00,663 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:34:00,663 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:34:00,664 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:34:00,664 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:34:00,664 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:34:00,664 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:34:00,664 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:34:00,665 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:34:00,666 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,666 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,667 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,667 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,667 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,668 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,668 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,668 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,669 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,669 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,670 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,670 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,671 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,671 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,671 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,672 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,672 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,672 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,672 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,673 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,673 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,673 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,673 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,674 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,674 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,674 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,674 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,675 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,675 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,676 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,676 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,676 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,677 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,677 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,677 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,678 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,678 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,678 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,678 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,678 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,679 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,679 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,679 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,680 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,680 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,680 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,680 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,681 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,681 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,682 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,682 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,682 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,683 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,683 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,683 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,684 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,684 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,684 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,684 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,685 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,685 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,685 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,686 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,686 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,686 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,687 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,687 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,687 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,688 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,688 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,689 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,689 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,689 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,691 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,691 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,691 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,692 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,692 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,692 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,692 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,692 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,693 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,693 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,694 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,694 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,694 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,695 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,695 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,695 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,695 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,696 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,696 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,696 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,697 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,697 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,697 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,697 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,699 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,699 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,700 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,700 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,700 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,701 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,701 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,702 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,702 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,702 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,703 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,703 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,703 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,703 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,703 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,706 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,706 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,707 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,707 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,707 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,709 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,709 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,709 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,709 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,710 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,710 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,710 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,711 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,711 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,711 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,711 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,712 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,712 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,713 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,713 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,713 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:34:00,713 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:34:00,713 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:34:00,713 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:34:00,713 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:34:00,714 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:34:00,714 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:34:00,714 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:34:00,714 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:34:00,714 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:34:00,714 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:34:00,714 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:34:00,715 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:34:00,715 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:34:00,715 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:34:00,715 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:34:00,715 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:34:00,715 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:34:00,715 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:34:00,716 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:34:00,716 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:34:00,716 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:34:00,716 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:34:00,716 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:34:00,716 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:34:00,716 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:34:00,716 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:34:00,716 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:34:00,716 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:34:00,718 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:34:00,718 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:34:00,719 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:34:00,720 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:34:00,720 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:34:00,720 - ExcelTest - INFO -   services: 30项
2025-04-01 19:34:00,720 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:34:00,721 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:34:00,721 - ExcelTest - INFO -   id: C001
2025-04-01 19:34:00,724 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:34:00,724 - ExcelTest - INFO -   gender: 女
2025-04-01 19:34:00,725 - ExcelTest - INFO -   age: 28
2025-04-01 19:34:00,725 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:34:00,725 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:34:00,725 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:34:00,725 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:34:00,725 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:34:00,726 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:34:00,726 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:34:00,726 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:34:00,726 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:34:00,726 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:34:00,727 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:34:00,727 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:34:00,727 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:34:00,727 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:34:00,727 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:34:00,727 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:34:00,728 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:34:00,728 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:34:00,728 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:35:03,393 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:35:03,393 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:35:03,570 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:35:03,570 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:35:03,571 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:35:03,571 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:35:03,571 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:35:03,571 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:35:03,571 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:35:03,785 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:35:03,786 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:35:03,786 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:35:03,786 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:35:03,786 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:35:03,786 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:35:03,793 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 19:35:03,793 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:35:03,794 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:35:03,794 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:35:03,794 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:35:03,794 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:35:03,795 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:35:03,795 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:35:03,795 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:35:03,795 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:35:03,795 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:35:03,795 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:35:03,796 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:35:03,796 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:35:03,796 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:35:03,796 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:35:03,797 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:35:03,797 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:35:03,797 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:35:03,797 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:35:03,797 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:35:03,797 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:35:03,797 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:35:03,798 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:35:03,798 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:35:03,798 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:35:03,798 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:35:03,798 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:35:03,798 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:35:03,798 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:35:03,799 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:35:03,800 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:35:03,800 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:35:03,800 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,801 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,801 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,801 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,802 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,802 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,802 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,803 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,803 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,803 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,804 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,804 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,804 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,805 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,805 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,805 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,805 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,806 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,806 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,806 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,806 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,807 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,807 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,807 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,808 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,808 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,808 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,809 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,809 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,809 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,809 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,810 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,810 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,810 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,810 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,811 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,811 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,811 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,811 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,811 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,812 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,812 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,813 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,813 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,813 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,814 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,814 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,814 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,814 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,814 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,815 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,815 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,815 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,815 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,816 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,816 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,816 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,816 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,817 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,817 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,817 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,818 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,818 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,818 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,818 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,819 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,819 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,819 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,819 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,821 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,821 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,821 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,821 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,822 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,822 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,822 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,822 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,823 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,823 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,823 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,823 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,824 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,824 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,824 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,824 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,825 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,825 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,826 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,826 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,826 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,827 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,827 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,827 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,827 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,828 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,828 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,828 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,829 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,829 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,829 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,830 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,830 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,830 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,830 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,830 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,831 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,831 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,832 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,832 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,832 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,832 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,833 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,833 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,833 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,833 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,834 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,834 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,834 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,834 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,835 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,835 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,835 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,836 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,836 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,836 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,836 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,837 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,837 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,838 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,838 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,839 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,839 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,839 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,839 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,840 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,840 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,840 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,840 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,841 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,841 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,841 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,841 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,842 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,842 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,842 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,843 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,843 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,843 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,844 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,844 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:35:03,844 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:35:03,844 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:35:03,844 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:35:03,844 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:35:03,844 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:35:03,845 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:35:03,845 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:35:03,845 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:35:03,845 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:35:03,845 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:35:03,845 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:35:03,846 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:35:03,847 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:35:03,847 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:35:03,847 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:35:03,847 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:35:03,847 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:35:03,847 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:35:03,847 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:35:03,847 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:35:03,849 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:35:03,849 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:35:03,849 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:35:03,849 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:35:03,850 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:35:03,850 - ExcelTest - INFO -   services: 30项
2025-04-01 19:35:03,850 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:35:03,850 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:35:03,850 - ExcelTest - INFO -   id: C001
2025-04-01 19:35:03,850 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:35:03,850 - ExcelTest - INFO -   gender: 女
2025-04-01 19:35:03,850 - ExcelTest - INFO -   age: 28
2025-04-01 19:35:03,850 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:35:03,851 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:35:03,851 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:35:03,851 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:35:03,851 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:35:03,851 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:35:03,851 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:35:03,851 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:35:03,852 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:35:03,852 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:35:03,852 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:35:03,852 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:35:03,852 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:35:03,852 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:35:03,852 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:35:03,852 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:35:03,852 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:35:03,852 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:35:03,852 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:36:00,696 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:36:00,696 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:36:00,875 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:36:00,876 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:36:00,876 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:36:00,876 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:36:00,876 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:36:00,876 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:36:00,876 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:36:01,114 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:36:01,114 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:36:01,114 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:36:01,114 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:36:01,115 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:36:01,115 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:36:01,122 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-01 19:36:01,122 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:36:01,122 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:36:01,123 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:36:01,123 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:36:01,123 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:36:01,123 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:36:01,123 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:36:01,123 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:36:01,123 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:36:01,124 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:36:01,124 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:36:01,124 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:36:01,124 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:36:01,124 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:36:01,124 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:36:01,124 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:36:01,126 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:36:01,126 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:36:01,126 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:36:01,126 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:36:01,126 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:36:01,126 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:36:01,127 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:36:01,127 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:36:01,127 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:36:01,127 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:36:01,127 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:36:01,127 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:36:01,128 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:36:01,129 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:36:01,129 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:36:01,129 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,129 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,130 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,130 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,130 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,131 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,131 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,131 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,132 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,132 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,132 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,133 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,133 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,133 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,134 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,134 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,134 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,134 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,135 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,136 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,137 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,137 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,137 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,138 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,138 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,138 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,138 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,139 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,140 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,140 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,141 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,141 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,141 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,142 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,142 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,142 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,143 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,144 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,144 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,144 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,145 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,145 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,145 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,145 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,146 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,147 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,147 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,147 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,148 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,148 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,148 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,148 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,149 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,149 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,149 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,149 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,150 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,150 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,150 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,151 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,151 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,151 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,151 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,152 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,152 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,152 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,152 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,153 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,153 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,153 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,153 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,154 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,154 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,154 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,154 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,154 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,154 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,156 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,156 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,157 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,157 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,157 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,157 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,158 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,158 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,158 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,159 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,159 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,159 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,159 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,160 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,160 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,160 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,160 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,161 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,161 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,161 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,161 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,162 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,162 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,162 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,163 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,163 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,163 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,164 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,164 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,164 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,164 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,165 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,165 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,165 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,166 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,166 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,166 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,166 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,166 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,167 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,167 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,167 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,168 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,168 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,168 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,169 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,169 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,169 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,169 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,170 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,170 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,170 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,170 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,171 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,171 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,171 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:36:01,171 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:36:01,172 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:36:01,172 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:36:01,172 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:36:01,172 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:36:01,172 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:36:01,172 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:36:01,172 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:36:01,172 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:36:01,173 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:36:01,174 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:36:01,174 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:36:01,174 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:36:01,174 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:36:01,174 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:36:01,174 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:36:01,175 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:36:01,175 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:36:01,175 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:36:01,175 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:36:01,176 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:36:01,176 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:36:01,176 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:36:01,176 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:36:01,176 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:36:01,177 - ExcelTest - INFO -   services: 30项
2025-04-01 19:36:01,177 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:36:01,177 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:36:01,177 - ExcelTest - INFO -   id: C001
2025-04-01 19:36:01,177 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:36:01,177 - ExcelTest - INFO -   gender: 女
2025-04-01 19:36:01,177 - ExcelTest - INFO -   age: 28
2025-04-01 19:36:01,177 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:36:01,177 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:36:01,177 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:36:01,177 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:36:01,177 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:36:01,177 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:36:01,177 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:36:01,177 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:36:01,178 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:36:01,178 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:36:01,178 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:36:01,178 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:36:01,178 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:36:01,178 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:36:01,178 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:36:01,178 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:36:01,178 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:36:01,178 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:36:01,178 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-01 19:40:45,274 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-01 19:40:45,275 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-01 19:40:45,454 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-01 19:40:45,454 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-01 19:40:45,454 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:40:45,454 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-01 19:40:45,454 - ExcelTest - INFO - 开始调用process_file方法
2025-04-01 19:40:45,454 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:40:45,455 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:40:45,674 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-01 19:40:45,674 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-01 19:40:45,675 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-01 19:40:45,675 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-01 19:40:45,675 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-01 19:40:45,675 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-01 19:40:45,682 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-01 19:40:45,682 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:40:45,682 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-01 19:40:45,682 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-01 19:40:45,683 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-01 19:40:45,684 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-01 19:40:45,684 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:40:45,684 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-01 19:40:45,684 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-01 19:40:45,684 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-01 19:40:45,685 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-01 19:40:45,685 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-01 19:40:45,685 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-01 19:40:45,685 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-01 19:40:45,685 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-01 19:40:45,686 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:40:45,686 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:40:45,686 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:40:45,686 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-01 19:40:45,686 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-01 19:40:45,687 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-01 19:40:45,688 - utils.excel_processor - INFO - 第一行内容样本: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数']
2025-04-01 19:40:45,688 - utils.excel_processor - INFO - 第一行是标题行，将使用第一行作为列名
2025-04-01 19:40:45,688 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-01 19:40:45,688 - utils.excel_processor - INFO - 识别到的基础信息列: {'customer_id': '客户ID', 'service_date': '到店时间', 'departure_time': '离店时间', 'total_amount': '总耗卡金额', 'total_sessions': None, 'satisfaction': '服务满意度'}
2025-04-01 19:40:45,688 - utils.excel_processor - INFO - 识别到的项目消耗分组: [{'project': '总消耗项目数', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}, {'project': '项目内容', 'beautician': '操作美容师', 'amount': '耗卡金额', 'is_specified': '是否指定'}]
2025-04-01 19:40:45,689 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,690 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,691 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,691 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,691 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,691 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,692 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,692 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,693 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,693 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,693 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,693 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,694 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,694 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,694 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,695 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,695 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,695 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,696 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,696 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,697 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,697 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,697 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,698 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,699 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,699 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,699 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,700 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,700 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,700 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,700 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,701 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,701 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,701 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,702 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,702 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,702 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,702 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,703 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,703 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,704 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,705 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,705 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,705 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,706 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,706 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,706 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,706 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,707 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,707 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,707 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,707 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,708 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,709 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,710 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,710 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,710 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,711 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,711 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,711 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,712 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,712 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,712 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,713 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,713 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,713 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,714 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,714 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,714 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,714 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,715 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,715 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,715 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,716 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,716 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,716 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,717 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,717 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,717 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,718 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,718 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,718 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,718 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,718 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,719 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,719 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,719 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,719 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,720 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,720 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,720 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,720 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,721 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,721 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,721 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,722 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,722 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,723 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,723 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,723 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,723 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,724 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,724 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,724 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,725 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,725 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,725 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,725 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,726 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,726 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,726 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,726 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,727 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,727 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,728 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,728 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,728 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,729 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,729 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,730 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,730 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,731 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,731 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,731 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,732 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,732 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,732 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,733 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,733 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,733 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,733 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,734 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,734 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,734 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,735 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,735 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,735 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,736 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,736 - utils.excel_processor - ERROR - 处理项目组时出错: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-04-01 19:40:45,736 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录
2025-04-01 19:40:45,736 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-01 19:40:45,736 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-01 19:40:45,736 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-01 19:40:45,736 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-01 19:40:45,736 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:40:45,737 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-01 19:40:45,737 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-01 19:40:45,737 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-01 19:40:45,737 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-01 19:40:45,737 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-01 19:40:45,737 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-01 19:40:45,738 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-01 19:40:45,739 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-01 19:40:45,739 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-01 19:40:45,739 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-01 19:40:45,739 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-01 19:40:45,739 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-01 19:40:45,739 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-01 19:40:45,741 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-01 19:40:45,741 - ExcelTest - INFO - 处理结果统计:
2025-04-01 19:40:45,741 - ExcelTest - INFO -   customers: 3项
2025-04-01 19:40:45,741 - ExcelTest - INFO -   health_records: 3项
2025-04-01 19:40:45,741 - ExcelTest - INFO -   consumptions: 9项
2025-04-01 19:40:45,741 - ExcelTest - INFO -   services: 30项
2025-04-01 19:40:45,741 - ExcelTest - INFO -   communications: 15项
2025-04-01 19:40:45,742 - ExcelTest - INFO - 客户数据示例:
2025-04-01 19:40:45,742 - ExcelTest - INFO -   id: C001
2025-04-01 19:40:45,742 - ExcelTest - INFO -   name: 林晓薇
2025-04-01 19:40:45,742 - ExcelTest - INFO -   gender: 女
2025-04-01 19:40:45,742 - ExcelTest - INFO -   age: 28
2025-04-01 19:40:45,742 - ExcelTest - INFO -   store: 分店A
2025-04-01 19:40:45,742 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-01 19:40:45,742 - ExcelTest - INFO -   residence: 上海浦东
2025-04-01 19:40:45,742 - ExcelTest - INFO -   residence_years: 6年
2025-04-01 19:40:45,742 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-01 19:40:45,743 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-01 19:40:45,743 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-01 19:40:45,743 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-01 19:40:45,743 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-01 19:40:45,743 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-01 19:40:45,743 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-01 19:40:45,743 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-01 19:40:45,743 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-01 19:40:45,743 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-01 19:40:45,743 - ExcelTest - INFO -   family_medical_history: 无
2025-04-01 19:40:45,743 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-01 19:40:45,743 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-01 19:40:45,743 - ExcelTest - INFO -   annual_income: 35万
2025-04-01 19:40:45,744 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 19:50:37,252 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 19:50:37,252 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 19:50:37,428 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 19:50:37,428 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 19:50:37,428 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:50:37,428 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 19:50:37,429 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 19:50:37,429 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:50:37,429 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:50:37,645 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 19:50:37,645 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 19:50:37,646 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 19:50:37,646 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 19:50:37,646 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 19:50:37,646 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 19:50:37,654 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 19:50:37,654 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:50:37,655 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 19:50:37,655 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:50:37,655 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 19:50:37,655 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 19:50:37,656 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:50:37,657 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:50:37,657 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 19:50:37,657 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 19:50:37,657 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 19:50:37,657 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 19:50:37,658 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 19:50:37,658 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 19:50:37,658 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 19:50:37,658 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:50:37,659 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:50:37,660 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:50:37,660 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:50:37,660 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 19:50:37,660 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 19:50:37,660 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 19:50:37,660 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 19:50:37,661 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 19:50:37,661 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,661 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:50:37,661 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 19:50:37,661 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:50:37,661 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,661 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:50:37,662 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:50:37,663 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,663 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 19:50:37,663 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:50:37,663 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:50:37,663 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,663 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:50:37,663 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:50:37,664 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,664 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:50:37,664 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:50:37,664 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:50:37,664 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:50:37,665 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,666 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,667 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:50:37,668 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,668 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,668 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:50:37,668 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,668 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,668 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:50:37,668 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,669 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,669 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 19:50:37,670 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:50:37,672 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,673 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:50:37,673 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:50:37,673 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,673 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:50:37,673 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:50:37,673 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:50:37,674 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:50:37,675 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,675 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:50:37,675 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:50:37,675 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:50:37,675 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:50:37,675 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 19:50:37,676 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:50:37,676 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 19:50:37,676 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 19:50:37,676 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 19:50:37,676 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 19:50:37,676 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 19:50:37,676 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:50:37,677 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:50:37,677 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 19:50:37,677 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 19:50:37,677 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 19:50:37,677 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 19:50:37,677 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 19:50:37,678 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 19:50:37,678 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 19:50:37,678 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 19:50:37,678 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 19:50:37,678 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 19:50:37,678 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 19:50:37,678 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 19:50:37,679 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 19:50:37,679 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 19:50:37,679 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 19:50:37,679 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 19:50:37,679 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 19:50:37,679 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 19:50:37,679 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 19:50:37,679 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:50:37,680 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 19:50:37,682 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 19:50:37,682 - ExcelTest - INFO - 处理结果统计:
2025-04-03 19:50:37,682 - ExcelTest - INFO -   customers: 3项
2025-04-03 19:50:37,682 - ExcelTest - INFO -   health_records: 3项
2025-04-03 19:50:37,682 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 19:50:37,682 - ExcelTest - INFO -   services: 30项
2025-04-03 19:50:37,682 - ExcelTest - INFO -   communications: 15项
2025-04-03 19:50:37,682 - ExcelTest - INFO - 客户数据示例:
2025-04-03 19:50:37,682 - ExcelTest - INFO -   id: C001
2025-04-03 19:50:37,682 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 19:50:37,682 - ExcelTest - INFO -   gender: 女
2025-04-03 19:50:37,682 - ExcelTest - INFO -   age: 28
2025-04-03 19:50:37,682 - ExcelTest - INFO -   store: 分店A
2025-04-03 19:50:37,683 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 19:50:37,683 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 19:50:37,683 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 19:50:37,683 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 19:50:37,683 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 19:50:37,683 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 19:50:37,683 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 19:50:37,683 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 19:50:37,683 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 19:50:37,683 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 19:50:37,683 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 19:50:37,683 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 19:50:37,683 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 19:50:37,683 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 19:50:37,684 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 19:50:37,684 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 19:50:37,684 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 19:50:37,684 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 19:52:08,834 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 19:52:08,835 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 19:52:09,013 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 19:52:09,013 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 19:52:09,013 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:52:09,013 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 19:52:09,014 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 19:52:09,014 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:52:09,014 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:52:09,229 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 19:52:09,229 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 19:52:09,229 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 19:52:09,230 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 19:52:09,230 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 19:52:09,230 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 19:52:09,238 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 19:52:09,238 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:52:09,238 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 19:52:09,239 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:52:09,239 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 19:52:09,239 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 19:52:09,239 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 19:52:09,239 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:52:09,240 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 19:52:09,242 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 19:52:09,242 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 19:52:09,242 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 19:52:09,242 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 19:52:09,242 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 19:52:09,242 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 19:52:09,243 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:52:09,244 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:52:09,244 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:52:09,244 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:52:09,244 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 19:52:09,244 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 19:52:09,244 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 19:52:09,245 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 19:52:09,245 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 19:52:09,245 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,246 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:52:09,246 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 19:52:09,246 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:52:09,246 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,246 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:52:09,246 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:52:09,247 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,247 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:52:09,247 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 19:52:09,247 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:52:09,247 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,247 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:52:09,248 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:52:09,248 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,248 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 19:52:09,248 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:52:09,248 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:52:09,248 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,248 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:52:09,249 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:52:09,249 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,249 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:52:09,249 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:52:09,249 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:52:09,249 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,250 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:52:09,250 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 19:52:09,250 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:52:09,250 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,250 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:52:09,250 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 19:52:09,250 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:52:09,252 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:52:09,252 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:52:09,252 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:52:09,252 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,252 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 19:52:09,252 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,253 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,253 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:52:09,253 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,253 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,253 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 19:52:09,254 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:52:09,254 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:52:09,254 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,254 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:52:09,254 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,254 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,255 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:52:09,255 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,255 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,255 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:52:09,255 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,255 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,255 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:52:09,256 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,256 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,256 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:52:09,256 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,256 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,257 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:52:09,257 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:52:09,257 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:52:09,257 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:52:09,257 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:52:09,257 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:52:09,258 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,258 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 19:52:09,258 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:52:09,258 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,258 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:52:09,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:52:09,259 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,259 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:52:09,259 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 19:52:09,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:52:09,259 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,259 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:52:09,260 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:52:09,260 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,260 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:52:09,260 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:52:09,260 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,260 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:52:09,260 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:52:09,261 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 19:52:09,262 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 19:52:09,263 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 19:52:09,263 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 19:52:09,263 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 19:52:09,263 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:52:09,263 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:52:09,263 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 19:52:09,264 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 19:52:09,264 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 19:52:09,264 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 19:52:09,264 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 19:52:09,264 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 19:52:09,265 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 19:52:09,266 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 19:52:09,266 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 19:52:09,266 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 19:52:09,266 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 19:52:09,266 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 19:52:09,266 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:52:09,267 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 19:52:09,268 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 19:52:09,269 - ExcelTest - INFO - 处理结果统计:
2025-04-03 19:52:09,269 - ExcelTest - INFO -   customers: 3项
2025-04-03 19:52:09,269 - ExcelTest - INFO -   health_records: 3项
2025-04-03 19:52:09,269 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 19:52:09,269 - ExcelTest - INFO -   services: 30项
2025-04-03 19:52:09,269 - ExcelTest - INFO -   communications: 15项
2025-04-03 19:52:09,269 - ExcelTest - INFO - 客户数据示例:
2025-04-03 19:52:09,269 - ExcelTest - INFO -   id: C001
2025-04-03 19:52:09,269 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 19:52:09,269 - ExcelTest - INFO -   gender: 女
2025-04-03 19:52:09,270 - ExcelTest - INFO -   age: 28
2025-04-03 19:52:09,270 - ExcelTest - INFO -   store: 分店A
2025-04-03 19:52:09,270 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 19:52:09,270 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 19:52:09,270 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 19:52:09,270 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 19:52:09,270 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 19:52:09,270 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 19:52:09,270 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 19:52:09,270 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 19:52:09,270 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 19:52:09,270 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 19:52:09,271 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 19:52:09,271 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 19:52:09,271 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 19:52:09,271 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 19:52:09,271 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 19:52:09,271 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 19:52:09,271 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 19:52:09,271 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 19:53:43,877 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 19:53:43,878 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 19:53:44,058 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 19:53:44,059 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 19:53:44,059 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:53:44,059 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 19:53:44,059 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 19:53:44,059 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:53:44,059 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:53:44,276 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 19:53:44,276 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 19:53:44,276 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 19:53:44,276 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 19:53:44,276 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 19:53:44,277 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 19:53:44,284 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 19:53:44,285 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:53:44,285 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 19:53:44,285 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:53:44,286 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 19:53:44,286 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 19:53:44,286 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 19:53:44,286 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 19:53:44,286 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 19:53:44,287 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 19:53:44,287 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 19:53:44,287 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 19:53:44,287 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 19:53:44,287 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:53:44,287 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:53:44,288 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 19:53:44,288 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 19:53:44,288 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 19:53:44,288 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 19:53:44,288 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 19:53:44,288 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 19:53:44,289 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 19:53:44,289 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:53:44,289 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:53:44,289 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:53:44,289 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:53:44,290 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 19:53:44,291 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 19:53:44,291 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 19:53:44,291 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 19:53:44,291 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 19:53:44,292 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,293 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:53:44,293 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 19:53:44,293 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:53:44,293 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,293 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:53:44,294 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,295 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 19:53:44,295 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:53:44,295 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:53:44,295 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,295 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:53:44,295 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:53:44,295 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:53:44,296 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 19:53:44,297 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:53:44,297 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:53:44,297 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:53:44,297 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:53:44,297 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,297 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 19:53:44,298 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,298 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,298 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:53:44,298 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,298 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,299 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 19:53:44,299 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:53:44,299 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:53:44,299 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,299 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:53:44,299 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,299 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,300 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:53:44,300 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,300 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,300 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:53:44,300 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,300 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,301 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:53:44,301 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,301 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,301 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:53:44,301 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,301 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,301 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:53:44,302 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,303 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:53:44,303 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:53:44,303 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,303 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:53:44,303 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 19:53:44,304 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:53:44,304 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,304 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:53:44,304 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:53:44,304 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:53:44,305 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:53:44,306 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 19:53:44,307 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:53:44,308 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:53:44,308 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 19:53:44,308 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 19:53:44,308 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 19:53:44,308 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 19:53:44,308 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 19:53:44,309 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 19:53:44,309 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 19:53:44,309 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 19:53:44,309 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 19:53:44,309 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 19:53:44,309 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 19:53:44,310 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 19:53:44,310 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 19:53:44,310 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 19:53:44,310 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 19:53:44,311 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 19:53:44,311 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 19:53:44,311 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 19:53:44,311 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 19:53:44,311 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:53:44,311 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 19:53:44,313 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 19:53:44,313 - ExcelTest - INFO - 处理结果统计:
2025-04-03 19:53:44,313 - ExcelTest - INFO -   customers: 3项
2025-04-03 19:53:44,313 - ExcelTest - INFO -   health_records: 3项
2025-04-03 19:53:44,313 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 19:53:44,313 - ExcelTest - INFO -   services: 30项
2025-04-03 19:53:44,313 - ExcelTest - INFO -   communications: 15项
2025-04-03 19:53:44,313 - ExcelTest - INFO - 客户数据示例:
2025-04-03 19:53:44,313 - ExcelTest - INFO -   id: C001
2025-04-03 19:53:44,313 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 19:53:44,313 - ExcelTest - INFO -   gender: 女
2025-04-03 19:53:44,313 - ExcelTest - INFO -   age: 28
2025-04-03 19:53:44,313 - ExcelTest - INFO -   store: 分店A
2025-04-03 19:53:44,313 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 19:53:44,313 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 19:53:44,315 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 19:53:44,315 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 19:53:44,315 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 19:53:44,315 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 19:53:44,315 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 19:53:44,315 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 19:53:44,315 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 19:53:44,315 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 19:53:44,315 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 19:53:44,315 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 19:53:44,315 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 19:53:44,315 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 19:53:44,315 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 19:53:44,315 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 19:53:44,315 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 19:53:44,316 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 19:59:07,580 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 19:59:07,580 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 19:59:07,760 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 19:59:07,761 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 19:59:07,761 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:59:07,761 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 19:59:07,761 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 19:59:07,761 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:59:07,761 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:59:07,980 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 19:59:07,980 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 19:59:07,980 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 19:59:07,980 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 19:59:07,980 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 19:59:07,981 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 19:59:07,988 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 19:59:07,988 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:59:07,988 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 19:59:07,988 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 19:59:07,989 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 19:59:07,989 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 19:59:07,989 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 19:59:07,989 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 19:59:07,989 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 19:59:07,990 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 19:59:07,990 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 19:59:07,990 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 19:59:07,990 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 19:59:07,991 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:59:07,991 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 19:59:07,991 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 19:59:07,991 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 19:59:07,992 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 19:59:07,992 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 19:59:07,992 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 19:59:07,992 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 19:59:07,992 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 19:59:07,992 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:59:07,992 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 19:59:07,993 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:59:07,994 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 19:59:07,994 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 19:59:07,994 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 19:59:07,994 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 19:59:07,994 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 19:59:07,994 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 19:59:07,994 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,995 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:59:07,996 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 19:59:07,996 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:59:07,996 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,996 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:59:07,996 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:59:07,997 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,998 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:07,999 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:08,000 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:08,001 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,002 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 19:59:08,003 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:08,003 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,003 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:59:08,003 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 19:59:08,003 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 19:59:08,003 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 19:59:08,004 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 19:59:08,004 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 19:59:08,004 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,004 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 19:59:08,004 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:59:08,004 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:59:08,005 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:59:08,006 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,006 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:59:08,006 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:59:08,006 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,006 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:59:08,006 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:59:08,007 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,007 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 19:59:08,007 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:59:08,007 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,007 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 19:59:08,007 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 19:59:08,008 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:59:08,008 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,008 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 19:59:08,008 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 19:59:08,008 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 19:59:08,008 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 19:59:08,009 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 19:59:08,010 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 19:59:08,010 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 19:59:08,010 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 19:59:08,010 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 19:59:08,010 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 19:59:08,011 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 19:59:08,012 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 19:59:08,012 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 19:59:08,012 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 19:59:08,012 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 19:59:08,012 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 19:59:08,012 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 19:59:08,014 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 19:59:08,014 - ExcelTest - INFO - 处理结果统计:
2025-04-03 19:59:08,014 - ExcelTest - INFO -   customers: 3项
2025-04-03 19:59:08,014 - ExcelTest - INFO -   health_records: 3项
2025-04-03 19:59:08,014 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 19:59:08,015 - ExcelTest - INFO -   services: 30项
2025-04-03 19:59:08,015 - ExcelTest - INFO -   communications: 15项
2025-04-03 19:59:08,015 - ExcelTest - INFO - 客户数据示例:
2025-04-03 19:59:08,015 - ExcelTest - INFO -   id: C001
2025-04-03 19:59:08,015 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 19:59:08,015 - ExcelTest - INFO -   gender: 女
2025-04-03 19:59:08,015 - ExcelTest - INFO -   age: 28
2025-04-03 19:59:08,015 - ExcelTest - INFO -   store: 分店A
2025-04-03 19:59:08,015 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 19:59:08,015 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 19:59:08,015 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 19:59:08,015 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 19:59:08,015 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 19:59:08,015 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 19:59:08,016 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 19:59:08,016 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 19:59:08,016 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 19:59:08,016 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 19:59:08,016 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 19:59:08,016 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 19:59:08,016 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 19:59:08,016 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 19:59:08,016 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 19:59:08,016 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 19:59:08,016 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 19:59:08,016 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:04:58,103 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:04:58,103 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:04:58,271 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:04:58,271 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:04:58,271 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:04:58,271 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:04:58,271 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:04:58,271 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:04:58,271 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:04:58,483 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:04:58,483 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:04:58,483 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:04:58,483 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:04:58,483 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:04:58,484 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:04:58,491 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2  ...  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别  ...    职业        单位性质         年收入
1  C001        林晓薇          女  ...  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:04:58,491 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:04:58,491 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:04:58,492 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:04:58,492 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:04:58,493 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:04:58,493 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:04:58,493 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:04:58,493 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:04:58,494 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:04:58,494 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:04:58,494 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:04:58,494 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:04:58,494 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:04:58,494 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:04:58,495 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:04:58,496 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:04:58,496 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:04:58,496 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:04:58,496 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:04:58,497 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:04:58,497 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:04:58,498 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:04:58,499 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:04:58,499 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:04:58,499 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:04:58,500 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:04:58,500 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:04:58,501 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:04:58,501 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:04:58,502 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:04:58,502 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:04:58,502 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:04:58,502 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:04:58,502 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:04:58,502 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:04:58,502 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:04:58,504 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:04:58,504 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,504 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:04:58,504 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:04:58,504 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:04:58,505 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,506 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:04:58,507 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:04:58,507 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,507 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:04:58,507 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:04:58,507 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:04:58,507 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,508 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:04:58,508 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:04:58,508 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:04:58,508 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,509 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:04:58,509 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:04:58,509 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:04:58,509 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:04:58,509 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:04:58,509 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:04:58,509 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:04:58,510 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,511 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:04:58,512 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,512 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,512 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:04:58,512 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,512 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,512 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:04:58,513 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:04:58,513 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:04:58,513 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:04:58,513 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:04:58,513 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:04:58,513 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,514 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:04:58,514 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:04:58,514 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,514 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:04:58,514 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:04:58,515 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,515 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:04:58,515 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:04:58,515 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:04:58,515 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,515 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:04:58,515 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:04:58,516 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,516 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:04:58,516 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:04:58,516 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,516 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:04:58,517 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:04:58,518 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:04:58,519 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:04:58,519 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:04:58,519 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:04:58,520 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:04:58,520 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:04:58,520 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:04:58,520 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:04:58,520 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:04:58,521 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:04:58,521 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:04:58,521 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:04:58,521 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:04:58,521 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:04:58,521 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:04:58,522 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:04:58,522 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:04:58,522 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:04:58,522 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:04:58,522 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:04:58,522 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:04:58,522 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:04:58,522 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:04:58,522 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:04:58,524 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:04:58,524 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:04:58,524 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:04:58,524 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:04:58,525 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:04:58,525 - ExcelTest - INFO -   services: 30项
2025-04-03 20:04:58,525 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:04:58,525 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:04:58,525 - ExcelTest - INFO -   id: C001
2025-04-03 20:04:58,525 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:04:58,525 - ExcelTest - INFO -   gender: 女
2025-04-03 20:04:58,525 - ExcelTest - INFO -   age: 28
2025-04-03 20:04:58,525 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:04:58,526 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:04:58,526 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:04:58,526 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:04:58,526 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:04:58,526 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:04:58,526 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:04:58,526 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:04:58,526 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:04:58,526 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:04:58,526 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:04:58,526 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:04:58,527 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:04:58,527 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:04:58,527 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:04:58,527 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:04:58,527 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:04:58,527 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:04:58,527 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:10:19,577 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:10:19,578 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:10:19,756 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:10:19,756 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:10:19,757 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:10:19,757 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:10:19,757 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:10:19,757 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:10:19,757 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:10:19,974 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:10:19,974 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:10:19,974 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:10:19,974 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:10:19,974 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:10:19,975 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:10:19,982 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:10:19,982 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:10:19,983 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:10:19,983 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:10:19,983 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:10:19,983 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:10:19,984 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:10:19,984 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:10:19,984 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:10:19,984 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:10:19,984 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:10:19,984 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:10:19,984 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:10:19,985 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:10:19,986 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:10:19,986 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:10:19,986 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:10:19,986 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:10:19,986 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:10:19,987 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:10:19,987 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:10:19,987 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:10:19,987 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:10:19,987 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:10:19,988 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:10:19,988 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:10:19,988 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:10:19,988 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:10:19,988 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:10:19,989 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:10:19,989 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:10:19,989 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,989 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:10:19,989 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:10:19,990 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:10:19,990 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,990 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:10:19,990 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:10:19,990 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,990 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:10:19,990 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:10:19,991 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:10:19,992 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,992 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:10:19,992 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:10:19,992 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,992 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:10:19,992 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:10:19,992 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:10:19,993 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:10:19,994 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:10:19,994 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:10:19,994 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,994 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:10:19,994 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,995 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,995 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:10:19,995 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,995 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,995 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:10:19,996 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:10:19,996 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:10:19,996 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,996 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:10:19,996 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,996 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,997 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:10:19,997 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,997 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,997 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:10:19,997 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,997 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,998 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:10:19,998 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,998 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,998 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:10:19,998 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,998 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,999 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:10:19,999 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:10:19,999 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:10:19,999 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:10:19,999 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:10:19,999 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:10:19,999 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,000 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:10:20,000 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:10:20,000 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:10:20,001 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,003 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:10:20,003 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:10:20,003 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,003 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:10:20,003 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:10:20,004 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:10:20,005 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:10:20,006 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:10:20,006 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:10:20,006 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:10:20,006 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:10:20,007 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:10:20,007 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:10:20,007 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:10:20,007 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:10:20,007 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:10:20,008 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:10:20,008 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:10:20,008 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:10:20,008 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:10:20,008 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:10:20,008 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:10:20,009 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:10:20,009 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:10:20,009 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:10:20,009 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:10:20,009 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:10:20,009 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:10:20,009 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:10:20,009 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:10:20,011 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:10:20,011 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:10:20,011 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:10:20,011 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:10:20,012 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:10:20,012 - ExcelTest - INFO -   services: 30项
2025-04-03 20:10:20,012 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:10:20,012 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:10:20,012 - ExcelTest - INFO -   id: C001
2025-04-03 20:10:20,012 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:10:20,012 - ExcelTest - INFO -   gender: 女
2025-04-03 20:10:20,012 - ExcelTest - INFO -   age: 28
2025-04-03 20:10:20,012 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:10:20,013 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:10:20,013 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:10:20,013 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:10:20,013 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:10:20,013 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:10:20,013 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:10:20,013 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:10:20,013 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:10:20,013 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:10:20,013 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:10:20,014 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:10:20,014 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:10:20,014 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:10:20,014 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:10:20,014 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:10:20,014 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:10:20,014 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:10:20,014 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:13:13,841 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:13:13,842 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:13:14,018 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:13:14,018 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:13:14,019 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:13:14,019 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:13:14,019 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:13:14,019 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:13:14,019 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:13:14,236 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:13:14,236 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:13:14,236 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:13:14,236 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:13:14,236 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:13:14,237 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:13:14,244 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:13:14,244 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:13:14,245 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:13:14,245 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:13:14,245 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:13:14,245 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:13:14,245 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:13:14,245 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:13:14,245 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:13:14,246 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:13:14,246 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:13:14,246 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:13:14,246 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:13:14,246 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:13:14,246 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:13:14,247 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:13:14,247 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:13:14,247 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:13:14,247 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:13:14,247 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:13:14,248 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:13:14,248 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:13:14,248 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:13:14,248 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:13:14,249 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:13:14,249 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:13:14,249 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:13:14,249 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:13:14,249 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:13:14,249 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:13:14,249 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:13:14,250 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:13:14,251 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,253 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:13:14,253 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:13:14,253 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:13:14,253 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,254 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:13:14,254 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:13:14,254 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,254 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:13:14,254 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:13:14,254 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:13:14,255 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,255 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:13:14,255 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:13:14,255 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:13:14,255 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,256 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:13:14,256 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:13:14,256 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:13:14,256 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:13:14,256 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:13:14,256 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:13:14,256 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,257 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:13:14,257 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,257 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,257 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:13:14,257 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,258 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:13:14,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,259 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,259 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:13:14,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,259 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,260 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:13:14,260 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,260 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,260 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:13:14,261 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:13:14,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:13:14,263 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,263 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:13:14,263 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:13:14,263 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,263 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:13:14,263 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:13:14,263 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,264 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:13:14,264 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:13:14,264 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,264 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:13:14,264 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:13:14,264 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,265 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:13:14,265 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:13:14,265 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:13:14,265 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,266 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:13:14,266 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:13:14,266 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:13:14,266 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:13:14,266 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:13:14,266 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:13:14,266 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:13:14,267 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:13:14,267 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:13:14,267 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:13:14,267 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:13:14,267 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:13:14,267 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:13:14,267 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:13:14,267 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:13:14,268 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:13:14,268 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:13:14,268 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:13:14,268 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:13:14,268 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:13:14,269 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:13:14,269 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:13:14,269 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:13:14,269 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:13:14,269 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:13:14,269 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:13:14,269 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:13:14,270 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:13:14,270 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:13:14,270 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:13:14,270 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:13:14,270 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:13:14,270 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:13:14,270 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:13:14,272 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:13:14,273 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:13:14,273 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:13:14,273 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:13:14,273 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:13:14,273 - ExcelTest - INFO -   services: 30项
2025-04-03 20:13:14,273 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:13:14,274 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:13:14,274 - ExcelTest - INFO -   id: C001
2025-04-03 20:13:14,274 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:13:14,274 - ExcelTest - INFO -   gender: 女
2025-04-03 20:13:14,274 - ExcelTest - INFO -   age: 28
2025-04-03 20:13:14,274 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:13:14,274 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:13:14,274 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:13:14,274 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:13:14,274 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:13:14,274 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:13:14,274 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:13:14,274 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:13:14,274 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:13:14,274 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:13:14,274 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:13:14,275 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:13:14,275 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:13:14,275 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:13:14,275 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:13:14,275 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:13:14,275 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:13:14,275 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:13:14,275 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:21:43,656 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:21:43,656 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:21:43,836 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:21:43,837 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:21:43,837 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:21:43,837 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:21:43,837 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:21:43,837 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:21:43,837 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:21:44,124 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:21:44,124 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:21:44,124 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:21:44,124 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:21:44,124 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:21:44,125 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:21:44,133 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:21:44,134 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:21:44,135 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:21:44,135 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:21:44,135 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:21:44,135 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:21:44,135 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:21:44,135 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:21:44,136 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:21:44,136 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:21:44,136 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:21:44,136 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:21:44,136 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:21:44,136 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:21:44,136 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:21:44,137 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:21:44,138 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:21:44,138 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:21:44,138 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:21:44,138 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:21:44,138 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:21:44,138 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:21:44,138 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:21:44,139 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,139 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:21:44,139 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,139 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:21:44,139 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:21:44,139 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:21:44,139 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:21:44,140 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:21:44,141 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:21:44,142 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:21:44,143 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:21:44,144 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:21:44,145 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:21:44,146 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,147 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:21:44,147 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,147 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,147 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:21:44,147 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:21:44,147 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,148 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,148 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,148 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,148 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:21:44,148 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:21:44,148 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,148 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,149 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,149 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:21:44,149 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,149 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:21:44,149 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:21:44,149 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:21:44,149 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,150 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:21:44,150 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,150 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,150 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,150 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,151 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,152 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,152 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:21:44,152 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:21:44,152 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,152 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,152 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,152 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,153 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:21:44,154 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:21:44,155 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:21:44,156 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,156 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:21:44,156 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,156 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,156 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,156 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:21:44,157 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:21:44,158 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:21:44,159 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:21:44,160 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:21:44,161 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:21:44,162 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:21:44,162 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:21:44,162 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:21:44,162 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:21:44,163 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:21:44,164 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:21:44,164 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:21:44,164 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:21:44,164 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:21:44,164 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:21:44,164 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:21:44,165 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:21:44,166 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:21:44,166 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:21:44,166 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:21:44,166 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:21:44,166 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:21:44,166 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:21:44,166 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:21:44,166 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:21:44,169 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:21:44,169 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:21:44,169 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:21:44,169 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:21:44,169 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:21:44,170 - ExcelTest - INFO -   services: 30项
2025-04-03 20:21:44,170 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:21:44,170 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:21:44,170 - ExcelTest - INFO -   id: C001
2025-04-03 20:21:44,170 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:21:44,170 - ExcelTest - INFO -   gender: 女
2025-04-03 20:21:44,170 - ExcelTest - INFO -   age: 28
2025-04-03 20:21:44,170 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:21:44,170 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:21:44,170 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:21:44,170 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:21:44,170 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:21:44,171 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:21:44,171 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:21:44,171 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:21:44,171 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:21:44,171 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:21:44,171 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:21:44,171 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:21:44,171 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:21:44,171 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:21:44,171 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:21:44,171 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:21:44,171 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:21:44,171 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:21:44,171 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:31:47,720 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:31:47,721 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:31:47,898 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:31:47,898 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:31:47,899 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:31:47,899 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:31:47,899 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:31:47,899 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:31:47,899 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:31:48,115 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:31:48,115 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:31:48,115 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:31:48,116 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:31:48,116 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:31:48,116 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:31:48,123 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:31:48,123 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:31:48,123 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:31:48,125 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:31:48,125 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:31:48,125 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:31:48,126 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:31:48,126 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:31:48,126 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:31:48,126 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:31:48,126 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:31:48,126 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:31:48,126 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:31:48,127 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:31:48,128 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:31:48,128 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:31:48,128 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:31:48,128 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:31:48,129 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:31:48,130 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:31:48,131 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:31:48,131 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,131 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:31:48,131 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,131 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,131 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,131 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:31:48,132 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,132 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:31:48,132 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,132 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:31:48,132 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:31:48,132 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:31:48,132 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:31:48,133 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:31:48,134 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,135 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:31:48,135 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,135 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:31:48,135 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,135 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:31:48,135 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,136 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:31:48,137 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,137 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:31:48,137 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:31:48,137 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:31:48,137 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:31:48,138 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,139 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,139 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:31:48,139 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:31:48,139 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,139 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,139 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,139 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:31:48,140 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,141 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,142 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:31:48,144 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:31:48,144 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,144 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,144 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,144 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:31:48,145 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:31:48,146 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,147 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:31:48,148 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,149 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:31:48,150 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:31:48,150 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,150 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:31:48,150 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,151 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:31:48,152 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:31:48,153 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:31:48,154 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:31:48,154 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:31:48,154 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:31:48,154 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:31:48,154 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:31:48,155 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:31:48,155 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:31:48,155 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:31:48,155 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:31:48,156 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:31:48,156 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:31:48,156 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:31:48,157 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:31:48,157 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:31:48,157 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:31:48,157 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:31:48,157 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:31:48,157 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:31:48,157 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:31:48,157 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:31:48,158 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:31:48,160 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:31:48,160 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:31:48,160 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:31:48,160 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:31:48,160 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:31:48,160 - ExcelTest - INFO -   services: 30项
2025-04-03 20:31:48,160 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:31:48,160 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:31:48,160 - ExcelTest - INFO -   id: C001
2025-04-03 20:31:48,160 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:31:48,161 - ExcelTest - INFO -   gender: 女
2025-04-03 20:31:48,161 - ExcelTest - INFO -   age: 28
2025-04-03 20:31:48,161 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:31:48,161 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:31:48,161 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:31:48,161 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:31:48,161 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:31:48,161 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:31:48,161 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:31:48,161 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:31:48,162 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:31:48,162 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:31:48,162 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:31:48,162 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:31:48,162 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:31:48,162 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:31:48,162 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:31:48,162 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:31:48,162 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:31:48,162 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:31:48,162 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:43:34,054 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:43:34,054 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:43:34,234 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:43:34,234 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:43:34,235 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:43:34,235 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:43:34,235 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:43:34,235 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:43:34,235 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:43:34,452 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:43:34,452 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:43:34,452 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:43:34,452 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:43:34,452 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:43:34,453 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:43:34,461 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:43:34,461 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:43:34,462 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:43:34,462 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:43:34,462 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:43:34,462 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:43:34,463 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:43:34,464 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:43:34,464 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:43:34,464 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:43:34,464 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:43:34,464 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:43:34,464 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:43:34,464 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:43:34,465 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:43:34,467 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:43:34,468 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,469 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:43:34,470 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,470 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,470 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:43:34,470 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:43:34,470 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,470 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:43:34,470 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,471 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:43:34,472 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:43:34,473 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:43:34,474 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,475 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,475 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,475 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,475 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:43:34,475 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:43:34,475 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,475 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:43:34,476 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,477 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,478 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,479 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:43:34,480 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:43:34,481 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,481 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:43:34,481 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:43:34,481 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,481 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:43:34,481 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:43:34,482 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:43:34,483 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:43:34,484 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,485 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:43:34,486 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:43:34,487 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,487 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:43:34,487 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,487 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:43:34,487 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:43:34,487 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:43:34,488 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:43:34,489 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:43:34,489 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:43:34,490 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:43:34,490 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:43:34,490 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:43:34,490 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:43:34,490 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:43:34,490 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:43:34,490 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:43:34,491 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:43:34,491 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:43:34,491 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:43:34,492 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:43:34,492 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:43:34,494 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:43:34,494 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:43:34,494 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:43:34,494 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:43:34,494 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:43:34,494 - ExcelTest - INFO -   services: 30项
2025-04-03 20:43:34,494 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:43:34,494 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:43:34,494 - ExcelTest - INFO -   id: C001
2025-04-03 20:43:34,494 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:43:34,495 - ExcelTest - INFO -   gender: 女
2025-04-03 20:43:34,495 - ExcelTest - INFO -   age: 28
2025-04-03 20:43:34,495 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:43:34,495 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:43:34,495 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:43:34,495 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:43:34,495 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:43:34,495 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:43:34,495 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:43:34,495 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:43:34,495 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:43:34,495 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:43:34,495 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:43:34,495 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:43:34,495 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:43:34,496 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:43:34,496 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:43:34,496 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:43:34,496 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:43:34,496 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:43:34,496 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:45:32,177 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:45:32,177 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:45:32,358 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:45:32,358 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:45:32,358 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:45:32,358 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:45:32,358 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:45:32,358 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:45:32,359 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:45:32,573 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:45:32,573 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:45:32,573 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:45:32,573 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:45:32,573 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:45:32,574 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:45:32,581 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:45:32,582 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:45:32,582 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:45:32,582 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:45:32,582 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:45:32,583 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:45:32,583 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:45:32,583 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:45:32,583 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:45:32,583 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:45:32,583 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:45:32,583 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:45:32,584 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:45:32,584 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:45:32,584 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:45:32,584 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:45:32,585 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:45:32,585 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:45:32,585 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:45:32,585 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:45:32,585 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:45:32,586 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:45:32,586 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:45:32,586 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:45:32,586 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:45:32,586 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:45:32,587 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:45:32,588 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:45:32,588 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:45:32,588 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:45:32,588 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,589 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:45:32,589 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,589 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:45:32,589 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:45:32,589 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:45:32,590 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,591 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:45:32,592 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,593 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:45:32,594 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:45:32,594 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:45:32,594 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,594 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:45:32,595 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,595 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:45:32,595 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,595 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:45:32,595 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:45:32,595 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:45:32,595 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,596 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:45:32,596 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,596 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:45:32,596 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:45:32,596 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:45:32,597 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:45:32,597 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:45:32,597 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,597 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:45:32,597 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:45:32,597 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,597 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,598 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,599 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:45:32,600 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,601 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,601 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,601 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,601 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:45:32,601 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:45:32,601 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,601 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,602 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,602 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,602 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:45:32,602 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:45:32,602 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,602 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,602 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,603 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,604 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:45:32,605 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:45:32,605 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:45:32,605 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:45:32,605 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:45:32,605 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,605 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:45:32,605 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,606 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:45:32,607 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,607 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,607 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,607 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:45:32,607 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,607 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:45:32,607 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,608 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:45:32,608 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:45:32,608 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:45:32,608 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,608 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:45:32,608 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,608 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:45:32,609 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:45:32,610 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:45:32,611 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:45:32,612 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:45:32,613 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:45:32,613 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:45:32,613 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:45:32,614 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:45:32,615 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:45:32,615 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:45:32,615 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:45:32,615 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:45:32,615 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:45:32,615 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:45:32,616 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:45:32,616 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:45:32,616 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:45:32,616 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:45:32,616 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:45:32,616 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:45:32,616 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:45:32,617 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:45:32,617 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:45:32,617 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:45:32,617 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:45:32,617 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:45:32,617 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:45:32,617 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:45:32,617 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:45:32,617 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:45:32,619 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:45:32,620 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:45:32,620 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:45:32,620 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:45:32,620 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:45:32,620 - ExcelTest - INFO -   services: 30项
2025-04-03 20:45:32,620 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:45:32,620 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:45:32,620 - ExcelTest - INFO -   id: C001
2025-04-03 20:45:32,621 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:45:32,621 - ExcelTest - INFO -   gender: 女
2025-04-03 20:45:32,621 - ExcelTest - INFO -   age: 28
2025-04-03 20:45:32,621 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:45:32,621 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:45:32,621 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:45:32,621 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:45:32,621 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:45:32,621 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:45:32,621 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:45:32,621 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:45:32,621 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:45:32,621 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:45:32,621 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:45:32,621 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:45:32,621 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:45:32,622 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:45:32,622 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:45:32,622 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:45:32,622 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:45:32,622 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:45:32,622 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:51:09,850 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:51:09,851 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:51:10,027 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:51:10,027 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:51:10,027 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:51:10,028 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:51:10,028 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:51:10,028 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:51:10,028 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:51:10,241 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:51:10,241 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:51:10,241 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:51:10,241 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:51:10,241 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:51:10,242 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:51:10,250 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:51:10,250 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:51:10,250 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:51:10,250 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:51:10,250 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:51:10,251 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:51:10,252 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:51:10,252 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:51:10,252 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:51:10,252 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:51:10,253 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:51:10,254 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:51:10,255 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:51:10,256 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:51:10,257 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:51:10,258 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,258 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:51:10,258 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,258 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:51:10,258 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,258 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:51:10,258 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:51:10,259 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:51:10,260 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,261 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:51:10,261 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:51:10,261 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:51:10,261 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,261 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:51:10,261 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,261 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:51:10,262 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,263 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:51:10,264 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,265 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,266 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,267 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:51:10,268 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,269 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:51:10,269 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,269 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,269 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:51:10,269 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:51:10,269 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,269 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:51:10,270 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,270 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,270 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,270 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:51:10,270 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,270 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:51:10,270 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,271 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,272 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,273 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:51:10,274 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:51:10,276 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:51:10,276 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:51:10,276 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:51:10,276 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:51:10,276 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:51:10,276 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:51:10,276 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:51:10,277 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:51:10,277 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:51:10,277 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:51:10,277 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:51:10,277 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:51:10,277 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:51:10,277 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:51:10,278 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:51:10,278 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:51:10,278 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:51:10,278 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:51:10,278 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:51:10,279 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:51:10,280 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:51:10,280 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:51:10,280 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:51:10,280 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:51:10,280 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:51:10,280 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:51:10,280 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:51:10,280 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:51:10,280 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:51:10,282 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:51:10,283 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:51:10,283 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:51:10,283 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:51:10,283 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:51:10,283 - ExcelTest - INFO -   services: 30项
2025-04-03 20:51:10,283 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:51:10,283 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:51:10,283 - ExcelTest - INFO -   id: C001
2025-04-03 20:51:10,283 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:51:10,283 - ExcelTest - INFO -   gender: 女
2025-04-03 20:51:10,283 - ExcelTest - INFO -   age: 28
2025-04-03 20:51:10,284 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:51:10,284 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:51:10,284 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:51:10,284 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:51:10,284 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:51:10,284 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:51:10,284 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:51:10,284 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:51:10,284 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:51:10,284 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:51:10,284 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:51:10,284 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:51:10,284 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:51:10,284 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:51:10,284 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:51:10,284 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:51:10,284 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:51:10,285 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:51:10,285 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:53:09,966 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:53:09,966 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:53:10,136 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:53:10,137 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:53:10,137 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:53:10,137 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:53:10,137 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:53:10,137 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:53:10,137 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:53:10,347 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:53:10,347 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:53:10,347 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:53:10,348 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:53:10,348 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:53:10,348 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:53:10,356 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2  ...  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别  ...    职业        单位性质         年收入
1  C001        林晓薇          女  ...  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:53:10,356 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:53:10,356 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:53:10,356 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:53:10,357 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:53:10,357 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:53:10,357 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:53:10,357 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:53:10,357 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:53:10,358 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:53:10,358 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:53:10,358 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:53:10,358 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:53:10,358 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:53:10,358 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:53:10,359 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:53:10,359 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:53:10,359 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:53:10,359 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:53:10,359 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:53:10,360 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:53:10,361 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:53:10,361 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:53:10,361 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:53:10,362 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:53:10,362 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:53:10,362 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:53:10,362 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:53:10,362 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:53:10,363 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,364 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:53:10,365 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,366 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:53:10,366 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,366 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:53:10,366 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:53:10,367 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,368 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:53:10,369 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:53:10,370 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:53:10,371 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:53:10,372 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,372 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,372 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:53:10,373 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,373 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:53:10,373 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,373 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,373 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:53:10,373 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:53:10,373 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,374 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,375 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,376 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,377 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,378 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,378 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,378 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:53:10,378 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,378 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,378 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,379 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,380 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:53:10,381 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,382 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,383 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:53:10,385 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,385 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,385 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,385 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:53:10,385 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,385 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:53:10,386 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,386 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:53:10,386 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:53:10,386 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:53:10,386 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:53:10,386 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:53:10,386 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:53:10,387 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:53:10,388 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:53:10,389 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:53:10,389 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:53:10,389 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:53:10,389 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:53:10,389 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:53:10,389 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:53:10,389 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:53:10,390 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:53:10,390 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:53:10,390 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:53:10,390 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:53:10,390 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:53:10,391 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:53:10,391 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:53:10,391 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:53:10,392 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:53:10,392 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:53:10,392 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:53:10,392 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:53:10,392 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:53:10,394 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:53:10,394 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:53:10,394 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:53:10,394 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:53:10,395 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:53:10,395 - ExcelTest - INFO -   services: 30项
2025-04-03 20:53:10,395 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:53:10,395 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:53:10,395 - ExcelTest - INFO -   id: C001
2025-04-03 20:53:10,395 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:53:10,395 - ExcelTest - INFO -   gender: 女
2025-04-03 20:53:10,395 - ExcelTest - INFO -   age: 28
2025-04-03 20:53:10,395 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:53:10,395 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:53:10,395 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:53:10,395 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:53:10,395 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:53:10,395 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:53:10,395 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:53:10,395 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:53:10,395 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:53:10,395 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:53:10,396 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:53:10,396 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:53:10,396 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:53:10,396 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:53:10,396 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:53:10,396 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:53:10,396 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:53:10,396 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:53:10,397 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:56:55,181 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:56:55,181 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:56:55,361 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:56:55,361 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:56:55,361 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:56:55,361 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:56:55,361 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:56:55,362 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:56:55,362 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:56:55,577 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:56:55,577 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:56:55,577 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:56:55,578 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:56:55,578 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:56:55,578 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:56:55,585 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:56:55,586 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:56:55,586 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:56:55,586 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:56:55,586 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:56:55,587 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:56:55,588 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:56:55,588 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:56:55,588 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:56:55,589 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:56:55,589 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:56:55,589 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:56:55,589 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:56:55,589 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:56:55,590 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:56:55,590 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:56:55,590 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:56:55,590 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:56:55,590 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:56:55,590 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:56:55,591 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,592 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:56:55,593 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,593 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,593 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,593 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:56:55,593 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,593 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:56:55,593 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,594 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:56:55,594 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:56:55,594 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:56:55,594 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,594 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:56:55,594 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,595 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:56:55,595 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,595 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,595 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:56:55,595 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:56:55,595 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,595 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:56:55,596 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:56:55,597 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:56:55,598 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:56:55,599 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,600 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,600 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:56:55,600 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,600 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:56:55,600 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,600 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,600 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:56:55,601 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:56:55,602 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,603 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,604 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,605 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,605 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,605 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:56:55,605 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,605 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,605 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,606 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,607 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,608 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,609 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:56:55,610 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:56:55,611 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,611 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:56:55,611 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,611 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,611 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,611 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:56:55,612 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,612 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:56:55,612 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,612 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:56:55,612 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:56:55,612 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:56:55,612 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:56:55,613 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:56:55,615 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:56:55,616 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:56:55,616 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:56:55,616 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:56:55,616 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:56:55,616 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:56:55,616 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:56:55,616 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:56:55,617 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:56:55,618 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:56:55,618 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:56:55,618 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:56:55,618 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:56:55,620 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:56:55,620 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:56:55,620 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:56:55,620 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:56:55,621 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:56:55,621 - ExcelTest - INFO -   services: 30项
2025-04-03 20:56:55,621 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:56:55,621 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:56:55,621 - ExcelTest - INFO -   id: C001
2025-04-03 20:56:55,621 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:56:55,621 - ExcelTest - INFO -   gender: 女
2025-04-03 20:56:55,621 - ExcelTest - INFO -   age: 28
2025-04-03 20:56:55,621 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:56:55,621 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:56:55,621 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:56:55,621 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:56:55,621 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:56:55,621 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:56:55,622 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:56:55,622 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:56:55,622 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:56:55,622 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:56:55,622 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:56:55,622 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:56:55,622 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:56:55,622 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:56:55,622 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:56:55,622 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:56:55,623 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:56:55,623 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:56:55,623 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 20:58:35,481 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 20:58:35,482 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 20:58:35,663 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 20:58:35,663 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 20:58:35,663 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:58:35,663 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 20:58:35,663 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 20:58:35,663 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:58:35,663 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:58:35,878 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 20:58:35,878 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 20:58:35,878 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 20:58:35,878 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 20:58:35,878 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 20:58:35,879 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 20:58:35,887 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 20:58:35,887 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:58:35,887 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 20:58:35,887 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 20:58:35,888 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 20:58:35,888 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 20:58:35,888 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 20:58:35,888 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 20:58:35,888 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 20:58:35,888 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 20:58:35,889 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 20:58:35,889 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 20:58:35,889 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 20:58:35,889 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:58:35,889 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 20:58:35,889 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 20:58:35,890 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 20:58:35,890 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 20:58:35,890 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 20:58:35,890 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 20:58:35,890 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 20:58:35,891 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 20:58:35,891 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:58:35,891 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:58:35,891 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:58:35,891 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 20:58:35,892 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:58:35,893 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:58:35,894 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,895 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 20:58:35,895 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,895 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:58:35,895 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,895 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,895 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:58:35,896 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:58:35,896 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,896 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:58:35,896 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,896 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:58:35,896 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,897 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:58:35,898 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,899 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,900 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,901 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,901 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,901 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:58:35,901 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:58:35,901 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,901 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,901 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,902 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:58:35,902 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,902 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 20:58:35,902 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:58:35,902 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 20:58:35,902 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:58:35,903 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,905 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 20:58:35,906 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 20:58:35,907 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,908 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 20:58:35,908 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 20:58:35,908 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,909 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 20:58:35,909 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 20:58:35,909 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,909 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 20:58:35,909 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,909 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,909 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:58:35,910 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 20:58:35,910 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,910 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:58:35,910 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,910 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,910 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,910 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:58:35,911 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:58:35,912 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,913 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,914 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,914 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 20:58:35,914 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,914 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:58:35,914 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,914 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 20:58:35,915 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 20:58:35,916 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 20:58:35,917 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 20:58:35,917 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 20:58:35,918 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 20:58:35,918 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 20:58:35,918 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 20:58:35,918 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 20:58:35,918 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 20:58:35,918 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 20:58:35,919 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 20:58:35,919 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 20:58:35,920 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 20:58:35,920 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 20:58:35,920 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 20:58:35,922 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 20:58:35,922 - ExcelTest - INFO - 处理结果统计:
2025-04-03 20:58:35,922 - ExcelTest - INFO -   customers: 3项
2025-04-03 20:58:35,922 - ExcelTest - INFO -   health_records: 3项
2025-04-03 20:58:35,922 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 20:58:35,923 - ExcelTest - INFO -   services: 30项
2025-04-03 20:58:35,923 - ExcelTest - INFO -   communications: 15项
2025-04-03 20:58:35,923 - ExcelTest - INFO - 客户数据示例:
2025-04-03 20:58:35,923 - ExcelTest - INFO -   id: C001
2025-04-03 20:58:35,923 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 20:58:35,923 - ExcelTest - INFO -   gender: 女
2025-04-03 20:58:35,923 - ExcelTest - INFO -   age: 28
2025-04-03 20:58:35,923 - ExcelTest - INFO -   store: 分店A
2025-04-03 20:58:35,923 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 20:58:35,923 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 20:58:35,923 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 20:58:35,923 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 20:58:35,923 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 20:58:35,923 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 20:58:35,923 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 20:58:35,924 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 20:58:35,924 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 20:58:35,924 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 20:58:35,924 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 20:58:35,924 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 20:58:35,924 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 20:58:35,924 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 20:58:35,924 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 20:58:35,924 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 20:58:35,924 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 20:58:35,924 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 21:31:20,743 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 21:31:20,743 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 21:31:20,907 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 21:31:20,907 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 21:31:20,908 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:31:20,908 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 21:31:20,908 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 21:31:20,908 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:31:20,908 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:31:21,117 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 21:31:21,117 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 21:31:21,117 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 21:31:21,118 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 21:31:21,118 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 21:31:21,118 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 21:31:21,125 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-03 21:31:21,125 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:31:21,125 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 21:31:21,126 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:31:21,126 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 21:31:21,126 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 21:31:21,126 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 21:31:21,127 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 21:31:21,127 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 21:31:21,127 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 21:31:21,127 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 21:31:21,127 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 21:31:21,127 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 21:31:21,128 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:31:21,128 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:31:21,129 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 21:31:21,129 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 21:31:21,129 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 21:31:21,129 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 21:31:21,129 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 21:31:21,129 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 21:31:21,130 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 21:31:21,130 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:31:21,130 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:31:21,130 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:31:21,131 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 21:31:21,131 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 21:31:21,131 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:31:21,131 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 21:31:21,131 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:31:21,131 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:31:21,131 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 21:31:21,132 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,133 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:31:21,133 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:31:21,133 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 21:31:21,133 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,133 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:31:21,133 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,133 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,134 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,134 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:31:21,134 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,134 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:31:21,134 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,134 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:31:21,135 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:31:21,135 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:31:21,135 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,135 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 21:31:21,135 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,135 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:31:21,135 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,136 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,136 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:31:21,136 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:31:21,136 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,136 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:31:21,136 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,136 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:31:21,137 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,137 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 21:31:21,137 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:31:21,137 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:31:21,137 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,137 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:31:21,138 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,138 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,138 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,138 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:31:21,138 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:31:21,139 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,140 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:31:21,140 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,140 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:31:21,140 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,141 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:31:21,141 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:31:21,141 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 21:31:21,141 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,141 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:31:21,141 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,142 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,143 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,144 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,145 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,146 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:31:21,146 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:31:21,146 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,146 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,146 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,146 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,147 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:31:21,147 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:31:21,147 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,147 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,147 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,147 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,147 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,148 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,149 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,149 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 21:31:21,149 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:31:21,149 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:31:21,149 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:31:21,149 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:31:21,149 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:31:21,150 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,151 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:31:21,152 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,152 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:31:21,152 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:31:21,152 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,153 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:31:21,155 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:31:21,156 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 21:31:21,157 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 21:31:21,158 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 21:31:21,158 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 21:31:21,158 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 21:31:21,158 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:31:21,158 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:31:21,158 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 21:31:21,159 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 21:31:21,159 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 21:31:21,159 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 21:31:21,159 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 21:31:21,159 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 21:31:21,160 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 21:31:21,160 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 21:31:21,160 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 21:31:21,160 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 21:31:21,160 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 21:31:21,160 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 21:31:21,161 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 21:31:21,161 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 21:31:21,161 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 21:31:21,161 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 21:31:21,161 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 21:31:21,161 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 21:31:21,161 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 21:31:21,161 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:31:21,161 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 21:31:21,163 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 21:31:21,163 - ExcelTest - INFO - 处理结果统计:
2025-04-03 21:31:21,163 - ExcelTest - INFO -   customers: 3项
2025-04-03 21:31:21,164 - ExcelTest - INFO -   health_records: 3项
2025-04-03 21:31:21,164 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 21:31:21,164 - ExcelTest - INFO -   services: 30项
2025-04-03 21:31:21,164 - ExcelTest - INFO -   communications: 15项
2025-04-03 21:31:21,164 - ExcelTest - INFO - 客户数据示例:
2025-04-03 21:31:21,164 - ExcelTest - INFO -   id: C001
2025-04-03 21:31:21,164 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 21:31:21,164 - ExcelTest - INFO -   gender: 女
2025-04-03 21:31:21,165 - ExcelTest - INFO -   age: 28
2025-04-03 21:31:21,165 - ExcelTest - INFO -   store: 分店A
2025-04-03 21:31:21,165 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 21:31:21,165 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 21:31:21,165 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 21:31:21,165 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 21:31:21,166 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 21:31:21,166 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 21:31:21,166 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 21:31:21,166 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 21:31:21,166 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 21:31:21,166 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 21:31:21,166 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 21:31:21,166 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 21:31:21,166 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 21:31:21,166 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 21:31:21,166 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 21:31:21,168 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 21:31:21,168 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 21:31:21,168 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 21:33:38,064 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 21:33:38,064 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 21:33:38,233 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 21:33:38,234 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 21:33:38,234 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:33:38,234 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 21:33:38,234 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 21:33:38,234 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:33:38,234 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:33:38,439 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 21:33:38,439 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 21:33:38,439 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 21:33:38,439 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 21:33:38,439 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 21:33:38,440 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 21:33:38,446 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-03 21:33:38,446 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:33:38,446 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 21:33:38,447 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:33:38,447 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 21:33:38,447 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 21:33:38,447 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 21:33:38,448 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 21:33:38,448 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 21:33:38,448 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 21:33:38,448 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 21:33:38,448 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 21:33:38,448 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 21:33:38,449 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 21:33:38,451 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:33:38,451 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:33:38,451 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:33:38,451 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 21:33:38,451 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 21:33:38,452 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 21:33:38,453 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 21:33:38,453 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 21:33:38,453 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,453 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 21:33:38,453 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,454 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:33:38,455 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,456 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,456 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:33:38,456 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:33:38,456 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,456 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:33:38,456 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,457 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:33:38,457 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,457 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 21:33:38,457 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:33:38,457 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:33:38,457 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,457 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,458 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:33:38,459 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:33:38,459 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:33:38,459 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,459 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:33:38,459 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,459 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:33:38,460 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,460 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:33:38,460 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:33:38,460 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 21:33:38,460 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,460 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,461 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:33:38,462 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 21:33:38,463 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,464 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:33:38,465 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,466 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,466 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,466 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,466 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:33:38,466 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:33:38,466 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,466 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,467 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,467 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,467 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:33:38,467 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:33:38,467 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,467 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,467 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,468 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,468 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:33:38,468 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:33:38,468 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,468 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,468 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 21:33:38,469 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,470 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,471 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:33:38,472 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,472 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:33:38,472 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,472 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:33:38,472 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:33:38,472 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:33:38,472 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,473 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,474 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:33:38,475 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:33:38,476 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 21:33:38,477 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 21:33:38,478 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 21:33:38,478 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 21:33:38,478 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:33:38,478 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:33:38,478 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 21:33:38,479 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 21:33:38,480 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 21:33:38,480 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 21:33:38,480 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 21:33:38,480 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 21:33:38,480 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 21:33:38,480 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 21:33:38,480 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 21:33:38,481 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 21:33:38,481 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 21:33:38,481 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 21:33:38,481 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:33:38,481 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 21:33:38,483 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 21:33:38,483 - ExcelTest - INFO - 处理结果统计:
2025-04-03 21:33:38,483 - ExcelTest - INFO -   customers: 3项
2025-04-03 21:33:38,483 - ExcelTest - INFO -   health_records: 3项
2025-04-03 21:33:38,483 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 21:33:38,483 - ExcelTest - INFO -   services: 30项
2025-04-03 21:33:38,483 - ExcelTest - INFO -   communications: 15项
2025-04-03 21:33:38,484 - ExcelTest - INFO - 客户数据示例:
2025-04-03 21:33:38,484 - ExcelTest - INFO -   id: C001
2025-04-03 21:33:38,484 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 21:33:38,484 - ExcelTest - INFO -   gender: 女
2025-04-03 21:33:38,484 - ExcelTest - INFO -   age: 28
2025-04-03 21:33:38,484 - ExcelTest - INFO -   store: 分店A
2025-04-03 21:33:38,484 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 21:33:38,484 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 21:33:38,485 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 21:33:38,485 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 21:33:38,485 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 21:33:38,485 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 21:33:38,485 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 21:33:38,485 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 21:33:38,485 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 21:33:38,485 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 21:33:38,485 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 21:33:38,485 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 21:33:38,485 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 21:33:38,486 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 21:33:38,486 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 21:33:38,486 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 21:33:38,486 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 21:33:38,486 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 21:37:48,999 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 21:37:48,999 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 21:37:49,169 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 21:37:49,169 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 21:37:49,170 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:37:49,170 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 21:37:49,170 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 21:37:49,170 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:37:49,170 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:37:49,380 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 21:37:49,380 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 21:37:49,380 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 21:37:49,380 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 21:37:49,380 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 21:37:49,380 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 21:37:49,388 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-03 21:37:49,388 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:37:49,388 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 21:37:49,388 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 21:37:49,389 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 21:37:49,390 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 21:37:49,390 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:37:49,390 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:37:49,390 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 21:37:49,391 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 21:37:49,391 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 21:37:49,391 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 21:37:49,391 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 21:37:49,391 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 21:37:49,391 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 21:37:49,392 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:37:49,392 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:37:49,392 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:37:49,392 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 21:37:49,393 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 21:37:49,393 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:37:49,393 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 21:37:49,393 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 21:37:49,394 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:37:49,395 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,396 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,396 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,396 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:37:49,396 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,396 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:37:49,396 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:37:49,397 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,398 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,398 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:37:49,398 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:37:49,398 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,398 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:37:49,399 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,399 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:37:49,399 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,399 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 21:37:49,399 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:37:49,399 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:37:49,400 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,400 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:37:49,400 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,400 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,400 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,400 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:37:49,401 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,402 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:37:49,402 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:37:49,402 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 21:37:49,402 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,402 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:37:49,402 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,402 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,403 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,404 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:37:49,405 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:37:49,407 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,408 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,409 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,409 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,409 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:37:49,409 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:37:49,410 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,410 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,410 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,410 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,410 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,410 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:37:49,411 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:37:49,412 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,412 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:37:49,412 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:37:49,412 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,412 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:37:49,412 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,412 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:37:49,413 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:37:49,414 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,415 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,415 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,415 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:37:49,415 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,415 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,416 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,417 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:37:49,418 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:37:49,419 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:37:49,420 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:37:49,421 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 21:37:49,421 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 21:37:49,421 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 21:37:49,421 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 21:37:49,422 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 21:37:49,422 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 21:37:49,422 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 21:37:49,422 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 21:37:49,423 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 21:37:49,423 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 21:37:49,423 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 21:37:49,423 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 21:37:49,423 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 21:37:49,423 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 21:37:49,424 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 21:37:49,424 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 21:37:49,424 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 21:37:49,424 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 21:37:49,424 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 21:37:49,424 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:37:49,424 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 21:37:49,426 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 21:37:49,426 - ExcelTest - INFO - 处理结果统计:
2025-04-03 21:37:49,426 - ExcelTest - INFO -   customers: 3项
2025-04-03 21:37:49,426 - ExcelTest - INFO -   health_records: 3项
2025-04-03 21:37:49,426 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 21:37:49,426 - ExcelTest - INFO -   services: 30项
2025-04-03 21:37:49,426 - ExcelTest - INFO -   communications: 15项
2025-04-03 21:37:49,427 - ExcelTest - INFO - 客户数据示例:
2025-04-03 21:37:49,427 - ExcelTest - INFO -   id: C001
2025-04-03 21:37:49,427 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 21:37:49,427 - ExcelTest - INFO -   gender: 女
2025-04-03 21:37:49,427 - ExcelTest - INFO -   age: 28
2025-04-03 21:37:49,427 - ExcelTest - INFO -   store: 分店A
2025-04-03 21:37:49,427 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 21:37:49,427 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 21:37:49,427 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 21:37:49,427 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 21:37:49,428 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 21:37:49,428 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 21:37:49,428 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 21:37:49,428 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 21:37:49,428 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 21:37:49,428 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 21:37:49,428 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 21:37:49,428 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 21:37:49,429 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 21:37:49,429 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 21:37:49,429 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 21:37:49,429 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 21:37:49,429 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 21:37:49,429 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 21:39:20,011 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 21:39:20,011 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 21:39:20,178 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 21:39:20,179 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 21:39:20,179 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:39:20,179 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 21:39:20,179 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 21:39:20,179 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:39:20,179 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:39:20,385 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 21:39:20,385 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 21:39:20,385 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 21:39:20,385 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 21:39:20,387 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 21:39:20,387 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 21:39:20,393 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-03 21:39:20,394 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:39:20,394 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 21:39:20,394 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:39:20,394 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 21:39:20,395 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 21:39:20,396 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:39:20,396 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:39:20,396 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 21:39:20,397 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 21:39:20,397 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 21:39:20,397 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 21:39:20,397 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 21:39:20,397 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 21:39:20,398 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 21:39:20,398 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:39:20,398 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:39:20,399 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,400 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,401 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:39:20,402 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,402 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:39:20,402 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,403 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:39:20,403 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:39:20,403 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:39:20,403 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,403 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 21:39:20,403 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:39:20,404 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:39:20,405 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:39:20,406 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:39:20,407 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,408 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 21:39:20,408 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:39:20,408 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:39:20,408 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:39:20,408 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,409 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:39:20,410 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:39:20,411 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,412 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,413 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,413 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:39:20,413 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:39:20,413 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,413 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,413 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,413 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,414 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:39:20,414 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:39:20,414 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,414 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:39:20,415 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,417 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,418 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:39:20,419 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,420 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,420 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,420 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:39:20,420 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,420 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:39:20,420 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,421 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,421 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:39:20,421 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:39:20,421 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,421 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,422 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,423 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:39:20,424 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:39:20,425 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 21:39:20,427 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 21:39:20,427 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 21:39:20,427 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 21:39:20,427 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 21:39:20,427 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 21:39:20,428 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 21:39:20,428 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 21:39:20,428 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 21:39:20,428 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 21:39:20,428 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 21:39:20,428 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 21:39:20,429 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 21:39:20,429 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 21:39:20,429 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 21:39:20,429 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 21:39:20,429 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 21:39:20,430 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 21:39:20,430 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 21:39:20,430 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:39:20,430 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 21:39:20,432 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 21:39:20,432 - ExcelTest - INFO - 处理结果统计:
2025-04-03 21:39:20,432 - ExcelTest - INFO -   customers: 3项
2025-04-03 21:39:20,432 - ExcelTest - INFO -   health_records: 3项
2025-04-03 21:39:20,433 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 21:39:20,433 - ExcelTest - INFO -   services: 30项
2025-04-03 21:39:20,433 - ExcelTest - INFO -   communications: 15项
2025-04-03 21:39:20,433 - ExcelTest - INFO - 客户数据示例:
2025-04-03 21:39:20,433 - ExcelTest - INFO -   id: C001
2025-04-03 21:39:20,433 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 21:39:20,433 - ExcelTest - INFO -   gender: 女
2025-04-03 21:39:20,433 - ExcelTest - INFO -   age: 28
2025-04-03 21:39:20,434 - ExcelTest - INFO -   store: 分店A
2025-04-03 21:39:20,434 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 21:39:20,434 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 21:39:20,434 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 21:39:20,434 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 21:39:20,434 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 21:39:20,434 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 21:39:20,435 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 21:39:20,435 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 21:39:20,435 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 21:39:20,435 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 21:39:20,435 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 21:39:20,435 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 21:39:20,435 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 21:39:20,435 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 21:39:20,435 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 21:39:20,435 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 21:39:20,435 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 21:39:20,435 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 21:46:28,967 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 21:46:28,967 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 21:46:29,148 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 21:46:29,148 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 21:46:29,148 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:46:29,148 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 21:46:29,149 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 21:46:29,149 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:46:29,149 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:46:29,365 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 21:46:29,365 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 21:46:29,365 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 21:46:29,365 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 21:46:29,365 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 21:46:29,366 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 21:46:29,373 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-03 21:46:29,373 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:46:29,373 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 21:46:29,374 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:46:29,374 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 21:46:29,374 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 21:46:29,374 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 21:46:29,374 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:46:29,375 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 21:46:29,376 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 21:46:29,376 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 21:46:29,376 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 21:46:29,376 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 21:46:29,376 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 21:46:29,376 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 21:46:29,377 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:46:29,377 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:46:29,377 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:46:29,378 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 21:46:29,378 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 21:46:29,378 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:46:29,378 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 21:46:29,378 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:46:29,379 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:46:29,379 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:46:29,379 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:46:29,379 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 21:46:29,379 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 21:46:29,379 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 21:46:29,380 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 21:46:29,380 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 21:46:29,380 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,380 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 21:46:29,380 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,381 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,382 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,383 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,384 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:46:29,385 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,385 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 21:46:29,385 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,385 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:46:29,385 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,386 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,387 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 21:46:29,388 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,389 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:46:29,390 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,390 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 21:46:29,390 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:46:29,390 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:46:29,390 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,390 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:46:29,390 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,391 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:46:29,392 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:46:29,392 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,392 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,392 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,393 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,394 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,395 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,395 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 21:46:29,395 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:46:29,395 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:46:29,395 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:46:29,395 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:46:29,395 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,396 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:46:29,397 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,397 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,397 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,397 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:46:29,397 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,397 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,398 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:46:29,399 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,399 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,399 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,399 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:46:29,399 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,399 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:46:29,399 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:46:29,400 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:46:29,401 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:46:29,402 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,403 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:46:29,403 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:46:29,403 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:46:29,403 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:46:29,403 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 21:46:29,404 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 21:46:29,405 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 21:46:29,405 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 21:46:29,405 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 21:46:29,405 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:46:29,405 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:46:29,405 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 21:46:29,405 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 21:46:29,406 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 21:46:29,406 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 21:46:29,406 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 21:46:29,406 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 21:46:29,406 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 21:46:29,406 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 21:46:29,407 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 21:46:29,407 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 21:46:29,407 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 21:46:29,407 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 21:46:29,408 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 21:46:29,408 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 21:46:29,408 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 21:46:29,408 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 21:46:29,408 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 21:46:29,408 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 21:46:29,408 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 21:46:29,409 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:46:29,409 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 21:46:29,411 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 21:46:29,411 - ExcelTest - INFO - 处理结果统计:
2025-04-03 21:46:29,411 - ExcelTest - INFO -   customers: 3项
2025-04-03 21:46:29,411 - ExcelTest - INFO -   health_records: 3项
2025-04-03 21:46:29,411 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 21:46:29,411 - ExcelTest - INFO -   services: 30项
2025-04-03 21:46:29,412 - ExcelTest - INFO -   communications: 15项
2025-04-03 21:46:29,412 - ExcelTest - INFO - 客户数据示例:
2025-04-03 21:46:29,412 - ExcelTest - INFO -   id: C001
2025-04-03 21:46:29,412 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 21:46:29,412 - ExcelTest - INFO -   gender: 女
2025-04-03 21:46:29,412 - ExcelTest - INFO -   age: 28
2025-04-03 21:46:29,412 - ExcelTest - INFO -   store: 分店A
2025-04-03 21:46:29,412 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 21:46:29,412 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 21:46:29,412 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 21:46:29,412 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 21:46:29,412 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 21:46:29,412 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 21:46:29,412 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 21:46:29,412 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 21:46:29,412 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 21:46:29,413 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 21:46:29,413 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 21:46:29,413 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 21:46:29,413 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 21:46:29,413 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 21:46:29,413 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 21:46:29,413 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 21:46:29,413 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 21:46:29,413 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 21:48:00,236 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 21:48:00,237 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 21:48:00,419 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 21:48:00,419 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 21:48:00,420 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:48:00,420 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 21:48:00,420 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 21:48:00,420 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:48:00,420 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:48:00,633 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 21:48:00,634 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 21:48:00,634 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 21:48:00,634 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 21:48:00,634 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 21:48:00,635 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 21:48:00,640 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-03 21:48:00,641 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:48:00,641 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 21:48:00,641 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:48:00,641 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 21:48:00,642 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 21:48:00,643 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 21:48:00,644 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 21:48:00,644 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:48:00,644 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:48:00,645 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:48:00,645 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 21:48:00,645 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 21:48:00,645 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:48:00,645 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 21:48:00,645 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 21:48:00,646 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 21:48:00,647 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,647 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 21:48:00,647 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,647 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:48:00,647 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,648 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:48:00,649 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,649 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:48:00,649 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:48:00,649 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:48:00,649 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,649 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 21:48:00,649 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,650 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,651 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,652 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,653 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:48:00,654 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 21:48:00,655 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,656 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,656 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,656 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,656 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:48:00,656 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:48:00,656 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,657 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,657 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,657 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,658 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,659 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:48:00,660 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,661 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,661 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,661 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,661 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,661 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:48:00,661 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,661 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:48:00,662 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:48:00,663 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,663 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:48:00,663 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:48:00,663 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,663 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:48:00,663 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,664 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,665 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:48:00,667 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,668 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:48:00,669 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,669 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:48:00,669 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:48:00,669 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:48:00,669 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:48:00,669 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:48:00,670 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 21:48:00,671 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 21:48:00,672 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 21:48:00,672 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:48:00,672 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:48:00,672 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 21:48:00,672 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 21:48:00,672 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 21:48:00,672 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 21:48:00,673 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 21:48:00,674 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 21:48:00,674 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 21:48:00,674 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 21:48:00,674 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 21:48:00,674 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 21:48:00,674 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 21:48:00,674 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 21:48:00,674 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:48:00,674 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 21:48:00,677 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 21:48:00,677 - ExcelTest - INFO - 处理结果统计:
2025-04-03 21:48:00,677 - ExcelTest - INFO -   customers: 3项
2025-04-03 21:48:00,677 - ExcelTest - INFO -   health_records: 3项
2025-04-03 21:48:00,677 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 21:48:00,677 - ExcelTest - INFO -   services: 30项
2025-04-03 21:48:00,677 - ExcelTest - INFO -   communications: 15项
2025-04-03 21:48:00,677 - ExcelTest - INFO - 客户数据示例:
2025-04-03 21:48:00,677 - ExcelTest - INFO -   id: C001
2025-04-03 21:48:00,677 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 21:48:00,677 - ExcelTest - INFO -   gender: 女
2025-04-03 21:48:00,678 - ExcelTest - INFO -   age: 28
2025-04-03 21:48:00,678 - ExcelTest - INFO -   store: 分店A
2025-04-03 21:48:00,678 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 21:48:00,678 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 21:48:00,678 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 21:48:00,678 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 21:48:00,678 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 21:48:00,678 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 21:48:00,678 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 21:48:00,678 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 21:48:00,678 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 21:48:00,678 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 21:48:00,678 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 21:48:00,679 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 21:48:00,679 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 21:48:00,679 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 21:48:00,679 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 21:48:00,679 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 21:48:00,679 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 21:48:00,679 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-03 21:49:20,348 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-03 21:49:20,348 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-03 21:49:20,516 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-03 21:49:20,517 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-03 21:49:20,517 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:49:20,517 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-03 21:49:20,517 - ExcelTest - INFO - 开始调用process_file方法
2025-04-03 21:49:20,517 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:49:20,517 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:49:20,722 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-03 21:49:20,723 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-03 21:49:20,723 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-03 21:49:20,723 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-03 21:49:20,723 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-03 21:49:20,723 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-03 21:49:20,729 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4  地域背景 Unnamed: 6 Unnamed: 7    家庭结构 Unnamed: 9 Unnamed: 10 性格及消费心理 Unnamed: 12 Unnamed: 13   生活习惯 Unnamed: 15 Unnamed: 16 Unnamed: 17 Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄       门店归属    籍贯        现居地       居住时长  家庭成员构成   家庭人员年龄分布      家庭居住情况  性格类型标签      消费决策主导       风险敏感度   兴趣爱好        作息规律        饮食偏好         生理期      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28        分店A  浙江杭州       上海浦东         6年    单身独居          无        自有公寓   精致悦己型        本人主导           低  护肤、健身  23:00-7:00        轻食沙拉          记录           无  时尚编辑        外资企业         35万
2025-04-03 21:49:20,729 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:49:20,729 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-03 21:49:20,730 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-03 21:49:20,730 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-03 21:49:20,730 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-03 21:49:20,730 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-03 21:49:20,731 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-03 21:49:20,731 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-03 21:49:20,731 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-03 21:49:20,731 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-03 21:49:20,731 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-03 21:49:20,731 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-03 21:49:20,731 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:49:20,732 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-03 21:49:20,732 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-03 21:49:20,732 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-03 21:49:20,732 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-03 21:49:20,732 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-03 21:49:20,733 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-03 21:49:20,733 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-03 21:49:20,733 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-03 21:49:20,734 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:49:20,734 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:49:20,734 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:49:20,734 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-03 21:49:20,734 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-03 21:49:20,735 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:49:20,735 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-03 21:49:20,735 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-03 21:49:20,735 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-03 21:49:20,736 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,737 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,738 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:49:20,739 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,739 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,739 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:49:20,739 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:49:20,739 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,739 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:49:20,739 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,740 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:49:20,740 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,740 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-03 21:49:20,740 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:49:20,740 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:49:20,740 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,740 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:49:20,741 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,741 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,741 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,741 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:49:20,741 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,741 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:49:20,741 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:49:20,742 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-03 21:49:20,743 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,744 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:49:20,745 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:49:20,747 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,747 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,747 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,747 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:49:20,747 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,747 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-03 21:49:20,747 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:49:20,748 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,749 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,749 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,749 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,749 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:49:20,749 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:49:20,749 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,750 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,751 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-03 21:49:20,752 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,753 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-03 21:49:20,753 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-03 21:49:20,753 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,753 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-03 21:49:20,753 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,753 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,753 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:49:20,754 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-03 21:49:20,754 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,754 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:49:20,754 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,754 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,754 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,754 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,755 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,756 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:49:20,757 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,758 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-03 21:49:20,758 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-03 21:49:20,758 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-03 21:49:20,758 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-03 21:49:20,758 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-03 21:49:20,758 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,758 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:49:20,759 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,759 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-03 21:49:20,759 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-03 21:49:20,759 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-03 21:49:20,759 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-03 21:49:20,759 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-03 21:49:20,759 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-03 21:49:20,760 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-03 21:49:20,761 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-03 21:49:20,761 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-03 21:49:20,761 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:49:20,761 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-03 21:49:20,761 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-03 21:49:20,761 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-03 21:49:20,761 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-03 21:49:20,762 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-03 21:49:20,763 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-03 21:49:20,763 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-03 21:49:20,763 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-03 21:49:20,763 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-03 21:49:20,763 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-03 21:49:20,763 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-03 21:49:20,763 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-03 21:49:20,763 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-03 21:49:20,763 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-03 21:49:20,763 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-03 21:49:20,765 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-03 21:49:20,765 - ExcelTest - INFO - 处理结果统计:
2025-04-03 21:49:20,765 - ExcelTest - INFO -   customers: 3项
2025-04-03 21:49:20,767 - ExcelTest - INFO -   health_records: 3项
2025-04-03 21:49:20,767 - ExcelTest - INFO -   consumptions: 9项
2025-04-03 21:49:20,767 - ExcelTest - INFO -   services: 30项
2025-04-03 21:49:20,767 - ExcelTest - INFO -   communications: 15项
2025-04-03 21:49:20,767 - ExcelTest - INFO - 客户数据示例:
2025-04-03 21:49:20,767 - ExcelTest - INFO -   id: C001
2025-04-03 21:49:20,767 - ExcelTest - INFO -   name: 林晓薇
2025-04-03 21:49:20,767 - ExcelTest - INFO -   gender: 女
2025-04-03 21:49:20,767 - ExcelTest - INFO -   age: 28
2025-04-03 21:49:20,767 - ExcelTest - INFO -   store: 分店A
2025-04-03 21:49:20,767 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-03 21:49:20,767 - ExcelTest - INFO -   residence: 上海浦东
2025-04-03 21:49:20,767 - ExcelTest - INFO -   residence_years: 6年
2025-04-03 21:49:20,768 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-03 21:49:20,768 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-03 21:49:20,768 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-03 21:49:20,768 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-03 21:49:20,768 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-03 21:49:20,768 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-03 21:49:20,768 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-03 21:49:20,768 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-03 21:49:20,768 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-03 21:49:20,768 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-03 21:49:20,768 - ExcelTest - INFO -   family_medical_history: 无
2025-04-03 21:49:20,769 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-03 21:49:20,769 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-03 21:49:20,769 - ExcelTest - INFO -   annual_income: 35万
2025-04-03 21:49:20,769 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 15:45:54,130 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 15:45:54,130 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 15:45:54,302 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 15:45:54,302 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 15:45:54,302 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:45:54,302 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 15:45:54,302 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 15:45:54,302 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:45:54,302 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:45:54,513 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 15:45:54,513 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 15:45:54,513 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 15:45:54,513 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 15:45:54,514 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 15:45:54,514 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 15:45:54,522 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2  ...  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别  ...    职业        单位性质         年收入
1  C001        林晓薇          女  ...  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 15:45:54,522 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 15:45:54,522 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 15:45:54,522 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 15:45:54,523 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 15:45:54,524 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 15:45:54,524 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 15:45:54,524 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 15:45:54,524 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 15:45:54,524 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 15:45:54,524 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 15:45:54,525 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 15:45:54,525 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 15:45:54,525 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 15:45:54,525 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:45:54,526 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 15:45:54,526 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:45:54,526 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 15:45:54,526 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 15:45:54,526 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:45:54,526 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 15:45:54,526 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 15:45:54,527 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:45:54,528 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 15:45:54,529 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:45:54,530 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:45:54,531 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,533 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:45:54,534 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,534 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:45:54,534 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:45:54,534 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 15:45:54,534 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,534 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:45:54,534 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,535 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 15:45:54,536 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,536 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:45:54,536 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,536 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,536 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:45:54,536 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 15:45:54,536 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:45:54,537 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,538 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,539 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,540 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,541 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:45:54,542 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:45:54,543 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 15:45:54,544 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,545 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:45:54,546 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 15:45:54,547 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,548 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 15:45:54,549 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,549 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 15:45:54,549 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 15:45:54,549 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 15:45:54,549 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:45:54,549 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:45:54,549 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:45:54,550 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 15:45:54,550 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:45:54,550 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 15:45:54,550 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 15:45:54,551 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 15:45:54,552 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 15:45:54,552 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 15:45:54,552 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 15:45:54,553 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 15:45:54,553 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 15:45:54,553 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 15:45:54,553 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 15:45:54,553 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 15:45:54,554 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 15:45:54,554 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 15:45:54,554 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 15:45:54,554 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 15:45:54,554 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 15:45:54,554 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 15:45:54,555 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 15:45:54,555 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 15:45:54,555 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 15:45:54,555 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 15:45:54,555 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 15:45:54,555 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 15:45:54,555 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 15:45:54,555 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:45:54,555 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 15:45:54,557 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 15:45:54,558 - ExcelTest - INFO - 处理结果统计:
2025-04-08 15:45:54,558 - ExcelTest - INFO -   customers: 3项
2025-04-08 15:45:54,558 - ExcelTest - INFO -   health_records: 3项
2025-04-08 15:45:54,558 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 15:45:54,558 - ExcelTest - INFO -   services: 30项
2025-04-08 15:45:54,558 - ExcelTest - INFO -   communications: 15项
2025-04-08 15:45:54,558 - ExcelTest - INFO - 客户数据示例:
2025-04-08 15:45:54,558 - ExcelTest - INFO -   id: C001
2025-04-08 15:45:54,558 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 15:45:54,558 - ExcelTest - INFO -   gender: 女
2025-04-08 15:45:54,559 - ExcelTest - INFO -   age: 28
2025-04-08 15:45:54,559 - ExcelTest - INFO -   store: 分店A
2025-04-08 15:45:54,559 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 15:45:54,559 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 15:45:54,559 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 15:45:54,559 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 15:45:54,559 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 15:45:54,559 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 15:45:54,559 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 15:45:54,559 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 15:45:54,559 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 15:45:54,559 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 15:45:54,559 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 15:45:54,560 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 15:45:54,560 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 15:45:54,560 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 15:45:54,560 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 15:45:54,560 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 15:45:54,560 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 15:45:54,560 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 15:56:53,319 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 15:56:53,319 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 15:56:53,491 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 15:56:53,491 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 15:56:53,491 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:56:53,491 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 15:56:53,491 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 15:56:53,491 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:56:53,492 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:56:53,704 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 15:56:53,704 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 15:56:53,704 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 15:56:53,704 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 15:56:53,704 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 15:56:53,705 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 15:56:53,712 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2  ...  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别  ...    职业        单位性质         年收入
1  C001        林晓薇          女  ...  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 15:56:53,712 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 15:56:53,712 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 15:56:53,712 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 15:56:53,713 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 15:56:53,713 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 15:56:53,713 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 15:56:53,714 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 15:56:53,714 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 15:56:53,714 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 15:56:53,714 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 15:56:53,715 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 15:56:53,715 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 15:56:53,715 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 15:56:53,715 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 15:56:53,715 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 15:56:53,716 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 15:56:53,716 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 15:56:53,716 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 15:56:53,716 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 15:56:53,716 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 15:56:53,716 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 15:56:53,717 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:56:53,717 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 15:56:53,717 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:56:53,718 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 15:56:53,718 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 15:56:53,718 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 15:56:53,719 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 15:56:53,720 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 15:56:53,720 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 15:56:53,720 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,720 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-08 15:56:53,720 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,720 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:56:53,720 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:56:53,721 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,722 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:56:53,723 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:56:53,723 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,723 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:56:53,723 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,723 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:56:53,723 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,725 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 15:56:53,725 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:56:53,725 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 15:56:53,725 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,725 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:56:53,725 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,726 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,726 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,726 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 15:56:53,726 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,726 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:56:53,726 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,727 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 15:56:53,728 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,729 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 15:56:53,730 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,731 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,731 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 15:56:53,732 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,733 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:56:53,734 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,735 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-08 15:56:53,736 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:56:53,736 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 15:56:53,736 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 15:56:53,736 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 15:56:53,736 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,737 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 15:56:53,737 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 15:56:53,737 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,737 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 15:56:53,737 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 15:56:53,737 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,738 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 15:56:53,738 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,738 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,738 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 15:56:53,738 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 15:56:53,738 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,738 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:56:53,739 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:56:53,740 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:56:53,741 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 15:56:53,742 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 15:56:53,743 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 解析出服务项目数: 1
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 15:56:53,744 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 15:56:53,745 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 15:56:53,746 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 15:56:53,746 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 15:56:53,746 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 15:56:53,746 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 15:56:53,746 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 15:56:53,747 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 15:56:53,748 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 15:56:53,748 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 15:56:53,748 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 15:56:53,748 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 15:56:53,748 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 15:56:53,748 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 15:56:53,749 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 15:56:53,749 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 15:56:53,751 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 15:56:53,751 - ExcelTest - INFO - 处理结果统计:
2025-04-08 15:56:53,751 - ExcelTest - INFO -   customers: 3项
2025-04-08 15:56:53,751 - ExcelTest - INFO -   health_records: 3项
2025-04-08 15:56:53,751 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 15:56:53,751 - ExcelTest - INFO -   services: 30项
2025-04-08 15:56:53,751 - ExcelTest - INFO -   communications: 15项
2025-04-08 15:56:53,751 - ExcelTest - INFO - 客户数据示例:
2025-04-08 15:56:53,751 - ExcelTest - INFO -   id: C001
2025-04-08 15:56:53,751 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 15:56:53,751 - ExcelTest - INFO -   gender: 女
2025-04-08 15:56:53,752 - ExcelTest - INFO -   age: 28
2025-04-08 15:56:53,752 - ExcelTest - INFO -   store: 分店A
2025-04-08 15:56:53,752 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 15:56:53,752 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 15:56:53,752 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 15:56:53,752 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 15:56:53,752 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 15:56:53,752 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 15:56:53,752 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 15:56:53,752 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 15:56:53,752 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 15:56:53,752 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 15:56:53,752 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 15:56:53,752 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 15:56:53,752 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 15:56:53,753 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 15:56:53,753 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 15:56:53,753 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 15:56:53,753 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 15:56:53,753 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 16:04:06,036 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 16:04:06,037 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 16:04:06,219 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 16:04:06,219 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 16:04:06,220 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:04:06,220 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 16:04:06,220 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 16:04:06,220 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:04:06,220 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:04:06,434 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 16:04:06,435 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 16:04:06,435 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 16:04:06,435 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 16:04:06,435 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 16:04:06,435 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 16:04:06,443 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 16:04:06,443 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 16:04:06,443 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 16:04:06,443 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 16:04:06,444 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 16:04:06,445 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 16:04:06,445 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 16:04:06,445 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 16:04:06,446 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 16:04:06,446 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 16:04:06,447 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 16:04:06,447 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 16:04:06,447 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 16:04:06,447 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 16:04:06,447 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 16:04:06,448 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:04:06,448 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 16:04:06,448 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:04:06,448 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 16:04:06,448 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 16:04:06,449 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:04:06,449 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 16:04:06,449 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:04:06,449 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 16:04:06,449 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 16:04:06,449 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 16:04:06,450 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 16:04:06,450 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 16:04:06,450 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 16:04:06,450 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 16:04:06,450 - utils.excel_processor - INFO - 标题行值: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-08 16:04:06,450 - utils.excel_processor - INFO - 映射列: 客户ID -> 0
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 姓名 -> 1
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 到店时间 -> 2
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 离店时间 -> 3
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 总消耗项目数 -> 4
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 总耗卡金额 -> 5
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 服务满意度 -> 6
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 项目内容 -> 7
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 8
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 9
2025-04-08 16:04:06,451 - utils.excel_processor - INFO - 映射列: 是否指定 -> 10
2025-04-08 16:04:06,452 - utils.excel_processor - INFO - 映射列: 项目内容 -> 11
2025-04-08 16:04:06,452 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 12
2025-04-08 16:04:06,452 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 13
2025-04-08 16:04:06,452 - utils.excel_processor - INFO - 映射列: 是否指定 -> 14
2025-04-08 16:04:06,452 - utils.excel_processor - INFO - 映射列: 项目内容 -> 15
2025-04-08 16:04:06,452 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 16
2025-04-08 16:04:06,452 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 17
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 是否指定 -> 18
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 项目内容 -> 19
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 20
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 21
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 是否指定 -> 22
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 项目内容 -> 23
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 24
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 25
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 映射列: 是否指定 -> 26
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 找到项目列: 总消耗项目数 at index 4
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 7
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 11
2025-04-08 16:04:06,453 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 15
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 19
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 23
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 添加项目组: {'name': 4, 'beautician': 8, 'amount': 9, 'specified': 10}
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 添加项目组: {'name': 7, 'beautician': 8, 'amount': 9, 'specified': 10}
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 添加项目组: {'name': 11, 'beautician': 12, 'amount': 13, 'specified': 14}
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 添加项目组: {'name': 15, 'beautician': 16, 'amount': 17, 'specified': 18}
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 添加项目组: {'name': 19, 'beautician': 20, 'amount': 21, 'specified': 22}
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 添加项目组: {'name': 23, 'beautician': 24, 'amount': 25, 'specified': 26}
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 项目组配置: [{'name': 4, 'beautician': 8, 'amount': 9, 'specified': 10}, {'name': 7, 'beautician': 8, 'amount': 9, 'specified': 10}, {'name': 11, 'beautician': 12, 'amount': 13, 'specified': 14}, {'name': 15, 'beautician': 16, 'amount': 17, 'specified': 18}, {'name': 19, 'beautician': 20, 'amount': 21, 'specified': 22}, {'name': 23, 'beautician': 24, 'amount': 25, 'specified': 26}]
2025-04-08 16:04:06,454 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:04:06,455 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 创建服务项目: 1 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:04:06,456 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,457 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 16:04:06,457 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,457 - utils.excel_processor - INFO - 创建服务项目: 2 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,457 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:04:06,457 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,458 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,458 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 16:04:06,458 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,458 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:04:06,458 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,458 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 创建服务项目: 1 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,459 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 533.0元 - 指定
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,460 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 未指定
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,461 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,462 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 16:04:06,462 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 16:04:06,462 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,462 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:04:06,462 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,462 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:04:06,463 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 创建服务项目: 2 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,464 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:04:06,465 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:04:06,465 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,465 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,465 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 未指定
2025-04-08 16:04:06,465 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,465 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 16:04:06,465 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,466 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:04:06,466 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,466 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,466 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,466 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 197.5元 - 未指定
2025-04-08 16:04:06,466 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 198.0元 - 指定
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,467 - utils.excel_processor - INFO - 创建服务项目: 2 - 陈莉 - 533.0元 - 未指定
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=3
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 指定
2025-04-08 16:04:06,469 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,470 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 16:04:06,470 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,470 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,470 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,470 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,470 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 198.0元 - 指定
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 创建服务项目: 1 - 陈莉 - 197.5元 - 未指定
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:04:06,471 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 创建服务项目: 1 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,472 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 指定
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,473 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 创建服务项目: 2 - 陈莉 - 197.5元 - 未指定
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=3
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,474 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 198.0元 - 指定
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,475 - utils.excel_processor - INFO - 创建服务项目: 1 - 张莉 - 293.0元 - 未指定
2025-04-08 16:04:06,476 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 16:04:06,476 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 16:04:06,476 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,476 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:04:06,476 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,476 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 480.0元 - 指定
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,477 - utils.excel_processor - INFO - 创建服务项目: 2 - 周杰 - 1360.0元 - 指定
2025-04-08 16:04:06,478 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:04:06,478 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 16:04:06,478 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,478 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 16:04:06,478 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,478 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=3
2025-04-08 16:04:06,478 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,479 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,479 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,479 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 533.0元 - 指定
2025-04-08 16:04:06,479 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,479 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 16:04:06,479 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,479 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 293.0元 - 指定
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:04:06,480 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 1360.0元 - 指定
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,481 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,482 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,482 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 480.0元 - 指定
2025-04-08 16:04:06,482 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,482 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 16:04:06,482 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,482 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:04:06,482 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,483 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:04:06,483 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,483 - utils.excel_processor - INFO - 创建服务项目: 2 - 周杰 - 533.0元 - 指定
2025-04-08 16:04:06,483 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:04:06,483 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 16:04:06,483 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=3
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 293.0元 - 指定
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:04:06,484 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 创建服务项目: 2 - 周杰 - 1360.0元 - 指定
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:04:06,485 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=3
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 71 个服务项目
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 16:04:06,486 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 16:04:06,487 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 16:04:06,487 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 16:04:06,487 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 16:04:06,487 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 16:04:06,487 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 16:04:06,487 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 16:04:06,487 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 16:04:06,488 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 16:04:06,488 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 16:04:06,488 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 16:04:06,488 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 16:04:06,489 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 16:04:06,489 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 16:04:06,489 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 16:04:06,489 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 16:04:06,489 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 16:04:06,489 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 16:04:06,489 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 16:04:06,490 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:04:06,490 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 16:04:06,492 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 16:04:06,492 - ExcelTest - INFO - 处理结果统计:
2025-04-08 16:04:06,492 - ExcelTest - INFO -   customers: 3项
2025-04-08 16:04:06,492 - ExcelTest - INFO -   health_records: 3项
2025-04-08 16:04:06,492 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 16:04:06,492 - ExcelTest - INFO -   services: 30项
2025-04-08 16:04:06,492 - ExcelTest - INFO -   communications: 15项
2025-04-08 16:04:06,492 - ExcelTest - INFO - 客户数据示例:
2025-04-08 16:04:06,492 - ExcelTest - INFO -   id: C001
2025-04-08 16:04:06,492 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 16:04:06,492 - ExcelTest - INFO -   gender: 女
2025-04-08 16:04:06,493 - ExcelTest - INFO -   age: 28
2025-04-08 16:04:06,493 - ExcelTest - INFO -   store: 分店A
2025-04-08 16:04:06,493 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 16:04:06,493 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 16:04:06,493 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 16:04:06,493 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 16:04:06,493 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 16:04:06,493 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 16:04:06,493 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 16:04:06,493 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 16:04:06,493 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 16:04:06,493 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 16:04:06,494 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 16:04:06,494 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 16:04:06,494 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 16:04:06,494 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 16:04:06,494 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 16:04:06,494 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 16:04:06,494 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 16:04:06,495 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 16:05:07,839 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 16:05:07,840 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 16:05:08,021 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 16:05:08,022 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 16:05:08,022 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:05:08,022 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 16:05:08,022 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 16:05:08,022 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:05:08,022 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:05:08,234 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 16:05:08,234 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 16:05:08,235 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 16:05:08,235 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 16:05:08,235 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 16:05:08,235 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 16:05:08,243 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2  ...  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别  ...    职业        单位性质         年收入
1  C001        林晓薇          女  ...  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 16:05:08,243 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 16:05:08,243 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 16:05:08,243 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 16:05:08,244 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 16:05:08,244 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 16:05:08,245 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 16:05:08,245 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 16:05:08,245 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 16:05:08,245 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 16:05:08,245 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 16:05:08,245 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 16:05:08,246 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 16:05:08,246 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 16:05:08,246 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 16:05:08,247 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 16:05:08,247 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 16:05:08,247 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 16:05:08,247 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 16:05:08,247 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 16:05:08,247 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 16:05:08,247 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 16:05:08,248 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:05:08,248 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 16:05:08,248 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:05:08,248 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 16:05:08,248 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 16:05:08,248 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:05:08,248 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 16:05:08,249 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 16:05:08,249 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 16:05:08,249 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 16:05:08,249 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 16:05:08,249 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 16:05:08,249 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 16:05:08,249 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 标题行值: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 客户ID -> 0
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 姓名 -> 1
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 到店时间 -> 2
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 离店时间 -> 3
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 总消耗项目数 -> 4
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 总耗卡金额 -> 5
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 服务满意度 -> 6
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 项目内容 -> 7
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 8
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 9
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 是否指定 -> 10
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 项目内容 -> 11
2025-04-08 16:05:08,250 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 12
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 13
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 是否指定 -> 14
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 项目内容 -> 15
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 16
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 17
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 是否指定 -> 18
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 项目内容 -> 19
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 20
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 21
2025-04-08 16:05:08,251 - utils.excel_processor - INFO - 映射列: 是否指定 -> 22
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 映射列: 项目内容 -> 23
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 映射列: 操作美容师 -> 24
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 映射列: 耗卡金额 -> 25
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 映射列: 是否指定 -> 26
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 找到项目列: 总消耗项目数 at index 4
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 7
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 11
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 15
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 19
2025-04-08 16:05:08,252 - utils.excel_processor - INFO - 找到项目列: 项目内容 at index 23
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 添加项目组: {'name': 4, 'beautician': 8, 'amount': 9, 'specified': 10}
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 添加项目组: {'name': 7, 'beautician': 8, 'amount': 9, 'specified': 10}
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 添加项目组: {'name': 11, 'beautician': 12, 'amount': 13, 'specified': 14}
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 添加项目组: {'name': 15, 'beautician': 16, 'amount': 17, 'specified': 18}
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 添加项目组: {'name': 19, 'beautician': 20, 'amount': 21, 'specified': 22}
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 添加项目组: {'name': 23, 'beautician': 24, 'amount': 25, 'specified': 26}
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 项目组配置: [{'name': 4, 'beautician': 8, 'amount': 9, 'specified': 10}, {'name': 7, 'beautician': 8, 'amount': 9, 'specified': 10}, {'name': 11, 'beautician': 12, 'amount': 13, 'specified': 14}, {'name': 15, 'beautician': 16, 'amount': 17, 'specified': 18}, {'name': 19, 'beautician': 20, 'amount': 21, 'specified': 22}, {'name': 23, 'beautician': 24, 'amount': 25, 'specified': 26}]
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=颈部导入, 项目3=nan
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,253 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 创建服务项目: 1 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,254 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 创建服务项目: 2 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:05:08,255 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,256 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,256 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,256 - utils.excel_processor - INFO - 创建服务项目: 1 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,256 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:05:08,256 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,257 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,257 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:05:08,257 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,257 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:05:08,258 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,258 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 533.0元 - 指定
2025-04-08 16:05:08,258 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,258 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 16:05:08,258 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:05:08,258 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 16:05:08,258 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 未指定
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,259 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=头皮护理, 项目3=nan
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:05:08,260 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 创建服务项目: 2 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,261 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=颈部导入, 项目3=nan
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 创建服务项目: 2 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 发现项目名称: 颈部导入
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=3
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,262 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,263 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 未指定
2025-04-08 16:05:08,263 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,263 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 16:05:08,263 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,263 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 197.5元 - 未指定
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,264 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 198.0元 - 指定
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,265 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 创建服务项目: 2 - 陈莉 - 533.0元 - 未指定
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=3
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,266 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 指定
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 198.0元 - 指定
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 16:05:08,267 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 创建服务项目: 1 - 陈莉 - 197.5元 - 未指定
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:05:08,268 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 16:05:08,269 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,269 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,269 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,269 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,269 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,269 - utils.excel_processor - INFO - 创建服务项目: 1 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 533.0元 - 指定
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,270 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 项目组数据: 项目1=草本熏蒸SPA, 项目2=头皮护理, 项目3=nan
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 创建服务项目: 2 - 陈莉 - 197.5元 - 未指定
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 发现项目名称: 头皮护理
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,271 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=3
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 项目组数据: 项目1=经络排毒塑身, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 创建服务项目: 1 - 王芳 - 198.0元 - 指定
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 发现项目名称: 经络排毒塑身
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,272 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,274 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,274 - utils.excel_processor - INFO - 创建服务项目: 1 - 张莉 - 293.0元 - 未指定
2025-04-08 16:05:08,274 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 16:05:08,274 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 16:05:08,274 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,274 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:05:08,274 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 480.0元 - 指定
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:05:08,275 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,276 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 16:05:08,276 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,276 - utils.excel_processor - INFO - 创建服务项目: 2 - 周杰 - 1360.0元 - 指定
2025-04-08 16:05:08,276 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:05:08,276 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 16:05:08,276 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,276 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=3
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 533.0元 - 指定
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,277 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 293.0元 - 指定
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,278 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 1360.0元 - 指定
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 项目组数据: 项目1=冰肌焕颜护理, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 480.0元 - 指定
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,279 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 项目组数据: 项目1=帝王艾灸调理, 项目2=草本熏蒸SPA, 项目3=nan
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 创建服务项目: 2 - 周杰 - 533.0元 - 指定
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 发现项目名称: 帝王艾灸调理
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 发现项目名称: 草本熏蒸SPA
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,280 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=3
2025-04-08 16:05:08,281 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,281 - utils.excel_processor - INFO - 项目组数据: 项目1=极光净透泡泡, 项目2=nan, 项目3=nan
2025-04-08 16:05:08,281 - utils.excel_processor - INFO - 发现项目名称: 1
2025-04-08 16:05:08,281 - utils.excel_processor - INFO - 创建服务项目: 1 - 周杰 - 293.0元 - 指定
2025-04-08 16:05:08,281 - utils.excel_processor - INFO - 发现项目名称: 极光净透泡泡
2025-04-08 16:05:08,281 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 16:05:08,281 - utils.excel_processor - INFO - 解析出服务项目数: 2
2025-04-08 16:05:08,282 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 16:05:08,282 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛
2025-04-08 16:05:08,282 - utils.excel_processor - INFO - 项目组数据: 项目1=黄金射频紧致疗程, 项目2=冰肌焕颜护理, 项目3=nan
2025-04-08 16:05:08,282 - utils.excel_processor - INFO - 发现项目名称: 2
2025-04-08 16:05:08,282 - utils.excel_processor - INFO - 创建服务项目: 2 - 周杰 - 1360.0元 - 指定
2025-04-08 16:05:08,282 - utils.excel_processor - INFO - 发现项目名称: 黄金射频紧致疗程
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 发现项目名称: 冰肌焕颜护理
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 解析出服务项目数: 3
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=3
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 71 个服务项目
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 16:05:08,283 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 16:05:08,284 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 16:05:08,284 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 16:05:08,284 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 16:05:08,284 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 16:05:08,284 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 16:05:08,284 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 16:05:08,284 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 16:05:08,285 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 16:05:08,286 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 16:05:08,286 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 16:05:08,286 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 16:05:08,286 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 16:05:08,286 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 16:05:08,286 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 16:05:08,286 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 16:05:08,286 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 16:05:08,286 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 16:05:08,289 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 16:05:08,289 - ExcelTest - INFO - 处理结果统计:
2025-04-08 16:05:08,289 - ExcelTest - INFO -   customers: 3项
2025-04-08 16:05:08,289 - ExcelTest - INFO -   health_records: 3项
2025-04-08 16:05:08,289 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 16:05:08,289 - ExcelTest - INFO -   services: 30项
2025-04-08 16:05:08,289 - ExcelTest - INFO -   communications: 15项
2025-04-08 16:05:08,289 - ExcelTest - INFO - 客户数据示例:
2025-04-08 16:05:08,289 - ExcelTest - INFO -   id: C001
2025-04-08 16:05:08,289 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 16:05:08,289 - ExcelTest - INFO -   gender: 女
2025-04-08 16:05:08,289 - ExcelTest - INFO -   age: 28
2025-04-08 16:05:08,290 - ExcelTest - INFO -   store: 分店A
2025-04-08 16:05:08,290 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 16:05:08,290 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 16:05:08,290 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 16:05:08,290 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 16:05:08,290 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 16:05:08,290 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 16:05:08,290 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 16:05:08,290 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 16:05:08,290 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 16:05:08,290 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 16:05:08,290 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 16:05:08,290 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 16:05:08,290 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 16:05:08,290 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 16:05:08,291 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 16:05:08,291 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 16:05:08,291 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 16:05:08,291 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 17:12:48,347 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 17:12:48,347 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 17:12:48,532 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 17:12:48,533 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 17:12:48,533 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:12:48,533 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 17:12:48,533 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 17:12:48,533 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:12:48,533 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:12:48,751 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 17:12:48,751 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 17:12:48,751 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 17:12:48,751 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 17:12:48,751 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 17:12:48,752 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 17:12:48,759 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 17:12:48,760 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 17:12:48,760 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 17:12:48,760 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 17:12:48,761 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 17:12:48,761 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 17:12:48,761 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 17:12:48,761 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 17:12:48,762 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 17:12:48,762 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 17:12:48,762 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 17:12:48,762 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 17:12:48,762 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 17:12:48,762 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 17:12:48,762 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 17:12:48,763 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 17:12:48,763 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 17:12:48,763 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 17:12:48,763 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 17:12:48,763 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 17:12:48,763 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 17:12:48,764 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 17:12:48,764 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:12:48,764 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 17:12:48,764 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:12:48,764 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 17:12:48,765 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 17:12:48,766 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 17:12:48,766 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 17:12:48,766 - utils.excel_processor - INFO - 标题行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-08 17:12:48,766 - utils.excel_processor - INFO - 找到客户ID列: 索引=0, 值=客户ID
2025-04-08 17:12:48,766 - utils.excel_processor - INFO - 找到姓名列: 索引=1, 值=姓名
2025-04-08 17:12:48,766 - utils.excel_processor - INFO - 找到到店时间列: 索引=2, 值=到店时间
2025-04-08 17:12:48,767 - utils.excel_processor - INFO - 找到离店时间列: 索引=3, 值=离店时间
2025-04-08 17:12:48,767 - utils.excel_processor - INFO - 找到总金额列: 索引=5, 值=总耗卡金额
2025-04-08 17:12:48,767 - utils.excel_processor - INFO - 找到满意度列: 索引=6, 值=服务满意度
2025-04-08 17:12:48,767 - utils.excel_processor - WARNING - 未找到总项目数列，使用默认索引: 4
2025-04-08 17:12:48,767 - utils.excel_processor - INFO - 找到项目组: 项目列=7, 美容师列=8, 金额列=9, 指定列=10
2025-04-08 17:12:48,767 - utils.excel_processor - INFO - 找到项目组: 项目列=11, 美容师列=12, 金额列=13, 指定列=14
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 找到项目组: 项目列=15, 美容师列=16, 金额列=17, 指定列=18
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 找到项目组: 项目列=19, 美容师列=20, 金额列=21, 指定列=22
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 找到项目组: 项目列=23, 美容师列=24, 金额列=25, 指定列=26
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 识别到5个项目组
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 2)
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 解析到店时间: 2023-07-12 14:00:00
2025-04-08 17:12:48,768 - utils.excel_processor - INFO - 解析离店时间: 2023-07-12 16:30:00
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 解析总金额: 680.0
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,770 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:12:48,771 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 17:12:48,771 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 17:12:48,771 - utils.excel_processor - INFO - 项目组 2: 金额: 200.0
2025-04-08 17:12:48,771 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:12:48,771 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 17:12:48,771 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,771 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,771 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,771 - utils.excel_processor - INFO - 行 2: 解析出服务项目数: 2
2025-04-08 17:12:48,772 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:12:48,772 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 3)
2025-04-08 17:12:48,772 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 15:20:00
2025-04-08 17:12:48,772 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 17:50:00
2025-04-08 17:12:48,772 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,772 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 17:12:48,772 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:12:48,773 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,773 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,773 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:12:48,773 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:12:48,773 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,773 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:12:48,773 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,773 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,773 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,774 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,774 - utils.excel_processor - INFO - 行 3: 解析出服务项目数: 1
2025-04-08 17:12:48,774 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:12:48,774 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 4)
2025-04-08 17:12:48,774 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 10:00:00
2025-04-08 17:12:48,774 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 12:30:00
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:12:48,775 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,776 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:12:48,776 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,776 - utils.excel_processor - INFO - 项目组 2: 美容师: 李婷
2025-04-08 17:12:48,776 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:12:48,776 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:12:48,776 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 17:12:48,776 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,776 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,776 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,776 - utils.excel_processor - INFO - 行 4: 解析出服务项目数: 2
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 5)
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 11:15:00
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 13:45:00
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,777 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:12:48,777 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,777 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,777 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,778 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 行 5: 解析出服务项目数: 1
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 6)
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 解析到店时间: 2023-08-18 14:00:00
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 解析离店时间: 2023-08-18 16:30:00
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:12:48,778 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:12:48,779 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 17:12:48,781 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,781 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,781 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,781 - utils.excel_processor - INFO - 行 6: 解析出服务项目数: 2
2025-04-08 17:12:48,781 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:12:48,781 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 7)
2025-04-08 17:12:48,781 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 09:30:00
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 12:00:00
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,782 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,783 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,783 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 17:12:48,783 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,783 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,783 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,783 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,783 - utils.excel_processor - INFO - 行 7: 解析出服务项目数: 1
2025-04-08 17:12:48,783 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:12:48,783 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 8)
2025-04-08 17:12:48,783 - utils.excel_processor - INFO - 解析到店时间: 2023-09-09 15:00:00
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 解析离店时间: 2023-09-09 17:30:00
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 解析总金额: 830.0
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 17:12:48,784 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:12:48,785 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 17:12:48,785 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:12:48,785 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 17:12:48,785 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,785 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,785 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,785 - utils.excel_processor - INFO - 行 8: 解析出服务项目数: 2
2025-04-08 17:12:48,785 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:12:48,785 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 9)
2025-04-08 17:12:48,785 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 14:20:00
2025-04-08 17:12:48,786 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 16:50:00
2025-04-08 17:12:48,786 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,786 - utils.excel_processor - INFO - 解析总金额: 677.5
2025-04-08 17:12:48,786 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:12:48,786 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:12:48,786 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 17:12:48,787 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,787 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,787 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 行 9: 解析出服务项目数: 2
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:12:48,787 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 10)
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 解析到店时间: 2023-10-05 10:45:00
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 解析离店时间: 2023-10-05 13:15:00
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:12:48,788 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 17:12:48,789 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,789 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,789 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 行 10: 解析出服务项目数: 2
2025-04-08 17:12:48,789 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 11)
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 解析到店时间: 2023-10-18 16:00:00
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 解析离店时间: 2023-10-18 18:30:00
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,790 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,791 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,791 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 17:12:48,791 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,791 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,791 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,791 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,791 - utils.excel_processor - INFO - 行 11: 解析出服务项目数: 1
2025-04-08 17:12:48,791 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:12:48,792 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 12)
2025-04-08 17:12:48,792 - utils.excel_processor - INFO - 解析到店时间: 2023-07-05 09:30:00
2025-04-08 17:12:48,792 - utils.excel_processor - INFO - 解析离店时间: 2023-07-05 11:40:00
2025-04-08 17:12:48,792 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,792 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 17:12:48,792 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 17:12:48,793 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,793 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,793 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,793 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 行 12: 解析出服务项目数: 1
2025-04-08 17:12:48,793 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 13)
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 10:15:00
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 12:30:00
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 17:12:48,794 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,795 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 17:12:48,795 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,795 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 17:12:48,795 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,795 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,795 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,795 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,795 - utils.excel_processor - INFO - 行 13: 解析出服务项目数: 1
2025-04-08 17:12:48,795 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,795 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 14)
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 解析到店时间: 2023-08-10 09:45:00
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 解析离店时间: 2023-08-10 12:00:00
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,796 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 17:12:48,797 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:12:48,797 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:12:48,797 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:12:48,797 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:12:48,797 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 17:12:48,797 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,797 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,798 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,798 - utils.excel_processor - INFO - 行 14: 解析出服务项目数: 2
2025-04-08 17:12:48,798 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 17:12:48,798 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 15)
2025-04-08 17:12:48,798 - utils.excel_processor - INFO - 解析到店时间: 2023-08-17 14:30:00
2025-04-08 17:12:48,798 - utils.excel_processor - INFO - 解析离店时间: 2023-08-17 16:50:00
2025-04-08 17:12:48,798 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,799 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 17:12:48,799 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,799 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,799 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,800 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,800 - utils.excel_processor - INFO - 行 15: 解析出服务项目数: 1
2025-04-08 17:12:48,800 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,800 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 16)
2025-04-08 17:12:48,800 - utils.excel_processor - INFO - 解析到店时间: 2023-09-05 14:00:00
2025-04-08 17:12:48,800 - utils.excel_processor - INFO - 解析离店时间: 2023-09-05 16:20:00
2025-04-08 17:12:48,800 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,800 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 17:12:48,801 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,801 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,801 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,801 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 行 16: 解析出服务项目数: 1
2025-04-08 17:12:48,801 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 17)
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 10:30:00
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 12:50:00
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:12:48,802 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 17:12:48,803 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 17:12:48,803 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,803 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 17:12:48,803 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,803 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,803 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,803 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,803 - utils.excel_processor - INFO - 行 17: 解析出服务项目数: 1
2025-04-08 17:12:48,804 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,804 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 18)
2025-04-08 17:12:48,804 - utils.excel_processor - INFO - 解析到店时间: 2023-10-03 09:00:00
2025-04-08 17:12:48,804 - utils.excel_processor - INFO - 解析离店时间: 2023-10-03 11:30:00
2025-04-08 17:12:48,804 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,804 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 17:12:48,804 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:12:48,805 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,805 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:12:48,805 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:12:48,805 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:12:48,805 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,805 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:12:48,805 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,805 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,805 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,806 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,806 - utils.excel_processor - INFO - 行 18: 解析出服务项目数: 1
2025-04-08 17:12:48,806 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,806 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 19)
2025-04-08 17:12:48,806 - utils.excel_processor - INFO - 解析到店时间: 2023-10-15 15:15:00
2025-04-08 17:12:48,806 - utils.excel_processor - INFO - 解析离店时间: 2023-10-15 17:45:00
2025-04-08 17:12:48,806 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,807 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 17:12:48,807 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,807 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,808 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,808 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,808 - utils.excel_processor - INFO - 行 19: 解析出服务项目数: 1
2025-04-08 17:12:48,808 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,808 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 20)
2025-04-08 17:12:48,808 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 13:00:00
2025-04-08 17:12:48,808 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 15:20:00
2025-04-08 17:12:48,808 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 解析总金额: 547.5
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 17:12:48,809 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 17:12:48,810 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:12:48,810 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 17:12:48,810 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:12:48,810 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 17:12:48,810 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,810 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,810 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,810 - utils.excel_processor - INFO - 行 20: 解析出服务项目数: 2
2025-04-08 17:12:48,811 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 17:12:48,811 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 21)
2025-04-08 17:12:48,811 - utils.excel_processor - INFO - 解析到店时间: 2023-11-02 11:00:00
2025-04-08 17:12:48,811 - utils.excel_processor - INFO - 解析离店时间: 2023-11-02 13:30:00
2025-04-08 17:12:48,811 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,811 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 17:12:48,811 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:12:48,812 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,812 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 17:12:48,812 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:12:48,812 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 17:12:48,812 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,812 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 17:12:48,812 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,812 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,813 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,813 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,813 - utils.excel_processor - INFO - 行 21: 解析出服务项目数: 1
2025-04-08 17:12:48,813 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:12:48,813 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 22)
2025-04-08 17:12:48,813 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 20:15:00
2025-04-08 17:12:48,813 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 21:45:00
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 解析满意度: 3.0/5
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 项目组 1: 美容师: 张莉
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:12:48,814 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 17:12:48,815 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,815 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,815 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,815 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,815 - utils.excel_processor - INFO - 行 22: 解析出服务项目数: 1
2025-04-08 17:12:48,815 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:12:48,815 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 23)
2025-04-08 17:12:48,816 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 19:30:00
2025-04-08 17:12:48,816 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 21:00:00
2025-04-08 17:12:48,816 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,816 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 17:12:48,816 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 17:12:48,816 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,817 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,817 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,817 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:12:48,817 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,817 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 17:12:48,817 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,817 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,817 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,817 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 行 23: 解析出服务项目数: 1
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 24)
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 20:45:00
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 22:15:00
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:12:48,818 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 2: 美容师: 张莉
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:12:48,819 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 17:12:48,820 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,820 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,820 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,820 - utils.excel_processor - INFO - 行 24: 解析出服务项目数: 2
2025-04-08 17:12:48,820 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 17:12:48,820 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 25)
2025-04-08 17:12:48,820 - utils.excel_processor - INFO - 解析到店时间: 2023-09-16 21:00:00
2025-04-08 17:12:48,820 - utils.excel_processor - INFO - 解析离店时间: 2023-09-16 23:00:00
2025-04-08 17:12:48,820 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,820 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:12:48,821 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 17:12:48,821 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,821 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,821 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,821 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,821 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,821 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 17:12:48,821 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,822 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,822 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,822 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,822 - utils.excel_processor - INFO - 行 25: 解析出服务项目数: 1
2025-04-08 17:12:48,822 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:12:48,822 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 26)
2025-04-08 17:12:48,822 - utils.excel_processor - INFO - 解析到店时间: 2023-09-30 18:30:00
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 解析离店时间: 2023-09-30 20:00:00
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 17:12:48,823 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,824 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 17:12:48,824 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,824 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,824 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,824 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,824 - utils.excel_processor - INFO - 行 26: 解析出服务项目数: 1
2025-04-08 17:12:48,824 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:12:48,824 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 27)
2025-04-08 17:12:48,824 - utils.excel_processor - INFO - 解析到店时间: 2023-10-12 19:15:00
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 解析离店时间: 2023-10-12 21:45:00
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 解析满意度: 4.2/5
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:12:48,825 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,826 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 17:12:48,826 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,826 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,826 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,826 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,826 - utils.excel_processor - INFO - 行 27: 解析出服务项目数: 1
2025-04-08 17:12:48,826 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:12:48,826 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 28)
2025-04-08 17:12:48,826 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 20:30:00
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 22:00:00
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,827 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:12:48,828 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,828 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 17:12:48,828 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,828 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,828 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,828 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,828 - utils.excel_processor - INFO - 行 28: 解析出服务项目数: 1
2025-04-08 17:12:48,829 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:12:48,829 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 29)
2025-04-08 17:12:48,829 - utils.excel_processor - INFO - 解析到店时间: 2023-11-05 21:00:00
2025-04-08 17:12:48,829 - utils.excel_processor - INFO - 解析离店时间: 2023-11-05 23:30:00
2025-04-08 17:12:48,829 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,829 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组 2: 美容师: 陈莉
2025-04-08 17:12:48,830 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:12:48,831 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:12:48,831 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 17:12:48,831 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,831 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,831 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,831 - utils.excel_processor - INFO - 行 29: 解析出服务项目数: 2
2025-04-08 17:12:48,831 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 17:12:48,831 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 30)
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 解析到店时间: 2023-11-18 18:45:00
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 解析离店时间: 2023-11-18 20:15:00
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 解析满意度: 4.3/5
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 17:12:48,832 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,833 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 17:12:48,833 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:12:48,833 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,833 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,833 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,833 - utils.excel_processor - INFO - 行 30: 解析出服务项目数: 1
2025-04-08 17:12:48,833 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:12:48,833 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 31)
2025-04-08 17:12:48,834 - utils.excel_processor - INFO - 解析到店时间: 2023-12-01 19:00:00
2025-04-08 17:12:48,834 - utils.excel_processor - INFO - 解析离店时间: 2023-12-01 21:30:00
2025-04-08 17:12:48,834 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:12:48,834 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:12:48,834 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:12:48,835 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 17:12:48,835 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:12:48,835 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:12:48,836 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 行 31: 解析出服务项目数: 2
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 17:12:48,836 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 17:12:48,837 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 17:12:48,837 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 17:12:48,837 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 17:12:48,837 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 17:12:48,837 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 17:12:48,837 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 17:12:48,838 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 17:12:48,838 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 17:12:48,838 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 17:12:48,838 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 17:12:48,838 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 17:12:48,839 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 17:12:48,839 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 17:12:48,839 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 17:12:48,839 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 17:12:48,839 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 17:12:48,840 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 17:12:48,840 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 17:12:48,840 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:12:48,840 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 17:12:48,842 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 17:12:48,842 - ExcelTest - INFO - 处理结果统计:
2025-04-08 17:12:48,842 - ExcelTest - INFO -   customers: 3项
2025-04-08 17:12:48,842 - ExcelTest - INFO -   health_records: 3项
2025-04-08 17:12:48,842 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 17:12:48,842 - ExcelTest - INFO -   services: 30项
2025-04-08 17:12:48,842 - ExcelTest - INFO -   communications: 15项
2025-04-08 17:12:48,842 - ExcelTest - INFO - 客户数据示例:
2025-04-08 17:12:48,842 - ExcelTest - INFO -   id: C001
2025-04-08 17:12:48,843 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 17:12:48,843 - ExcelTest - INFO -   gender: 女
2025-04-08 17:12:48,843 - ExcelTest - INFO -   age: 28
2025-04-08 17:12:48,843 - ExcelTest - INFO -   store: 分店A
2025-04-08 17:12:48,843 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 17:12:48,843 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 17:12:48,843 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 17:12:48,843 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 17:12:48,843 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 17:12:48,843 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 17:12:48,844 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 17:12:48,844 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 17:12:48,844 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 17:12:48,844 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 17:12:48,844 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 17:12:48,844 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 17:12:48,844 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 17:12:48,844 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 17:12:48,844 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 17:12:48,844 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 17:12:48,845 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 17:12:48,845 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 17:22:04,236 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 17:22:04,237 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 17:22:04,407 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 17:22:04,407 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 17:22:04,408 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:22:04,408 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 17:22:04,408 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 17:22:04,408 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:22:04,408 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:22:04,617 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 17:22:04,617 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 17:22:04,617 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 17:22:04,617 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 17:22:04,617 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 17:22:04,617 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 17:22:04,625 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2  ...  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别  ...    职业        单位性质         年收入
1  C001        林晓薇          女  ...  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 17:22:04,626 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 17:22:04,626 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 17:22:04,626 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 17:22:04,627 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 17:22:04,627 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 17:22:04,628 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 17:22:04,628 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 17:22:04,628 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 17:22:04,629 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 17:22:04,629 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 17:22:04,629 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 17:22:04,629 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 17:22:04,629 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 17:22:04,629 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 17:22:04,630 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 17:22:04,630 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 17:22:04,630 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 17:22:04,630 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 17:22:04,630 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 17:22:04,630 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 17:22:04,631 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 17:22:04,631 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:22:04,631 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 17:22:04,631 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:22:04,631 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 17:22:04,632 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 标题行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 找到客户ID列: 索引=0, 值=客户ID
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 找到姓名列: 索引=1, 值=姓名
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 找到到店时间列: 索引=2, 值=到店时间
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 找到离店时间列: 索引=3, 值=离店时间
2025-04-08 17:22:04,633 - utils.excel_processor - INFO - 找到总金额列: 索引=5, 值=总耗卡金额
2025-04-08 17:22:04,634 - utils.excel_processor - INFO - 找到满意度列: 索引=6, 值=服务满意度
2025-04-08 17:22:04,634 - utils.excel_processor - WARNING - 未找到总项目数列，使用默认索引: 4
2025-04-08 17:22:04,634 - utils.excel_processor - INFO - 找到项目组: 项目列=7, 美容师列=8, 金额列=9, 指定列=10
2025-04-08 17:22:04,634 - utils.excel_processor - INFO - 找到项目组: 项目列=11, 美容师列=12, 金额列=13, 指定列=14
2025-04-08 17:22:04,634 - utils.excel_processor - INFO - 找到项目组: 项目列=15, 美容师列=16, 金额列=17, 指定列=18
2025-04-08 17:22:04,634 - utils.excel_processor - INFO - 找到项目组: 项目列=19, 美容师列=20, 金额列=21, 指定列=22
2025-04-08 17:22:04,634 - utils.excel_processor - INFO - 找到项目组: 项目列=23, 美容师列=24, 金额列=25, 指定列=26
2025-04-08 17:22:04,635 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 17:22:04,635 - utils.excel_processor - INFO - 识别到5个项目组
2025-04-08 17:22:04,635 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 2)
2025-04-08 17:22:04,635 - utils.excel_processor - INFO - 解析到店时间: 2023-07-12 14:00:00
2025-04-08 17:22:04,635 - utils.excel_processor - INFO - 解析离店时间: 2023-07-12 16:30:00
2025-04-08 17:22:04,635 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 解析总金额: 680.0
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 17:22:04,636 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 项目组 2: 金额: 200.0
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 17:22:04,637 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,637 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,637 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 行 2: 解析出服务项目数: 2
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 3)
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 15:20:00
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 17:50:00
2025-04-08 17:22:04,637 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:22:04,638 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,638 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,638 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,638 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 行 3: 解析出服务项目数: 1
2025-04-08 17:22:04,638 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:22:04,639 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 4)
2025-04-08 17:22:04,639 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 10:00:00
2025-04-08 17:22:04,639 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 12:30:00
2025-04-08 17:22:04,639 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,639 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:22:04,639 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:22:04,639 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 项目组 2: 美容师: 李婷
2025-04-08 17:22:04,640 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:22:04,641 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:22:04,641 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 17:22:04,642 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,642 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,642 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,642 - utils.excel_processor - INFO - 行 4: 解析出服务项目数: 2
2025-04-08 17:22:04,642 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:22:04,642 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 5)
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 11:15:00
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 13:45:00
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:22:04,643 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,644 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:22:04,644 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,644 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,644 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,644 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,644 - utils.excel_processor - INFO - 行 5: 解析出服务项目数: 1
2025-04-08 17:22:04,644 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:22:04,645 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 6)
2025-04-08 17:22:04,645 - utils.excel_processor - INFO - 解析到店时间: 2023-08-18 14:00:00
2025-04-08 17:22:04,645 - utils.excel_processor - INFO - 解析离店时间: 2023-08-18 16:30:00
2025-04-08 17:22:04,645 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:22:04,646 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 17:22:04,647 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,647 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,647 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 行 6: 解析出服务项目数: 2
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 7)
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 09:30:00
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 12:00:00
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,647 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 17:22:04,649 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,649 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,649 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,649 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 行 7: 解析出服务项目数: 1
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 8)
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 解析到店时间: 2023-09-09 15:00:00
2025-04-08 17:22:04,649 - utils.excel_processor - INFO - 解析离店时间: 2023-09-09 17:30:00
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 解析总金额: 830.0
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:22:04,650 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 17:22:04,650 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,651 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,651 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,651 - utils.excel_processor - INFO - 行 8: 解析出服务项目数: 2
2025-04-08 17:22:04,651 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:22:04,651 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 9)
2025-04-08 17:22:04,651 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 14:20:00
2025-04-08 17:22:04,651 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 16:50:00
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 解析总金额: 677.5
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:22:04,652 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 17:22:04,653 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,653 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,653 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 行 9: 解析出服务项目数: 2
2025-04-08 17:22:04,653 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 10)
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 解析到店时间: 2023-10-05 10:45:00
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 解析离店时间: 2023-10-05 13:15:00
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,654 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 17:22:04,655 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,655 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,655 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 行 10: 解析出服务项目数: 2
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 11)
2025-04-08 17:22:04,655 - utils.excel_processor - INFO - 解析到店时间: 2023-10-18 16:00:00
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 解析离店时间: 2023-10-18 18:30:00
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,656 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,657 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 17:22:04,657 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,657 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,657 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,657 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,657 - utils.excel_processor - INFO - 行 11: 解析出服务项目数: 1
2025-04-08 17:22:04,657 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 17:22:04,657 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 12)
2025-04-08 17:22:04,658 - utils.excel_processor - INFO - 解析到店时间: 2023-07-05 09:30:00
2025-04-08 17:22:04,658 - utils.excel_processor - INFO - 解析离店时间: 2023-07-05 11:40:00
2025-04-08 17:22:04,658 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,658 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 17:22:04,658 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:22:04,658 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,658 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:22:04,659 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,659 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 17:22:04,659 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,659 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 17:22:04,659 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,659 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,659 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,659 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,659 - utils.excel_processor - INFO - 行 12: 解析出服务项目数: 1
2025-04-08 17:22:04,659 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,659 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 13)
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 10:15:00
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 12:30:00
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 17:22:04,660 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,661 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 17:22:04,661 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,661 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,661 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,661 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,661 - utils.excel_processor - INFO - 行 13: 解析出服务项目数: 1
2025-04-08 17:22:04,661 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,661 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 14)
2025-04-08 17:22:04,661 - utils.excel_processor - INFO - 解析到店时间: 2023-08-10 09:45:00
2025-04-08 17:22:04,661 - utils.excel_processor - INFO - 解析离店时间: 2023-08-10 12:00:00
2025-04-08 17:22:04,661 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:22:04,662 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 17:22:04,662 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,662 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,663 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 行 14: 解析出服务项目数: 2
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 15)
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 解析到店时间: 2023-08-17 14:30:00
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 解析离店时间: 2023-08-17 16:50:00
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,663 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,664 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,664 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,664 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,664 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 17:22:04,664 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,664 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,664 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,664 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,664 - utils.excel_processor - INFO - 行 15: 解析出服务项目数: 1
2025-04-08 17:22:04,664 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,665 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 16)
2025-04-08 17:22:04,665 - utils.excel_processor - INFO - 解析到店时间: 2023-09-05 14:00:00
2025-04-08 17:22:04,665 - utils.excel_processor - INFO - 解析离店时间: 2023-09-05 16:20:00
2025-04-08 17:22:04,665 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,665 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 17:22:04,665 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:22:04,665 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 17:22:04,666 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,666 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,666 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,666 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 行 16: 解析出服务项目数: 1
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,666 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 17)
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 10:30:00
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 12:50:00
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,667 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 17:22:04,667 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,667 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,668 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,668 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 行 17: 解析出服务项目数: 1
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 18)
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 解析到店时间: 2023-10-03 09:00:00
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 解析离店时间: 2023-10-03 11:30:00
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:22:04,668 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 17:22:04,669 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,669 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,669 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,669 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 行 18: 解析出服务项目数: 1
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 19)
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 解析到店时间: 2023-10-15 15:15:00
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 解析离店时间: 2023-10-15 17:45:00
2025-04-08 17:22:04,669 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,670 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 17:22:04,670 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,671 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,671 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,671 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,671 - utils.excel_processor - INFO - 行 19: 解析出服务项目数: 1
2025-04-08 17:22:04,671 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,671 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 20)
2025-04-08 17:22:04,671 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 13:00:00
2025-04-08 17:22:04,671 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 15:20:00
2025-04-08 17:22:04,671 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 解析总金额: 547.5
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:22:04,672 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 17:22:04,673 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,673 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,673 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 行 20: 解析出服务项目数: 2
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 21)
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 解析到店时间: 2023-11-02 11:00:00
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 解析离店时间: 2023-11-02 13:30:00
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,673 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 17:22:04,674 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,674 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,674 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,674 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 行 21: 解析出服务项目数: 1
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 22)
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 20:15:00
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 21:45:00
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 17:22:04,674 - utils.excel_processor - INFO - 解析满意度: 3.0/5
2025-04-08 17:22:04,675 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,675 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 17:22:04,675 - utils.excel_processor - INFO - 项目组 1: 美容师: 张莉
2025-04-08 17:22:04,675 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 17:22:04,675 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 17:22:04,675 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 17:22:04,675 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,675 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,675 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,675 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,675 - utils.excel_processor - INFO - 行 22: 解析出服务项目数: 1
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 23)
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 19:30:00
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 21:00:00
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 17:22:04,676 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 17:22:04,677 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,677 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,677 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,677 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 行 23: 解析出服务项目数: 1
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 24)
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 20:45:00
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 22:15:00
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:22:04,677 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 2: 美容师: 张莉
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 17:22:04,679 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 17:22:04,679 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,679 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,680 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 行 24: 解析出服务项目数: 2
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 25)
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 解析到店时间: 2023-09-16 21:00:00
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 解析离店时间: 2023-09-16 23:00:00
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,680 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,681 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,681 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,681 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,681 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 17:22:04,681 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,681 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,681 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,681 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,681 - utils.excel_processor - INFO - 行 25: 解析出服务项目数: 1
2025-04-08 17:22:04,681 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:22:04,681 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 26)
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 解析到店时间: 2023-09-30 18:30:00
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 解析离店时间: 2023-09-30 20:00:00
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 17:22:04,682 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,683 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 17:22:04,683 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,683 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 17:22:04,683 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,683 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,683 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,683 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,683 - utils.excel_processor - INFO - 行 26: 解析出服务项目数: 1
2025-04-08 17:22:04,683 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:22:04,683 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 27)
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 解析到店时间: 2023-10-12 19:15:00
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 解析离店时间: 2023-10-12 21:45:00
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 解析满意度: 4.2/5
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,684 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 17:22:04,684 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,684 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,685 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,685 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 行 27: 解析出服务项目数: 1
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 28)
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 20:30:00
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 22:00:00
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,685 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 17:22:04,686 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,686 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,686 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,686 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 行 28: 解析出服务项目数: 1
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 29)
2025-04-08 17:22:04,686 - utils.excel_processor - INFO - 解析到店时间: 2023-11-05 21:00:00
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 解析离店时间: 2023-11-05 23:30:00
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 2: 美容师: 陈莉
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 17:22:04,687 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:22:04,688 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 17:22:04,688 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,688 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,688 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,688 - utils.excel_processor - INFO - 行 29: 解析出服务项目数: 2
2025-04-08 17:22:04,688 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 17:22:04,688 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 30)
2025-04-08 17:22:04,688 - utils.excel_processor - INFO - 解析到店时间: 2023-11-18 18:45:00
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 解析离店时间: 2023-11-18 20:15:00
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 解析满意度: 4.3/5
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 17:22:04,689 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,690 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 17:22:04,690 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 17:22:04,690 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,690 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,690 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,690 - utils.excel_processor - INFO - 行 30: 解析出服务项目数: 1
2025-04-08 17:22:04,690 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 17:22:04,690 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 31)
2025-04-08 17:22:04,690 - utils.excel_processor - INFO - 解析到店时间: 2023-12-01 19:00:00
2025-04-08 17:22:04,690 - utils.excel_processor - INFO - 解析离店时间: 2023-12-01 21:30:00
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 17:22:04,691 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 17:22:04,692 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 17:22:04,692 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 17:22:04,692 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 行 31: 解析出服务项目数: 2
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 17:22:04,692 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 17:22:04,693 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 17:22:04,693 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 17:22:04,693 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 17:22:04,693 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 17:22:04,693 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 17:22:04,693 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 17:22:04,694 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 17:22:04,694 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 17:22:04,694 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 17:22:04,694 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 17:22:04,694 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 17:22:04,694 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 17:22:04,695 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 17:22:04,695 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 17:22:04,695 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 17:22:04,695 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 17:22:04,695 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 17:22:04,695 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 17:22:04,695 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 17:22:04,695 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 17:22:04,696 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 17:22:04,697 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 17:22:04,697 - ExcelTest - INFO - 处理结果统计:
2025-04-08 17:22:04,697 - ExcelTest - INFO -   customers: 3项
2025-04-08 17:22:04,697 - ExcelTest - INFO -   health_records: 3项
2025-04-08 17:22:04,697 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 17:22:04,697 - ExcelTest - INFO -   services: 30项
2025-04-08 17:22:04,697 - ExcelTest - INFO -   communications: 15项
2025-04-08 17:22:04,699 - ExcelTest - INFO - 客户数据示例:
2025-04-08 17:22:04,699 - ExcelTest - INFO -   id: C001
2025-04-08 17:22:04,699 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 17:22:04,699 - ExcelTest - INFO -   gender: 女
2025-04-08 17:22:04,699 - ExcelTest - INFO -   age: 28
2025-04-08 17:22:04,699 - ExcelTest - INFO -   store: 分店A
2025-04-08 17:22:04,699 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 17:22:04,699 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 17:22:04,699 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 17:22:04,699 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 17:22:04,699 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 17:22:04,699 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 17:22:04,699 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 17:22:04,699 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 17:22:04,699 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 17:22:04,699 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 17:22:04,699 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 17:22:04,700 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 17:22:04,700 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 17:22:04,700 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 17:22:04,700 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 17:22:04,700 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 17:22:04,700 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 17:22:04,700 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 18:11:15,824 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 18:11:15,824 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 18:11:16,006 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 18:11:16,006 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 18:11:16,006 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:11:16,006 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 18:11:16,006 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 18:11:16,007 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:11:16,007 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:11:16,283 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 18:11:16,283 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 18:11:16,283 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 18:11:16,283 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 18:11:16,283 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 18:11:16,284 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 18:11:16,291 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 18:11:16,291 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 18:11:16,291 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 18:11:16,292 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 18:11:16,292 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 18:11:16,293 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 18:11:16,293 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 18:11:16,294 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 18:11:16,294 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 18:11:16,294 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 18:11:16,294 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 18:11:16,294 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 18:11:16,294 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 18:11:16,294 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 18:11:16,295 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 18:11:16,295 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 18:11:16,295 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 18:11:16,295 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 18:11:16,295 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 18:11:16,295 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 18:11:16,296 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 18:11:16,296 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 18:11:16,296 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:11:16,296 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 18:11:16,296 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 18:11:16,297 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 18:11:16,298 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 18:11:16,298 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 18:11:16,298 - utils.excel_processor - INFO - 标题行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到客户ID列: 索引=0, 值=客户ID
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到姓名列: 索引=1, 值=姓名
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到到店时间列: 索引=2, 值=到店时间
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到离店时间列: 索引=3, 值=离店时间
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到总金额列: 索引=5, 值=总耗卡金额
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到满意度列: 索引=6, 值=服务满意度
2025-04-08 18:11:16,299 - utils.excel_processor - WARNING - 未找到总项目数列，使用默认索引: 4
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到项目组: 项目列=7, 美容师列=8, 金额列=9, 指定列=10
2025-04-08 18:11:16,299 - utils.excel_processor - INFO - 找到项目组: 项目列=11, 美容师列=12, 金额列=13, 指定列=14
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 找到项目组: 项目列=15, 美容师列=16, 金额列=17, 指定列=18
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 找到项目组: 项目列=19, 美容师列=20, 金额列=21, 指定列=22
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 找到项目组: 项目列=23, 美容师列=24, 金额列=25, 指定列=26
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 识别到5个项目组
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 2)
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 解析到店时间: 2023-07-12 14:00:00
2025-04-08 18:11:16,300 - utils.excel_processor - INFO - 解析离店时间: 2023-07-12 16:30:00
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 解析总金额: 680.0
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:11:16,301 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 18:11:16,302 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 18:11:16,302 - utils.excel_processor - INFO - 项目组 2: 金额: 200.0
2025-04-08 18:11:16,302 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:11:16,302 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 18:11:16,302 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,302 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,302 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,302 - utils.excel_processor - INFO - 行 2: 解析出服务项目数: 2
2025-04-08 18:11:16,302 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:11:16,302 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 3)
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 15:20:00
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 17:50:00
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:11:16,303 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,304 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:11:16,304 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,304 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,304 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,304 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,304 - utils.excel_processor - INFO - 行 3: 解析出服务项目数: 1
2025-04-08 18:11:16,304 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:11:16,305 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 4)
2025-04-08 18:11:16,305 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 10:00:00
2025-04-08 18:11:16,305 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 12:30:00
2025-04-08 18:11:16,305 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,305 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:11:16,305 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 2: 美容师: 李婷
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:11:16,306 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 18:11:16,306 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,307 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,307 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,307 - utils.excel_processor - INFO - 行 4: 解析出服务项目数: 2
2025-04-08 18:11:16,307 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:11:16,307 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 5)
2025-04-08 18:11:16,307 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 11:15:00
2025-04-08 18:11:16,307 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 13:45:00
2025-04-08 18:11:16,307 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:11:16,308 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,308 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,308 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,308 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 行 5: 解析出服务项目数: 1
2025-04-08 18:11:16,308 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:11:16,309 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 6)
2025-04-08 18:11:16,309 - utils.excel_processor - INFO - 解析到店时间: 2023-08-18 14:00:00
2025-04-08 18:11:16,309 - utils.excel_processor - INFO - 解析离店时间: 2023-08-18 16:30:00
2025-04-08 18:11:16,309 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,310 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 18:11:16,310 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:11:16,310 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:11:16,310 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,310 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:11:16,310 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,311 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,311 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 18:11:16,311 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:11:16,311 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:11:16,311 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:11:16,311 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:11:16,311 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 18:11:16,312 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,312 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,312 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,312 - utils.excel_processor - INFO - 行 6: 解析出服务项目数: 2
2025-04-08 18:11:16,312 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:11:16,312 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 7)
2025-04-08 18:11:16,312 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 09:30:00
2025-04-08 18:11:16,312 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 12:00:00
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,313 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 18:11:16,313 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,313 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,313 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,314 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 行 7: 解析出服务项目数: 1
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 8)
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 解析到店时间: 2023-09-09 15:00:00
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 解析离店时间: 2023-09-09 17:30:00
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 解析总金额: 830.0
2025-04-08 18:11:16,314 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 18:11:16,315 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:11:16,316 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 18:11:16,316 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,316 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,316 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,316 - utils.excel_processor - INFO - 行 8: 解析出服务项目数: 2
2025-04-08 18:11:16,316 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:11:16,317 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 9)
2025-04-08 18:11:16,317 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 14:20:00
2025-04-08 18:11:16,317 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 16:50:00
2025-04-08 18:11:16,317 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,317 - utils.excel_processor - INFO - 解析总金额: 677.5
2025-04-08 18:11:16,317 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 18:11:16,318 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:11:16,319 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:11:16,319 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 18:11:16,319 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,319 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,319 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,319 - utils.excel_processor - INFO - 行 9: 解析出服务项目数: 2
2025-04-08 18:11:16,319 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:11:16,319 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 10)
2025-04-08 18:11:16,319 - utils.excel_processor - INFO - 解析到店时间: 2023-10-05 10:45:00
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 解析离店时间: 2023-10-05 13:15:00
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:11:16,320 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 18:11:16,321 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,321 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,321 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 行 10: 解析出服务项目数: 2
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 11)
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 解析到店时间: 2023-10-18 16:00:00
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 解析离店时间: 2023-10-18 18:30:00
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:11:16,321 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 18:11:16,322 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,322 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,322 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,322 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,322 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,322 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 18:11:16,322 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,322 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,322 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,323 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,323 - utils.excel_processor - INFO - 行 11: 解析出服务项目数: 1
2025-04-08 18:11:16,323 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:11:16,323 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 12)
2025-04-08 18:11:16,323 - utils.excel_processor - INFO - 解析到店时间: 2023-07-05 09:30:00
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 解析离店时间: 2023-07-05 11:40:00
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 18:11:16,324 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 18:11:16,325 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,325 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,325 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,325 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 行 12: 解析出服务项目数: 1
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 13)
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 10:15:00
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 12:30:00
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,325 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 18:11:16,326 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,326 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 18:11:16,326 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,326 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 18:11:16,326 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,326 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,326 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,326 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,326 - utils.excel_processor - INFO - 行 13: 解析出服务项目数: 1
2025-04-08 18:11:16,326 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,326 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 14)
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 解析到店时间: 2023-08-10 09:45:00
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 解析离店时间: 2023-08-10 12:00:00
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,327 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:11:16,328 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 18:11:16,329 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,329 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,329 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,329 - utils.excel_processor - INFO - 行 14: 解析出服务项目数: 2
2025-04-08 18:11:16,329 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 18:11:16,329 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 15)
2025-04-08 18:11:16,329 - utils.excel_processor - INFO - 解析到店时间: 2023-08-17 14:30:00
2025-04-08 18:11:16,329 - utils.excel_processor - INFO - 解析离店时间: 2023-08-17 16:50:00
2025-04-08 18:11:16,329 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 18:11:16,330 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,330 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,330 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,330 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 行 15: 解析出服务项目数: 1
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,330 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 16)
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 解析到店时间: 2023-09-05 14:00:00
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 解析离店时间: 2023-09-05 16:20:00
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,332 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 18:11:16,332 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,332 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,333 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,333 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,333 - utils.excel_processor - INFO - 行 16: 解析出服务项目数: 1
2025-04-08 18:11:16,333 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,333 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 17)
2025-04-08 18:11:16,333 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 10:30:00
2025-04-08 18:11:16,333 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 12:50:00
2025-04-08 18:11:16,333 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,333 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 18:11:16,334 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 18:11:16,334 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,334 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:11:16,334 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 18:11:16,334 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 18:11:16,334 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,334 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 18:11:16,335 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,335 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,335 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,335 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,335 - utils.excel_processor - INFO - 行 17: 解析出服务项目数: 1
2025-04-08 18:11:16,335 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,336 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 18)
2025-04-08 18:11:16,336 - utils.excel_processor - INFO - 解析到店时间: 2023-10-03 09:00:00
2025-04-08 18:11:16,336 - utils.excel_processor - INFO - 解析离店时间: 2023-10-03 11:30:00
2025-04-08 18:11:16,336 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,336 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 18:11:16,336 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:11:16,336 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,337 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:11:16,337 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:11:16,337 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:11:16,337 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,337 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:11:16,337 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,337 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,337 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,337 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,337 - utils.excel_processor - INFO - 行 18: 解析出服务项目数: 1
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 19)
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 解析到店时间: 2023-10-15 15:15:00
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 解析离店时间: 2023-10-15 17:45:00
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,338 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,339 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,339 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,339 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,339 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 18:11:16,339 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,339 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,339 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,339 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,339 - utils.excel_processor - INFO - 行 19: 解析出服务项目数: 1
2025-04-08 18:11:16,340 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,340 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 20)
2025-04-08 18:11:16,340 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 13:00:00
2025-04-08 18:11:16,340 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 15:20:00
2025-04-08 18:11:16,340 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,340 - utils.excel_processor - INFO - 解析总金额: 547.5
2025-04-08 18:11:16,340 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:11:16,341 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 18:11:16,341 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:11:16,341 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 18:11:16,341 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 18:11:16,341 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,341 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 18:11:16,341 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 18:11:16,342 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:11:16,342 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 18:11:16,342 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:11:16,342 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 18:11:16,342 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,342 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,342 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,342 - utils.excel_processor - INFO - 行 20: 解析出服务项目数: 2
2025-04-08 18:11:16,342 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 18:11:16,342 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 21)
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 解析到店时间: 2023-11-02 11:00:00
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 解析离店时间: 2023-11-02 13:30:00
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 18:11:16,343 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:11:16,344 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 18:11:16,344 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,344 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 18:11:16,344 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,344 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,344 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,344 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,344 - utils.excel_processor - INFO - 行 21: 解析出服务项目数: 1
2025-04-08 18:11:16,344 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:11:16,344 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 22)
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 20:15:00
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 21:45:00
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 解析满意度: 3.0/5
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 18:11:16,345 - utils.excel_processor - INFO - 项目组 1: 美容师: 张莉
2025-04-08 18:11:16,346 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 18:11:16,346 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:11:16,346 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 18:11:16,346 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,346 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,346 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,346 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,347 - utils.excel_processor - INFO - 行 22: 解析出服务项目数: 1
2025-04-08 18:11:16,347 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:11:16,347 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 23)
2025-04-08 18:11:16,347 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 19:30:00
2025-04-08 18:11:16,347 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 21:00:00
2025-04-08 18:11:16,347 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,348 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 18:11:16,348 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,348 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,348 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,349 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,349 - utils.excel_processor - INFO - 行 23: 解析出服务项目数: 1
2025-04-08 18:11:16,349 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:11:16,349 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 24)
2025-04-08 18:11:16,349 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 20:45:00
2025-04-08 18:11:16,349 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 22:15:00
2025-04-08 18:11:16,349 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,349 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 2: 美容师: 张莉
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:11:16,350 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 18:11:16,350 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,350 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,351 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 行 24: 解析出服务项目数: 2
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 25)
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 解析到店时间: 2023-09-16 21:00:00
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 解析离店时间: 2023-09-16 23:00:00
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:11:16,351 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 18:11:16,352 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,352 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,352 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,352 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,352 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,352 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 18:11:16,352 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,352 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,352 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,352 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,353 - utils.excel_processor - INFO - 行 25: 解析出服务项目数: 1
2025-04-08 18:11:16,353 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:11:16,353 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 26)
2025-04-08 18:11:16,353 - utils.excel_processor - INFO - 解析到店时间: 2023-09-30 18:30:00
2025-04-08 18:11:16,353 - utils.excel_processor - INFO - 解析离店时间: 2023-09-30 20:00:00
2025-04-08 18:11:16,353 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,353 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 18:11:16,354 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,354 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,354 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,354 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,354 - utils.excel_processor - INFO - 行 26: 解析出服务项目数: 1
2025-04-08 18:11:16,355 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:11:16,355 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 27)
2025-04-08 18:11:16,355 - utils.excel_processor - INFO - 解析到店时间: 2023-10-12 19:15:00
2025-04-08 18:11:16,355 - utils.excel_processor - INFO - 解析离店时间: 2023-10-12 21:45:00
2025-04-08 18:11:16,355 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,355 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 18:11:16,356 - utils.excel_processor - INFO - 解析满意度: 4.2/5
2025-04-08 18:11:16,356 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,356 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:11:16,356 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,356 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:11:16,356 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,356 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 18:11:16,356 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,357 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,357 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,357 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,357 - utils.excel_processor - INFO - 行 27: 解析出服务项目数: 1
2025-04-08 18:11:16,357 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:11:16,357 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 28)
2025-04-08 18:11:16,357 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 20:30:00
2025-04-08 18:11:16,357 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 22:00:00
2025-04-08 18:11:16,357 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,358 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 18:11:16,358 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,359 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,359 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,359 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,359 - utils.excel_processor - INFO - 行 28: 解析出服务项目数: 1
2025-04-08 18:11:16,359 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:11:16,359 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 29)
2025-04-08 18:11:16,359 - utils.excel_processor - INFO - 解析到店时间: 2023-11-05 21:00:00
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 解析离店时间: 2023-11-05 23:30:00
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,360 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 项目组 2: 美容师: 陈莉
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 18:11:16,361 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,361 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,361 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 行 29: 解析出服务项目数: 2
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 18:11:16,361 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 30)
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 解析到店时间: 2023-11-18 18:45:00
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 解析离店时间: 2023-11-18 20:15:00
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 解析满意度: 4.3/5
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,362 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 18:11:16,363 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:11:16,363 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,363 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,363 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,363 - utils.excel_processor - INFO - 行 30: 解析出服务项目数: 1
2025-04-08 18:11:16,363 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:11:16,363 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 31)
2025-04-08 18:11:16,363 - utils.excel_processor - INFO - 解析到店时间: 2023-12-01 19:00:00
2025-04-08 18:11:16,363 - utils.excel_processor - INFO - 解析离店时间: 2023-12-01 21:30:00
2025-04-08 18:11:16,363 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:11:16,364 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:11:16,364 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:11:16,364 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 18:11:16,364 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:11:16,364 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:11:16,364 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:11:16,364 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:11:16,365 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 18:11:16,365 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:11:16,365 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:11:16,365 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:11:16,365 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:11:16,365 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 18:11:16,365 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:11:16,365 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:11:16,366 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 行 31: 解析出服务项目数: 2
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 18:11:16,366 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 18:11:16,367 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 18:11:16,367 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 18:11:16,367 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 18:11:16,367 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 18:11:16,367 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 18:11:16,367 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 18:11:16,368 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 18:11:16,369 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 18:11:16,369 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 18:11:16,369 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 18:11:16,369 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 18:11:16,369 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 18:11:16,369 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:11:16,369 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 18:11:16,372 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 18:11:16,372 - ExcelTest - INFO - 处理结果统计:
2025-04-08 18:11:16,372 - ExcelTest - INFO -   customers: 3项
2025-04-08 18:11:16,372 - ExcelTest - INFO -   health_records: 3项
2025-04-08 18:11:16,372 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 18:11:16,372 - ExcelTest - INFO -   services: 30项
2025-04-08 18:11:16,372 - ExcelTest - INFO -   communications: 15项
2025-04-08 18:11:16,372 - ExcelTest - INFO - 客户数据示例:
2025-04-08 18:11:16,372 - ExcelTest - INFO -   id: C001
2025-04-08 18:11:16,372 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 18:11:16,372 - ExcelTest - INFO -   gender: 女
2025-04-08 18:11:16,372 - ExcelTest - INFO -   age: 28
2025-04-08 18:11:16,372 - ExcelTest - INFO -   store: 分店A
2025-04-08 18:11:16,372 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 18:11:16,372 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 18:11:16,372 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 18:11:16,373 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 18:11:16,373 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 18:11:16,373 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 18:11:16,373 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 18:11:16,373 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 18:11:16,373 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 18:11:16,373 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 18:11:16,373 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 18:11:16,373 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 18:11:16,373 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 18:11:16,373 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 18:11:16,373 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 18:11:16,373 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 18:11:16,374 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 18:11:16,374 - ExcelTest - INFO - ==== Excel处理测试完成 ====
2025-04-08 18:19:10,438 - numexpr.utils - INFO - Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-04-08 18:19:10,438 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-04-08 18:19:10,617 - ExcelTest - INFO - 成功导入ExcelProcessor模块
2025-04-08 18:19:10,617 - ExcelTest - INFO - ==== 开始Excel处理测试 ====
2025-04-08 18:19:10,617 - ExcelTest - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:19:10,617 - ExcelTest - INFO - 成功创建ExcelProcessor实例
2025-04-08 18:19:10,617 - ExcelTest - INFO - 开始调用process_file方法
2025-04-08 18:19:10,617 - utils.excel_processor - INFO - 开始处理Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:19:10,618 - utils.excel_processor - INFO - 使用pandas读取Excel文件: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:19:10,828 - utils.excel_processor - INFO - 读取到的Sheet页: ['客户', '健康档案', '沟通记录', '消费', '消耗']
2025-04-08 18:19:10,829 - utils.excel_processor - INFO - 尝试使用'客户'Sheet页作为客户信息表
2025-04-08 18:19:10,829 - utils.excel_processor - INFO - '客户'列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', '地域背景', 'Unnamed: 6', 'Unnamed: 7', '家庭结构', 'Unnamed: 9', 'Unnamed: 10', '性格及消费心理', 'Unnamed: 12', 'Unnamed: 13', '生活习惯', 'Unnamed: 15', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '社会关系', 'Unnamed: 20', 'Unnamed: 21']
2025-04-08 18:19:10,829 - utils.excel_processor - INFO - 开始处理客户数据
2025-04-08 18:19:10,829 - utils.excel_processor - INFO - DataFrame形状: (4, 22)
2025-04-08 18:19:10,830 - utils.excel_processor - INFO - DataFrame前2行数据类型: 基础信息           object
Unnamed: 1     object
Unnamed: 2     object
Unnamed: 3     object
Unnamed: 4     object
地域背景           object
Unnamed: 6     object
Unnamed: 7     object
家庭结构           object
Unnamed: 9     object
Unnamed: 10    object
性格及消费心理        object
Unnamed: 12    object
Unnamed: 13    object
生活习惯           object
Unnamed: 15    object
Unnamed: 16    object
Unnamed: 17    object
Unnamed: 18    object
社会关系           object
Unnamed: 20    object
Unnamed: 21    object
dtype: object
2025-04-08 18:19:10,837 - utils.excel_processor - INFO - DataFrame前2行数据: 
   基础信息 Unnamed: 1 Unnamed: 2 Unnamed: 3  ... Unnamed: 18  社会关系 Unnamed: 20 Unnamed: 21
0  客户ID         姓名         性别         年龄  ...      家族遗传病史    职业        单位性质         年收入
1  C001        林晓薇          女         28  ...           无  时尚编辑        外资企业         35万

[2 rows x 22 columns]
2025-04-08 18:19:10,837 - utils.excel_processor - INFO - 第一行内容: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 18:19:10,837 - utils.excel_processor - INFO - 第一行是标题行，将作为新的列名
2025-04-08 18:19:10,838 - utils.excel_processor - INFO - 新列名: ['客户ID', '姓名', '性别', '年龄', '门店归属', '籍贯', '现居地', '居住时长', '家庭成员构成', '家庭人员年龄分布', '家庭居住情况', '性格类型标签', '消费决策主导', '风险敏感度', '兴趣爱好', '作息规律', '饮食偏好', '生理期', '家族遗传病史', '职业', '单位性质', '年收入']
2025-04-08 18:19:10,838 - utils.excel_processor - INFO - 处理客户ID: C001
2025-04-08 18:19:10,838 - utils.excel_processor - INFO - 处理客户ID: C002
2025-04-08 18:19:10,838 - utils.excel_processor - INFO - 处理客户ID: C003
2025-04-08 18:19:10,838 - utils.excel_processor - INFO - 处理完成: 共处理3条客户记录，跳过0条无效记录
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 处理后的客户ID样本: ['C001', 'C002', 'C003']
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 处理客户信息完成，共3条记录
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 开始处理'健康档案'Sheet页
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 开始处理健康档案记录
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 检测到第一行是标题行，将其作为新的列名
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 新的列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '肤质类型', '水油情况', '毛孔与黑头', '皱纹与纹理', '色素沉着', '光老化与炎症', '中医体质类型', '舌象特征', '脉象数据', '作息规律', '运动频率及类型', '饮食禁忌/偏好', '护理时间灵活度', '手法力度偏好', '环境氛围要求', '短期美丽目标', '长期美丽目标', '短期健康目标', '长期健康目标', '医美操作史', '大健康服务史', '重大疾病历史', '过敏史']
2025-04-08 18:19:10,839 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'skin_type', 'oil_water_balance', 'pores_blackheads', 'wrinkles_texture', 'pigmentation', 'photoaging_inflammation', 'tcm_constitution', 'tongue_features', 'pulse_data', 'sleep_routine', 'exercise_pattern', 'diet_restrictions', 'care_time_flexibility', 'massage_pressure_preference', 'environment_requirements', 'short_term_beauty_goal', 'long_term_beauty_goal', 'short_term_health_goal', 'long_term_health_goal', 'medical_cosmetic_history', 'wellness_service_history', 'major_disease_history', 'allergies']
2025-04-08 18:19:10,840 - utils.excel_processor - INFO - 处理健康档案记录完成，共3条记录
2025-04-08 18:19:10,840 - utils.excel_processor - INFO - 处理健康档案完成，共3条记录
2025-04-08 18:19:10,840 - utils.excel_processor - INFO - 尝试使用'消费'Sheet页作为消费记录表
2025-04-08 18:19:10,840 - utils.excel_processor - INFO - 开始处理消费记录
2025-04-08 18:19:10,841 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '消费时间', '项目名称', '消费金额', '支付方式', '总次数', '耗卡完成时间', '项目满意度']
2025-04-08 18:19:10,841 - utils.excel_processor - INFO - 映射后列名: ['customer_id', 'name', 'date', 'project_name', 'amount', 'payment_method', 'total_sessions', 'completion_date', 'satisfaction']
2025-04-08 18:19:10,841 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:19:10,841 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 提取总次数: 原始值 8次 -> 8
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 提取总次数: 原始值 10次 -> 10
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 提取总次数: 原始值 3次 -> 3
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 提取总次数: 原始值 6次 -> 6
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 提取总次数: 原始值 5次 -> 5
2025-04-08 18:19:10,842 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 18:19:10,844 - utils.excel_processor - INFO - 处理消费记录完成，共9条记录
2025-04-08 18:19:10,844 - utils.excel_processor - INFO - 开始处理'消耗'Sheet页
2025-04-08 18:19:10,844 - utils.excel_processor - INFO - DataFrame形状: (31, 27)
2025-04-08 18:19:10,844 - utils.excel_processor - INFO - 原始列名: ['基础信息', 'Unnamed: 1', 'Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4', 'Unnamed: 5', 'Unnamed: 6', '消耗项目1', 'Unnamed: 8', 'Unnamed: 9', 'Unnamed: 10', '消耗项目2', 'Unnamed: 12', 'Unnamed: 13', 'Unnamed: 14', '消耗项目3', 'Unnamed: 16', 'Unnamed: 17', 'Unnamed: 18', '消耗项目4', 'Unnamed: 20', 'Unnamed: 21', 'Unnamed: 22', '消耗项目5', 'Unnamed: 24', 'Unnamed: 25', 'Unnamed: 26']
2025-04-08 18:19:10,844 - utils.excel_processor - INFO - 找到标题行: 第1行, 数据从第2行开始
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 标题行内容: ['客户ID', '姓名', '到店时间', '离店时间', '总消耗项目数', '总耗卡金额', '服务满意度', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定', '项目内容', '操作美容师', '耗卡金额', '是否指定']
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到客户ID列: 索引=0, 值=客户ID
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到姓名列: 索引=1, 值=姓名
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到到店时间列: 索引=2, 值=到店时间
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到离店时间列: 索引=3, 值=离店时间
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到总金额列: 索引=5, 值=总耗卡金额
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到满意度列: 索引=6, 值=服务满意度
2025-04-08 18:19:10,845 - utils.excel_processor - WARNING - 未找到总项目数列，使用默认索引: 4
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到项目组: 项目列=7, 美容师列=8, 金额列=9, 指定列=10
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到项目组: 项目列=11, 美容师列=12, 金额列=13, 指定列=14
2025-04-08 18:19:10,845 - utils.excel_processor - INFO - 找到项目组: 项目列=15, 美容师列=16, 金额列=17, 指定列=18
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 找到项目组: 项目列=19, 美容师列=20, 金额列=21, 指定列=22
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 找到项目组: 项目列=23, 美容师列=24, 金额列=25, 指定列=26
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 使用第2行开始作为数据，第1行作为标题
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 识别到5个项目组
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 2)
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 解析到店时间: 2023-07-12 14:00:00
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 解析离店时间: 2023-07-12 16:30:00
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 解析总金额: 680.0
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:19:10,846 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 2: 金额: 200.0
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:19:10,847 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 张伟 - 200.0元 - 未指定
2025-04-08 18:19:10,847 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,847 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,847 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 行 2: 解析出服务项目数: 2
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 3)
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 15:20:00
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 17:50:00
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:19:10,848 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,849 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,849 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:19:10,849 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:19:10,849 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,849 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:19:10,849 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,849 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,849 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,849 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,849 - utils.excel_processor - INFO - 行 3: 解析出服务项目数: 1
2025-04-08 18:19:10,849 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:19:10,850 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 4)
2025-04-08 18:19:10,850 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 10:00:00
2025-04-08 18:19:10,850 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 12:30:00
2025-04-08 18:19:10,850 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,850 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:19:10,850 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 2: 美容师: 李婷
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 未指定
2025-04-08 18:19:10,851 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,851 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,851 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 行 4: 解析出服务项目数: 2
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 5)
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 11:15:00
2025-04-08 18:19:10,851 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 13:45:00
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,852 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:19:10,852 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,852 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,852 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,853 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 行 5: 解析出服务项目数: 1
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 6)
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 解析到店时间: 2023-08-18 14:00:00
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 解析离店时间: 2023-08-18 16:30:00
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:19:10,853 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 李婷 - 533.0元 - 指定
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:19:10,854 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 18:19:10,854 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,854 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,855 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,855 - utils.excel_processor - INFO - 行 6: 解析出服务项目数: 2
2025-04-08 18:19:10,855 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:19:10,855 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 7)
2025-04-08 18:19:10,856 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 09:30:00
2025-04-08 18:19:10,856 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 12:00:00
2025-04-08 18:19:10,856 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,856 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:19:10,856 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 18:19:10,856 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,856 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,857 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,857 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,857 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,857 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 18:19:10,857 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,857 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,857 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,857 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,857 - utils.excel_processor - INFO - 行 7: 解析出服务项目数: 1
2025-04-08 18:19:10,857 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:19:10,857 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 8)
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 解析到店时间: 2023-09-09 15:00:00
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 解析离店时间: 2023-09-09 17:30:00
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 解析总金额: 830.0
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,858 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 18:19:10,859 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,859 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,859 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 行 8: 解析出服务项目数: 2
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:19:10,859 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 9)
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 14:20:00
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 16:50:00
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 解析总金额: 677.5
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组 1: 美容师: 李婷
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 李婷 - 480.0元 - 指定
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组 2: 美容师: 张伟
2025-04-08 18:19:10,860 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:19:10,861 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:19:10,861 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 张伟 - 197.5元 - 指定
2025-04-08 18:19:10,861 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,861 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,861 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,861 - utils.excel_processor - INFO - 行 9: 解析出服务项目数: 2
2025-04-08 18:19:10,861 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:19:10,861 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 10)
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 解析到店时间: 2023-10-05 10:45:00
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 解析离店时间: 2023-10-05 13:15:00
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '颈部导入', '项目3': 'N/A'}
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:19:10,862 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 颈部导入
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 创建服务项目: 颈部导入 - 王芳 - 480.0元 - 未指定
2025-04-08 18:19:10,863 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,863 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,863 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 行 10: 解析出服务项目数: 2
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=2
2025-04-08 18:19:10,863 - utils.excel_processor - INFO - 处理客户: C001 - 林晓薇 (行 11)
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 解析到店时间: 2023-10-18 16:00:00
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 解析离店时间: 2023-10-18 18:30:00
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,864 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 未指定
2025-04-08 18:19:10,864 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,865 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,865 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,865 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,865 - utils.excel_processor - INFO - 行 11: 解析出服务项目数: 1
2025-04-08 18:19:10,865 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C001, 项目数=1
2025-04-08 18:19:10,865 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 12)
2025-04-08 18:19:10,865 - utils.excel_processor - INFO - 解析到店时间: 2023-07-05 09:30:00
2025-04-08 18:19:10,865 - utils.excel_processor - INFO - 解析离店时间: 2023-07-05 11:40:00
2025-04-08 18:19:10,865 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 未指定
2025-04-08 18:19:10,866 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,866 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,866 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,866 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 行 12: 解析出服务项目数: 1
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,866 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 13)
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 解析到店时间: 2023-07-19 10:15:00
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 解析离店时间: 2023-07-19 12:30:00
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 18:19:10,867 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,868 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 18:19:10,868 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,868 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 18:19:10,868 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,868 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,868 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,868 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,868 - utils.excel_processor - INFO - 行 13: 解析出服务项目数: 1
2025-04-08 18:19:10,868 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,868 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 14)
2025-04-08 18:19:10,868 - utils.excel_processor - INFO - 解析到店时间: 2023-08-10 09:45:00
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 解析离店时间: 2023-08-10 12:00:00
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 陈莉 - 533.0元 - 未指定
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:19:10,869 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:19:10,870 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:19:10,870 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:19:10,870 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 王芳 - 197.5元 - 指定
2025-04-08 18:19:10,870 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,870 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,870 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,870 - utils.excel_processor - INFO - 行 14: 解析出服务项目数: 2
2025-04-08 18:19:10,870 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 18:19:10,870 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 15)
2025-04-08 18:19:10,871 - utils.excel_processor - INFO - 解析到店时间: 2023-08-17 14:30:00
2025-04-08 18:19:10,871 - utils.excel_processor - INFO - 解析离店时间: 2023-08-17 16:50:00
2025-04-08 18:19:10,871 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,871 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:19:10,871 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 18:19:10,871 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,871 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,872 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,872 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,872 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,872 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 18:19:10,872 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,873 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,873 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,873 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,873 - utils.excel_processor - INFO - 行 15: 解析出服务项目数: 1
2025-04-08 18:19:10,873 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,873 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 16)
2025-04-08 18:19:10,873 - utils.excel_processor - INFO - 解析到店时间: 2023-09-05 14:00:00
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 解析离店时间: 2023-09-05 16:20:00
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,874 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 18:19:10,874 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,875 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,875 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,875 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,875 - utils.excel_processor - INFO - 行 16: 解析出服务项目数: 1
2025-04-08 18:19:10,875 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,875 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 17)
2025-04-08 18:19:10,875 - utils.excel_processor - INFO - 解析到店时间: 2023-09-20 10:30:00
2025-04-08 18:19:10,875 - utils.excel_processor - INFO - 解析离店时间: 2023-09-20 12:50:00
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 解析总金额: 197.5
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 18:19:10,876 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,877 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 18:19:10,877 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,877 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,877 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,877 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,877 - utils.excel_processor - INFO - 行 17: 解析出服务项目数: 1
2025-04-08 18:19:10,877 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,877 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 18)
2025-04-08 18:19:10,877 - utils.excel_processor - INFO - 解析到店时间: 2023-10-03 09:00:00
2025-04-08 18:19:10,877 - utils.excel_processor - INFO - 解析离店时间: 2023-10-03 11:30:00
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 项目组 1: 美容师: 张伟
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,878 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 张伟 - 1360.0元 - 未指定
2025-04-08 18:19:10,878 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,878 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,878 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,878 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 行 18: 解析出服务项目数: 1
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 19)
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 解析到店时间: 2023-10-15 15:15:00
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 解析离店时间: 2023-10-15 17:45:00
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 解析满意度: 5.0/5
2025-04-08 18:19:10,879 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,880 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,880 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,880 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,880 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,880 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 王芳 - 533.0元 - 指定
2025-04-08 18:19:10,880 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,880 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,880 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,880 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,880 - utils.excel_processor - INFO - 行 19: 解析出服务项目数: 1
2025-04-08 18:19:10,880 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 20)
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 13:00:00
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 15:20:00
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 解析总金额: 547.5
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 项目组数据: {'项目1': '草本熏蒸SPA', '项目2': '头皮护理', '项目3': 'N/A'}
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 项目组 1: 美容师: 陈莉
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 项目组 1: 金额: 197.5
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 头皮护理
2025-04-08 18:19:10,881 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 项目组 2: 金额: 350.0
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 创建服务项目: 头皮护理 - 王芳 - 350.0元 - 未指定
2025-04-08 18:19:10,882 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,882 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,882 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 行 20: 解析出服务项目数: 2
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=2
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 处理客户: C002 - 张美玲 (行 21)
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 解析到店时间: 2023-11-02 11:00:00
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 解析离店时间: 2023-11-02 13:30:00
2025-04-08 18:19:10,882 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 解析总金额: 198.0
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 项目组数据: {'项目1': '经络排毒塑身', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 经络排毒塑身
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 项目组 1: 美容师: 王芳
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 项目组 1: 金额: 198.0
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 创建服务项目: 经络排毒塑身 - 王芳 - 198.0元 - 指定
2025-04-08 18:19:10,883 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,883 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,883 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,883 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,883 - utils.excel_processor - INFO - 行 21: 解析出服务项目数: 1
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C002, 项目数=1
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 22)
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 解析到店时间: 2023-08-05 20:15:00
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 解析离店时间: 2023-08-05 21:45:00
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 解析满意度: 3.0/5
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 项目组 1: 美容师: 张莉
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 18:19:10,884 - utils.excel_processor - INFO - 项目组 1: 是否指定: False
2025-04-08 18:19:10,885 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 张莉 - 293.0元 - 未指定
2025-04-08 18:19:10,885 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,885 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,885 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,885 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,885 - utils.excel_processor - INFO - 行 22: 解析出服务项目数: 1
2025-04-08 18:19:10,885 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:19:10,885 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 23)
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 解析到店时间: 2023-08-12 19:30:00
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 解析离店时间: 2023-08-12 21:00:00
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:19:10,886 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,887 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 18:19:10,887 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,887 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,887 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,887 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,887 - utils.excel_processor - INFO - 行 23: 解析出服务项目数: 1
2025-04-08 18:19:10,887 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:19:10,887 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 24)
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 解析到店时间: 2023-09-02 20:45:00
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 解析离店时间: 2023-09-02 22:15:00
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 解析满意度: 4.0/5
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:19:10,888 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 项目组 2: 美容师: 张莉
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 项目组 2: 是否指定: True
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 张莉 - 480.0元 - 指定
2025-04-08 18:19:10,889 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,889 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,889 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 行 24: 解析出服务项目数: 2
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 18:19:10,889 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 25)
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 解析到店时间: 2023-09-16 21:00:00
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 解析离店时间: 2023-09-16 23:00:00
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 解析总金额: 533.0
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 解析满意度: 4.5/5
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,890 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 18:19:10,891 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,891 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,891 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,891 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,891 - utils.excel_processor - INFO - 行 25: 解析出服务项目数: 1
2025-04-08 18:19:10,891 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:19:10,891 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 26)
2025-04-08 18:19:10,891 - utils.excel_processor - INFO - 解析到店时间: 2023-09-30 18:30:00
2025-04-08 18:19:10,891 - utils.excel_processor - INFO - 解析离店时间: 2023-09-30 20:00:00
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 解析满意度: 4.8/5
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,892 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 18:19:10,892 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,892 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,892 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,893 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 行 26: 解析出服务项目数: 1
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 27)
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 解析到店时间: 2023-10-12 19:15:00
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 解析离店时间: 2023-10-12 21:45:00
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 解析总金额: 1360.0
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 解析满意度: 4.2/5
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,893 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 18:19:10,894 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,894 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,894 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,894 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 行 27: 解析出服务项目数: 1
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 28)
2025-04-08 18:19:10,894 - utils.excel_processor - INFO - 解析到店时间: 2023-10-25 20:30:00
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 解析离店时间: 2023-10-25 22:00:00
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 解析总金额: 480.0
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 解析满意度: 4.6/5
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 项目组数据: {'项目1': '冰肌焕颜护理', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 项目组 1: 金额: 480.0
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,895 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 周杰 - 480.0元 - 指定
2025-04-08 18:19:10,895 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,895 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,895 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,895 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 行 28: 解析出服务项目数: 1
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 29)
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 解析到店时间: 2023-11-05 21:00:00
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 解析离店时间: 2023-11-05 23:30:00
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 解析总金额: 730.5
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 解析满意度: 4.7/5
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 项目组数据: {'项目1': '帝王艾灸调理', '项目2': '草本熏蒸SPA', '项目3': 'N/A'}
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 帝王艾灸调理
2025-04-08 18:19:10,896 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 项目组 1: 金额: 533.0
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 创建服务项目: 帝王艾灸调理 - 周杰 - 533.0元 - 指定
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 草本熏蒸SPA
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 项目组 2: 美容师: 陈莉
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 项目组 2: 金额: 197.5
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:19:10,897 - utils.excel_processor - INFO - 创建服务项目: 草本熏蒸SPA - 陈莉 - 197.5元 - 未指定
2025-04-08 18:19:10,897 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,898 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,898 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,898 - utils.excel_processor - INFO - 行 29: 解析出服务项目数: 2
2025-04-08 18:19:10,898 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 18:19:10,898 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 30)
2025-04-08 18:19:10,898 - utils.excel_processor - INFO - 解析到店时间: 2023-11-18 18:45:00
2025-04-08 18:19:10,898 - utils.excel_processor - INFO - 解析离店时间: 2023-11-18 20:15:00
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 解析总项目数: 1
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 解析总金额: 293.0
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 解析满意度: 4.3/5
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 项目组数据: {'项目1': '极光净透泡泡', '项目2': 'N/A', '项目3': 'N/A'}
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 极光净透泡泡
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 项目组 1: 金额: 293.0
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,899 - utils.excel_processor - INFO - 创建服务项目: 极光净透泡泡 - 周杰 - 293.0元 - 指定
2025-04-08 18:19:10,899 - utils.excel_processor - DEBUG - 项目组 2: 项目名称为空，跳过
2025-04-08 18:19:10,899 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,899 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,899 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 行 30: 解析出服务项目数: 1
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=1
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 处理客户: C003 - 王思媛 (行 31)
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 解析到店时间: 2023-12-01 19:00:00
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 解析离店时间: 2023-12-01 21:30:00
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 解析总项目数: 2
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 解析总金额: 1840.0
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 解析满意度: 4.9/5
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 项目组数据: {'项目1': '黄金射频紧致疗程', '项目2': '冰肌焕颜护理', '项目3': 'N/A'}
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 项目组 1: 发现项目名称: 黄金射频紧致疗程
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 项目组 1: 美容师: 周杰
2025-04-08 18:19:10,900 - utils.excel_processor - INFO - 项目组 1: 金额: 1360.0
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 项目组 1: 是否指定: True
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 创建服务项目: 黄金射频紧致疗程 - 周杰 - 1360.0元 - 指定
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 项目组 2: 发现项目名称: 冰肌焕颜护理
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 项目组 2: 美容师: 王芳
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 项目组 2: 金额: 480.0
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 项目组 2: 是否指定: False
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 创建服务项目: 冰肌焕颜护理 - 王芳 - 480.0元 - 未指定
2025-04-08 18:19:10,901 - utils.excel_processor - DEBUG - 项目组 3: 项目名称为空，跳过
2025-04-08 18:19:10,901 - utils.excel_processor - DEBUG - 项目组 4: 项目名称为空，跳过
2025-04-08 18:19:10,901 - utils.excel_processor - DEBUG - 项目组 5: 项目名称为空，跳过
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 行 31: 解析出服务项目数: 2
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 创建服务记录: 客户ID=C003, 项目数=2
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 服务记录处理完成: 共处理 30 条记录, 41 个服务项目
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 处理服务记录完成，共30条记录
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 开始处理'沟通记录'Sheet页
2025-04-08 18:19:10,901 - utils.excel_processor - INFO - 开始处理沟通记录
2025-04-08 18:19:10,902 - utils.excel_processor - INFO - DataFrame形状: (15, 5)
2025-04-08 18:19:10,902 - utils.excel_processor - INFO - 原始列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 18:19:10,902 - utils.excel_processor - INFO - 处理后的列名: ['客户ID', '姓名', '沟通时间', '沟通地点', '沟通主要内容']
2025-04-08 18:19:10,902 - utils.excel_processor - INFO - 沟通记录字段映射: {'客户ID': 'customer_id', '沟通时间': 'communication_date', '沟通方式': 'communication_type', '沟通地点': 'communication_location', '员工': 'staff_name', '沟通内容': 'communication_content', '客户反馈': 'customer_feedback', '后续跟进': 'follow_up_action'}
2025-04-08 18:19:10,902 - utils.excel_processor - DEBUG - 行 0: 成功处理客户 C001 的沟通记录
2025-04-08 18:19:10,902 - utils.excel_processor - DEBUG - 行 1: 成功处理客户 C001 的沟通记录
2025-04-08 18:19:10,903 - utils.excel_processor - DEBUG - 行 2: 成功处理客户 C001 的沟通记录
2025-04-08 18:19:10,903 - utils.excel_processor - DEBUG - 行 3: 成功处理客户 C001 的沟通记录
2025-04-08 18:19:10,903 - utils.excel_processor - DEBUG - 行 4: 成功处理客户 C001 的沟通记录
2025-04-08 18:19:10,903 - utils.excel_processor - DEBUG - 行 5: 成功处理客户 C002 的沟通记录
2025-04-08 18:19:10,903 - utils.excel_processor - DEBUG - 行 6: 成功处理客户 C002 的沟通记录
2025-04-08 18:19:10,905 - utils.excel_processor - DEBUG - 行 7: 成功处理客户 C002 的沟通记录
2025-04-08 18:19:10,905 - utils.excel_processor - DEBUG - 行 8: 成功处理客户 C002 的沟通记录
2025-04-08 18:19:10,905 - utils.excel_processor - DEBUG - 行 9: 成功处理客户 C002 的沟通记录
2025-04-08 18:19:10,905 - utils.excel_processor - DEBUG - 行 10: 成功处理客户 C003 的沟通记录
2025-04-08 18:19:10,905 - utils.excel_processor - DEBUG - 行 11: 成功处理客户 C003 的沟通记录
2025-04-08 18:19:10,905 - utils.excel_processor - DEBUG - 行 12: 成功处理客户 C003 的沟通记录
2025-04-08 18:19:10,906 - utils.excel_processor - DEBUG - 行 13: 成功处理客户 C003 的沟通记录
2025-04-08 18:19:10,906 - utils.excel_processor - DEBUG - 行 14: 成功处理客户 C003 的沟通记录
2025-04-08 18:19:10,906 - utils.excel_processor - INFO - 沟通记录处理完成，共 15 条记录
2025-04-08 18:19:10,906 - utils.excel_processor - INFO - 处理沟通记录完成，共15条记录
2025-04-08 18:19:10,906 - utils.excel_processor - INFO - Excel文件处理统计: {'客户数量': 3, '健康档案数量': 3, '消费记录数量': 9, '服务记录数量': 30, '沟通记录数量': 15}
2025-04-08 18:19:10,906 - utils.excel_processor - INFO - Excel文件处理完成: D:\BeautyCRM-Mini\模拟-客户信息档案.xlsx
2025-04-08 18:19:10,906 - ExcelTest - INFO - Excel处理完成，写入结果到json文件
2025-04-08 18:19:10,908 - ExcelTest - INFO - 结果已保存至: excel_result.json
2025-04-08 18:19:10,908 - ExcelTest - INFO - 处理结果统计:
2025-04-08 18:19:10,908 - ExcelTest - INFO -   customers: 3项
2025-04-08 18:19:10,908 - ExcelTest - INFO -   health_records: 3项
2025-04-08 18:19:10,908 - ExcelTest - INFO -   consumptions: 9项
2025-04-08 18:19:10,909 - ExcelTest - INFO -   services: 30项
2025-04-08 18:19:10,909 - ExcelTest - INFO -   communications: 15项
2025-04-08 18:19:10,909 - ExcelTest - INFO - 客户数据示例:
2025-04-08 18:19:10,909 - ExcelTest - INFO -   id: C001
2025-04-08 18:19:10,909 - ExcelTest - INFO -   name: 林晓薇
2025-04-08 18:19:10,909 - ExcelTest - INFO -   gender: 女
2025-04-08 18:19:10,909 - ExcelTest - INFO -   age: 28
2025-04-08 18:19:10,909 - ExcelTest - INFO -   store: 分店A
2025-04-08 18:19:10,909 - ExcelTest - INFO -   hometown: 浙江杭州
2025-04-08 18:19:10,909 - ExcelTest - INFO -   residence: 上海浦东
2025-04-08 18:19:10,909 - ExcelTest - INFO -   residence_years: 6年
2025-04-08 18:19:10,909 - ExcelTest - INFO -   family_structure: 单身独居
2025-04-08 18:19:10,909 - ExcelTest - INFO -   family_age_distribution: 无
2025-04-08 18:19:10,910 - ExcelTest - INFO -   living_condition: 自有公寓
2025-04-08 18:19:10,910 - ExcelTest - INFO -   personality_tags: 精致悦己型
2025-04-08 18:19:10,910 - ExcelTest - INFO -   consumption_decision: 本人主导
2025-04-08 18:19:10,910 - ExcelTest - INFO -   risk_sensitivity: 低
2025-04-08 18:19:10,910 - ExcelTest - INFO -   hobbies: 护肤、健身
2025-04-08 18:19:10,910 - ExcelTest - INFO -   routine: 23:00-7:00
2025-04-08 18:19:10,910 - ExcelTest - INFO -   diet_preference: 轻食沙拉
2025-04-08 18:19:10,910 - ExcelTest - INFO -   menstrual_record: 记录
2025-04-08 18:19:10,910 - ExcelTest - INFO -   family_medical_history: 无
2025-04-08 18:19:10,910 - ExcelTest - INFO -   occupation: 时尚编辑
2025-04-08 18:19:10,910 - ExcelTest - INFO -   work_unit_type: 外资企业
2025-04-08 18:19:10,910 - ExcelTest - INFO -   annual_income: 35万
2025-04-08 18:19:10,911 - ExcelTest - INFO - ==== Excel处理测试完成 ====
