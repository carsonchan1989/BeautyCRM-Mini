<view class="container">
  <!-- æ ‡é¢˜æ  -->
  <view class="header">
    <view class="back-button" bindtap="goToHome">
      <text class="back-icon">â†</text>
      <text>è¿”å›</text>
    </view>
    <view class="title">é¡¹ç›®ç®¡ç†</view>
    <view class="add-button" bindtap="onAddProject">
      <text>æ–°å¢</text>
    </view>
  </view>
  
  <!-- é”™è¯¯ä¿¡æ¯ -->
  <view class="error-message" wx:if="{{errorMessage}}">
    <icon type="warn" size="18"></icon>
    <text>{{errorMessage}}</text>
  </view>

  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="search-filter-bar">
    <view class="search-box">
      <icon type="search" size="16" color="#999"/>
      <input placeholder="æœç´¢é¡¹ç›®åç§°" 
             value="{{searchKeyword}}" 
             bindinput="onSearchInput"/>
    </view>
    <view class="filter-button" bindtap="toggleFilterPanel">
      <text>ç­›é€‰</text>
      <text class="filter-icon">â†“</text>
    </view>
  </view>
  
  <!-- ç­›é€‰é¢æ¿ -->
  <view class="filter-panel" hidden="{{!showFilterPanel}}">
    <view class="filter-row">
      <view class="filter-label">åˆ†ç±»</view>
      <picker range="{{categories}}" 
              value="{{categoryIndex}}" 
              bindchange="onCategoryChange">
        <view class="filter-value">
          <text>{{categories[categoryIndex]}}</text>
          <text class="filter-arrow">â–¼</text>
        </view>
      </picker>
    </view>
    
    <view class="filter-row">
      <view class="filter-label">ä»·æ ¼èŒƒå›´</view>
      <picker range="{{priceRanges}}" 
              value="{{priceRangeIndex}}" 
              bindchange="onPriceRangeChange">
        <view class="filter-value">
          <text>{{priceRanges[priceRangeIndex]}}</text>
          <text class="filter-arrow">â–¼</text>
        </view>
      </picker>
    </view>
    
    <view class="filter-actions">
      <button class="reset-button" bindtap="resetFilter">é‡ç½®</button>
    </view>
  </view>
  
  <!-- ç»“æœç»Ÿè®¡ -->
  <view class="result-count">
    å…± {{projects.length}} ä¸ªé¡¹ç›®
    <text wx:if="{{projects.length < allProjects.length}}">
      (ç­›é€‰è‡ª{{allProjects.length}}ä¸ª)
    </text>
  </view>

  <view class="project-list">
    <block wx:if="{{projects.length > 0}}">
      <view class="project-item" wx:for="{{projects}}" wx:key="id" bindtap="onProjectTap" data-id="{{item.id}}">
        <view class="project-info">
          <view class="project-header">
            <view class="project-name">{{item.name || 'æœªå‘½åé¡¹ç›®'}}</view>
            <view class="project-price">Â¥{{item.price || '0'}}</view>
          </view>
          <view class="project-details">
            <view class="project-detail-item" wx:if="{{item.category}}">
              <text class="detail-label">åˆ†ç±»ï¼š</text>
              <text class="detail-value">{{item.category}}</text>
            </view>
            <view class="project-detail-item" wx:if="{{item.duration}}">
              <text class="detail-label">æ—¶é•¿ï¼š</text>
              <text class="detail-value">{{item.duration}}åˆ†é’Ÿ</text>
            </view>
            <view class="project-desc" wx:if="{{item.description}}">{{item.description}}</view>
          </view>
        </view>
        <view class="project-actions">
          <button class="btn-edit" catchtap="onEditProject" data-id="{{item.id}}">ç¼–è¾‘</button>
          <button class="btn-delete" catchtap="onDeleteProject" data-id="{{item.id}}" data-name="{{item.name}}">åˆ é™¤</button>
        </view>
      </view>
    </block>
    
    <!-- æ— æ•°æ®æç¤º -->
    <view class="empty-tip" wx:if="{{projects.length === 0 && !isLoading}}">
      <view class="empty-icon">ğŸ“‹</view>
      <text>æš‚æ— é¡¹ç›®æ•°æ®</text>
      <text class="empty-sub-tip">ç‚¹å‡»å³ä¸Šè§’"æ–°å¢"æ·»åŠ é¡¹ç›®</text>
    </view>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{isLoading}}">
      <view class="loading-icon"></view>
      <text>åŠ è½½ä¸­...</text>
    </view>
  </view>
</view> 